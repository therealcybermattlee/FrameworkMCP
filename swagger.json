{
  "openapi": "3.0.3",
  "info": {
    "title": "Framework MCP API - CIS Controls Capability Assessment",
    "description": "Microsoft Copilot-compatible API for vendor capability assessment against CIS Controls Framework v8.1 (153 safeguards). Features clean capability analysis architecture for accurate capability role determination (FULL, PARTIAL, FACILITATES, GOVERNANCE, VALIDATES).",
    "version": "1.3.7",
    "contact": {
      "name": "Framework MCP Support",
      "url": "https://github.com/therealcybermattlee/FrameworkMCP"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "https://your-deployment.ondigitalocean.app",
      "description": "Production DigitalOcean App Services deployment"
    },
    {
      "url": "http://localhost:8080",
      "description": "Local development server"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "Health Check",
        "description": "Check API health status and performance metrics",
        "operationId": "healthCheck",
        "tags": ["Monitoring"],
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analyze-vendor-response": {
      "post": {
        "summary": "Analyze Vendor Response (PRIMARY)",
        "description": "Primary endpoint for analyzing vendor response text to determine appropriate capability role for CIS safeguards",
        "operationId": "analyzeVendorResponse",
        "tags": ["Capability Assessment"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AnalysisRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Analysis completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VendorAnalysisResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Safeguard not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/safeguards": {
      "get": {
        "summary": "List Available Safeguards",
        "description": "Get a list of all available CIS Controls v8.1 safeguards (153 total)",
        "operationId": "listSafeguards",
        "tags": ["Safeguards"],
        "responses": {
          "200": {
            "description": "List of available safeguards",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SafeguardListResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/safeguards/{safeguardId}": {
      "get": {
        "summary": "Get Safeguard Details",
        "description": "Get detailed information about a specific CIS safeguard including governance elements, core requirements, and implementation suggestions",
        "operationId": "getSafeguardDetails",
        "tags": ["Safeguards"],
        "parameters": [
          {
            "name": "safeguardId",
            "in": "path",
            "required": true,
            "description": "CIS safeguard ID (e.g., '1.1', '5.1', '12.8')",
            "schema": {
              "type": "string",
              "pattern": "^[0-9]+\\.[0-9]+$",
              "example": "1.1"
            }
          },
          {
            "name": "include_examples",
            "in": "query",
            "required": false,
            "description": "Include implementation examples in response",
            "schema": {
              "type": "boolean",
              "default": false
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Safeguard details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SafeguardDetails"
                }
              }
            }
          },
          "400": {
            "description": "Invalid safeguard ID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Safeguard not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/metrics": {
      "get": {
        "summary": "Performance Metrics",
        "description": "Get API performance metrics and usage statistics",
        "operationId": "getMetrics",
        "tags": ["Monitoring"],
        "responses": {
          "200": {
            "description": "Performance metrics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api": {
      "get": {
        "summary": "API Documentation",
        "description": "Get API documentation and available endpoints information",
        "operationId": "getApiDocumentation",
        "tags": ["Monitoring"],
        "responses": {
          "200": {
            "description": "API documentation and endpoints",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiDocumentationResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CapabilityRole": {
        "type": "string",
        "enum": ["full", "partial", "facilitates", "governance", "validates"],
        "description": "Vendor tool capability roles:\n- FULL: Complete implementation of safeguard\n- PARTIAL: Limited scope implementation\n- FACILITATES: Enhancement capabilities that enable better/faster/stronger implementation\n- GOVERNANCE: Policy/process management and oversight\n- VALIDATES: Evidence collection, audit, and reporting"
      },
      "AnalysisRequest": {
        "type": "object",
        "required": ["vendor_name", "safeguard_id", "response_text"],
        "properties": {
          "vendor_name": {
            "type": "string",
            "description": "Name of the vendor",
            "minLength": 1,
            "maxLength": 100,
            "example": "Microsoft Defender"
          },
          "safeguard_id": {
            "type": "string",
            "pattern": "^[0-9]+\\.[0-9]+$",
            "description": "CIS safeguard ID",
            "example": "5.1"
          },
          "response_text": {
            "type": "string",
            "description": "Vendor response text to analyze for capability determination",
            "minLength": 10,
            "maxLength": 10000,
            "example": "We provide centralized account management with role-based access controls, automated provisioning and deprovisioning, and integration with Active Directory for enterprise identity management."
          }
        }
      },
      "VendorAnalysisResponse": {
        "type": "object",
        "properties": {
          "vendor": {
            "type": "string",
            "description": "Name of the vendor or tool",
            "example": "Microsoft Defender"
          },
          "safeguardId": {
            "type": "string",
            "description": "CIS safeguard ID",
            "example": "5.1"
          },
          "safeguardTitle": {
            "type": "string",
            "description": "Title of the CIS safeguard",
            "example": "Establish and Maintain an Inventory of Accounts"
          },
          "capability": {
            "$ref": "#/components/schemas/CapabilityRole",
            "description": "Primary capability categorization"
          },
          "capabilities": {
            "type": "object",
            "description": "Detailed capability breakdown",
            "properties": {
              "full": {
                "type": "boolean",
                "description": "Directly implements the core safeguard functionality"
              },
              "partial": {
                "type": "boolean",
                "description": "Implements limited aspects of the safeguard"
              },
              "facilitates": {
                "type": "boolean",
                "description": "Enhances or enables safeguard implementation by others"
              },
              "governance": {
                "type": "boolean",
                "description": "Provides policy, process, and oversight capabilities"
              },
              "validates": {
                "type": "boolean",
                "description": "Provides evidence, audit, and validation reporting"
              }
            }
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "Confidence score in the assessment"
          },
          "reasoning": {
            "type": "string",
            "description": "Detailed explanation of the capability determination"
          },
          "evidence": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Evidence supporting the capability assessment"
          },
          "toolCapabilityDescription": {
            "type": "string",
            "description": "Description of what type of tool this is and its role"
          },
          "recommendedUse": {
            "type": "string",
            "description": "How practitioners should use this tool for the safeguard"
          }
        }
      },
      "SafeguardListResponse": {
        "type": "object",
        "properties": {
          "safeguards": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string",
                  "example": "1.1"
                },
                "title": {
                  "type": "string",
                  "example": "Establish and Maintain Detailed Enterprise Asset Inventory"
                },
                "implementationGroup": {
                  "type": "string",
                  "enum": ["IG1", "IG2", "IG3"],
                  "example": "IG1"
                }
              }
            }
          },
          "total": {
            "type": "integer",
            "example": 153
          },
          "framework": {
            "type": "string",
            "example": "CIS Controls v8.1"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "SafeguardDetails": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "1.1"
          },
          "title": {
            "type": "string",
            "example": "Establish and Maintain Detailed Enterprise Asset Inventory"
          },
          "description": {
            "type": "string",
            "description": "Detailed description of the safeguard requirements"
          },
          "implementationGroup": {
            "type": "string",
            "enum": ["IG1", "IG2", "IG3"],
            "example": "IG1"
          },
          "governanceElements": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Governance requirements that MUST be met (Orange elements)"
          },
          "coreRequirements": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Core 'what' requirements of the safeguard (Green elements)"
          },
          "subTaxonomicalElements": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Sub-taxonomical components (Yellow elements)"
          },
          "implementationSuggestions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Implementation methods and suggestions (Gray elements)"
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "example": "healthy"
          },
          "uptime": {
            "type": "integer",
            "description": "Uptime in seconds"
          },
          "totalRequests": {
            "type": "integer",
            "description": "Total requests processed"
          },
          "errorCount": {
            "type": "integer",
            "description": "Total errors encountered"
          },
          "version": {
            "type": "string",
            "example": "1.3.7"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "MetricsResponse": {
        "type": "object",
        "properties": {
          "uptime_seconds": {
            "type": "integer"
          },
          "total_requests": {
            "type": "integer"
          },
          "error_count": {
            "type": "integer"
          },
          "error_rate": {
            "type": "string",
            "example": "0.5%"
          },
          "request_counts": {
            "type": "object",
            "additionalProperties": {
              "type": "integer"
            }
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ApiDocumentationResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "Framework MCP HTTP API"
          },
          "version": {
            "type": "string",
            "example": "1.3.7"
          },
          "description": {
            "type": "string",
            "example": "Clean HTTP API for vendor capability assessment against CIS Controls Framework"
          },
          "endpoints": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Available API endpoints and their descriptions"
          },
          "capabilities": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported capability types"
          },
          "framework": {
            "type": "string",
            "example": "CIS Controls v8.1 (153 safeguards)"
          },
          "deployment": {
            "type": "string",
            "example": "DigitalOcean App Services compatible"
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message"
          },
          "details": {
            "type": "string",
            "description": "Additional error details"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Capability Assessment",
      "description": "Primary API endpoints for vendor capability assessment against CIS Controls"
    },
    {
      "name": "Safeguards",
      "description": "CIS Controls safeguards information and details"
    },
    {
      "name": "Monitoring",
      "description": "Health checks and performance monitoring"
    }
  ],
  "externalDocs": {
    "description": "Framework MCP GitHub Repository",
    "url": "https://github.com/therealcybermattlee/FrameworkMCP"
  }
}