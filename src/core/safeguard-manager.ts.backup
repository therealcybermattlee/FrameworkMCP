import { SafeguardElement, CacheEntry } from '../shared/types.js';

export class SafeguardManager {
  private cache: Map<string, CacheEntry<any>>;
  private safeguards: Record<string, SafeguardElement> = {};
  private static readonly MAX_CACHE_SIZE = 1000; // Prevent unlimited cache growth
  private static readonly CACHE_CLEANUP_INTERVAL = 30 * 60 * 1000; // 30 minutes
  private safeguardKeysCache: string[] | null = null; // Pre-computed sorted keys
  private lastCleanup: number = 0;

  constructor() {
    this.cache = new Map();
    this.initializeSafeguards();
    this.precomputeSafeguardKeys();
  }

  public getSafeguardDetails(safeguardId: string, includeExamples: boolean = false): SafeguardElement | null {
    // Check cache first
    const cacheKey = `${safeguardId}_${includeExamples}`;
    const cached = this.getCachedSafeguardDetails(cacheKey);
    if (cached) {
      return cached;
    }

    const safeguard = this.safeguards[safeguardId];
    if (!safeguard) {
      return null;
    }

    // Add examples if requested
    let result = { ...safeguard };
    if (includeExamples) {
      result = this.addImplementationExamples(result);
    }

    // Cache the result
    this.cache.set(cacheKey, {
      data: result,
      timestamp: Date.now()
    });

    return result;
  }

  public listAvailableSafeguards(): string[] {
    // Use pre-computed sorted keys for optimal performance
    if (this.safeguardKeysCache) {
      return [...this.safeguardKeysCache]; // Return copy to prevent external modification
    }

    // Fallback to original method if pre-computed cache not available
    const safeguardList = Object.keys(this.safeguards).sort((a, b) => {
      const [aMajor, aMinor] = a.split('.').map(Number);
      const [bMajor, bMinor] = b.split('.').map(Number);
      return aMajor - bMajor || aMinor - bMinor;
    });

    return safeguardList;
  }

  public getAllSafeguards(): Record<string, SafeguardElement> {
    return { ...this.safeguards };
  }

  public validateSafeguardId(safeguardId: string): void {
    if (!safeguardId || typeof safeguardId !== 'string') {
      throw new Error('Safeguard ID is required and must be a string');
    }
    
    if (!/^[0-9]+\.[0-9]+$/.test(safeguardId)) {
      throw new Error('Safeguard ID must be in format "X.Y" (e.g., "1.1", "5.1")');
    }

    if (!this.safeguards[safeguardId]) {
      const availableSafeguards = this.listAvailableSafeguards();
      throw new Error(`Safeguard ${safeguardId} not found. Available safeguards: ${availableSafeguards.join(', ')}`);
    }
  }

  private getCachedSafeguardDetails(cacheKey: string): SafeguardElement | null {
    // Clean up old cache entries periodically
    this.performCacheCleanupIfNeeded();
    
    const cached = this.cache.get(cacheKey);
    
    if (cached && (Date.now() - cached.timestamp < 5 * 60 * 1000)) { // 5 minute cache
      return cached.data;
    }
    
    return null;
  }

  private precomputeSafeguardKeys(): void {
    // Pre-compute and cache the sorted safeguard keys for optimal listAvailableSafeguards() performance
    this.safeguardKeysCache = Object.keys(this.safeguards).sort((a, b) => {
      const [aMajor, aMinor] = a.split('.').map(Number);
      const [bMajor, bMinor] = b.split('.').map(Number);
      return aMajor - bMajor || aMinor - bMinor;
    });
  }

  private performCacheCleanupIfNeeded(): void {
    const now = Date.now();
    
    // Check if cleanup is needed
    if (now - this.lastCleanup < SafeguardManager.CACHE_CLEANUP_INTERVAL && 
        this.cache.size < SafeguardManager.MAX_CACHE_SIZE) {
      return;
    }

    // Remove expired entries
    const expiredKeys: string[] = [];
    for (const [key, entry] of this.cache.entries()) {
      if (now - entry.timestamp > 5 * 60 * 1000) { // 5 minute expiry
        expiredKeys.push(key);
      }
    }

    for (const key of expiredKeys) {
      this.cache.delete(key);
    }

    // If still too many entries, remove oldest ones
    if (this.cache.size > SafeguardManager.MAX_CACHE_SIZE) {
      const sortedEntries = Array.from(this.cache.entries())
        .sort((a, b) => a[1].timestamp - b[1].timestamp);
      
      const entriesToRemove = sortedEntries.slice(0, this.cache.size - SafeguardManager.MAX_CACHE_SIZE);
      for (const [key] of entriesToRemove) {
        this.cache.delete(key);
      }
    }

    this.lastCleanup = now;
  }

  /**
   * Get cache statistics for monitoring and debugging
   */
  public getCacheStats(): { size: number; lastCleanup: number } {
    return {
      size: this.cache.size,
      lastCleanup: this.lastCleanup
    };
  }

  /**
   * Clear the cache manually if needed
   */
  public clearCache(): void {
    this.cache.clear();
    this.lastCleanup = Date.now();
  }

  private addImplementationExamples(safeguard: SafeguardElement): SafeguardElement {
    // Add implementation examples based on safeguard type
    const examples = this.getImplementationExamples(safeguard.id);
    
    return {
      ...safeguard,
      implementationSuggestions: [
        ...safeguard.implementationSuggestions,
        ...examples
      ]
    };
  }

  private getImplementationExamples(safeguardId: string): string[] {
    const exampleMap: Record<string, string[]> = {
      "1.1": [
        "Example: Use Lansweeper for automated asset discovery",
        "Example: Implement ServiceNow CMDB for centralized tracking",
        "Example: Deploy Microsoft SCCM for Windows asset management"
      ],
      "5.1": [
        "Example: Use Azure AD for centralized account management",
        "Example: Implement Okta for identity lifecycle management",
        "Example: Deploy JumpCloud for directory services"
      ],
      "6.3": [
        "Example: Enable Azure MFA for all external applications",
        "Example: Implement Duo Security for multi-factor authentication",
        "Example: Use Google Workspace SSO with MFA enforcement"
      ],
      "7.1": [
        "Example: Establish Nessus vulnerability scanning schedule",
        "Example: Implement Qualys VMDR for continuous monitoring",
        "Example: Use Rapid7 InsightVM for vulnerability management"
      ]
    };

    return exampleMap[safeguardId] || [];
  }

  private initializeSafeguards(): void {
    this.safeguards = {
  "1.1": {
    id: "1.1",
    title: "Establish and Maintain a Detailed Enterprise Asset Inventory",
    description: "Establish and maintain an accurate, detailed, and up-to-date inventory of all enterprise assets with the potential to store or process data",
    implementationGroup: "IG1",
    assetType: ["end-user devices", "network devices", "IoT devices", "servers"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Maintain", 
      "Enterprise Asset Management Policy / Process",
      "Review and update the inventory of all enterprise assets bi-annually, or more frequently"
    ],
    coreRequirements: [ // Green - The "what" 
      "accurate, detailed, and up-to-date inventory of all enterprise assets with the potential to store or process data"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Network Address (IF STATIC)",
      "Hardware Address",
      "Machine Name",
      "Enterprise asset owner",
      "Department for each asset",
      "Asset has been approved to connect to the network",
      "End-User Devices",
      "Mobile",
      "Portable",
      "Network Devices",
      "IOT Devices", 
      "Servers",
      "Connected to Infrastructure",
      "Physically",
      "Virtually", 
      "Remotely",
      "Those within cloud environments",
      "Regularly Connected Devices - NOT Under Control of Enterprise",
      "Detailed",
      "Accurate",
      "Up-to-date",
      "Potential to store or process data"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "For mobile end-user devices, MDM type tools can support this process, where appropriate"
    ],
    relatedSafeguards: ["1.2", "1.3", "1.4", "1.5", "2.1", "3.2", "4.1", "5.1"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating enterprise asset inventory solutions against CIS Control 1.1 requirements for comprehensive asset tracking.",
      objective: "Determine if a vendor solution provides complete, accurate, and up-to-date enterprise asset inventory capabilities.",
      guidelines: [
        "Verify coverage of all asset types: end-user devices, network devices, IoT, servers",
        "Confirm data collection includes: network/hardware addresses, machine names, ownership, department approval",
        "Validate inventory accuracy and real-time updating capabilities",
        "Assess policy/process management and bi-annual review compliance"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "5.1": {
    id: "5.1",
    title: "Establish and Maintain an Inventory of Accounts",
    description: "Establish and maintain an inventory of all accounts managed in the enterprise. The inventory must include both user and administrator accounts. The inventory, at a minimum, should contain the person's name, username, start/stop dates, and department. Validate that all active accounts are authorized, on a recurring schedule at a minimum quarterly, or more frequently.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish and maintain an inventory of all accounts managed in the enterprise",
      "The inventory must include both user and administrator accounts",
      "At a minimum, should contain the person's name, username, start/stop dates, and department",
      "Validate that all active accounts are authorized, on a recurring schedule at a minimum quarterly, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "Inventory of Accounts"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Establish",
      "Maintain",
      "Validate that all active accounts are authorized",
      "Recurring schedule",
      "Must Include",
      "At a minimum",
      "Minimum Quarterly",
      "More Frequently",
      "User Accounts",
      "Administrator Accounts",
      "Name",
      "Username",
      "Start Stop Dates",
      "Department"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Identity and Access Management Tool"
    ],
    relatedSafeguards: ["1.1", "2.1", "5.2", "5.3", "5.4", "5.5", "5.6", "6.1", "6.2", "6.7", "12.8"],
    systemPrompt: {
      role: "account_inventory_specialist",
      context: "You are evaluating account management solutions against CIS Control 5.1 requirements for comprehensive account inventory and validation.",
      objective: "Determine if a vendor solution provides complete account inventory management with quarterly validation processes.",
      guidelines: [
        "Verify comprehensive account inventory for all user and administrator accounts",
        "Confirm tracking of required metadata (name, username, start/stop dates, department)",
        "Validate quarterly account authorization review processes",
        "Assess automated account discovery and lifecycle management",
        "Review unauthorized account detection and remediation",
        "Check compliance reporting and audit trail capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.3": {
    id: "6.3", 
    title: "Require MFA for Externally-Exposed Applications",
    description: "Require all externally-exposed enterprise or third-party applications to enforce MFA, where supported. Enforcing MFA through a directory service or SSO provider is a satisfactory implementation of this Safeguard.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Require",
      "Account and Access Control Management",
      "Multi-Factor Authentication Tool"
    ],
    coreRequirements: [ // Green - The "what"
      "all externally-exposed enterprise or third-party applications to enforce MFA",
      "where supported"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "ALL Externally Exposed Applications",
      "Enforce",
      "Where supported"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Enforcing MFA through a directory service or SSO provider is a satisfactory implementation of this Safeguard",
      "Directory service",
      "SSO Provider",
      "Account and Access Control Management",
      "Multi-Factor Authentication Tool"
    ],
    relatedSafeguards: ["2.1", "4.1"],
    systemPrompt: {
      role: "multi_factor_authentication_expert",
      context: "You are evaluating multi-factor authentication solutions against CIS Control 6.3 requirements for externally-exposed application protection.",
      objective: "Determine if a vendor solution provides comprehensive MFA enforcement for externally-exposed enterprise and third-party applications.",
      guidelines: [
        "Verify MFA enforcement for all externally-exposed applications",
        "Confirm support for enterprise and third-party application integration",
        "Validate directory service and SSO provider MFA implementation",
        "Assess MFA method variety and adaptive authentication",
        "Review policy-based MFA enforcement and exception handling",
        "Check compliance monitoring and MFA adoption reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.1": {
    id: "7.1",
    title: "Establish and Maintain a Vulnerability Management Process",
    description: "Establish and maintain a documented vulnerability management process for enterprise assets",
    implementationGroup: "IG1",
    assetType: ["documentation"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish documented process",
      "maintain vulnerability management process",
      "review and update documentation annually",
      "update when significant enterprise changes occur",
      "vulnerability management policy"
    ],
    coreRequirements: [ // Green - The "what"
      "vulnerability management process",
      "enterprise assets scope",
      "documented procedures",
      "vulnerability identification",
      "vulnerability assessment"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "vulnerability scanning procedures",
      "risk assessment criteria", 
      "remediation prioritization",
      "patch management integration",
      "vulnerability tracking",
      "reporting requirements",
      "roles and responsibilities",
      "escalation procedures"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "vulnerability scanning tools",
      "patch management systems",
      "vulnerability databases",
      "CVSS scoring",
      "automated scanning",
      "vulnerability management platforms"
    ],
    relatedSafeguards: ["1.1", "2.1", "7.2", "7.3", "7.4", "7.5", "7.6", "7.7"],
    systemPrompt: {
      role: "vulnerability_management_process_expert",
      context: "You are evaluating vulnerability management solutions against CIS Control 7.1 requirements for establishing documented vulnerability management processes.",
      objective: "Determine if a vendor solution provides comprehensive vulnerability management process establishment and maintenance capabilities.",
      guidelines: [
        "Verify documented vulnerability management process creation",
        "Confirm process maintenance and annual review capabilities",
        "Validate enterprise asset scope coverage and procedures",
        "Assess vulnerability identification and assessment workflows",
        "Review process update mechanisms for enterprise changes",
        "Check policy integration and governance framework alignment"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "1.2": {
    id: "1.2",
    title: "Address Unauthorized Assets",
    description: "Ensure that a process exists to address unauthorized assets on a weekly basis",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "Ensure that a process exists to address unauthorized assets on a weekly basis"
    ],
    coreRequirements: [ // Green - The "what"
      "Address Unauthorized Assets"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "On a weekly basis",
      "Ensure"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "The enterprise may choose to remove the asset from the network, deny the asset from connecting remotely to the network, or quarantine the asset"
    ],
    relatedSafeguards: ["1.1", "1.3"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating solutions for addressing unauthorized assets against CIS Control 1.2 requirements for weekly remediation processes.",
      objective: "Determine if a vendor solution provides automated detection and remediation of unauthorized assets on the network.",
      guidelines: [
        "Verify automated detection of unauthorized assets connected to the network",
        "Confirm weekly or more frequent remediation processes",
        "Assess capabilities for asset removal, network denial, or quarantine actions",
        "Validate integration with asset inventory systems for authorization checks"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "1.3": {
    id: "1.3",
    title: "Utilize an Active Discovery Tool",
    description: "Utilize an active discovery tool to identify assets connected to the enterprise's network. Configure the active discovery tool to execute daily, or more frequently.",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "Utilize an active discovery tool to identify assets connected to the enterprise's network",
      "Configure the active discovery tool to execute daily, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "Active discovery tool"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Utilize",
      "Configure",
      "Execute daily",
      "Execute daily, or more frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["1.1", "1.2", "1.4", "1.5"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating active discovery tools against CIS Control 1.3 requirements for daily network asset identification.",
      objective: "Determine if a vendor solution provides active discovery capabilities to automatically identify network-connected assets.",
      guidelines: [
        "Verify active network scanning and asset discovery capabilities",
        "Confirm daily or more frequent execution scheduling",
        "Assess accuracy of asset identification across network segments",
        "Validate integration with asset inventory systems for automatic updates"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "1.4": {
    id: "1.4", 
    title: "Use Dynamic Host Configuration Protocol (DHCP) Logging to Update Enterprise Asset Inventory",
    description: "Use DHCP logging on all DHCP servers or Internet Protocol (IP) address management tools to update the enterprise's asset inventory. Review and use logs to update the enterprise's asset inventory weekly, or more frequently.",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Use DHCP logging on all DHCP servers or Internet Protocol (IP) address management tools to update the enterprise's asset inventory",
      "Review and use logs to update the enterprise's asset inventory weekly, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "DHCP Logging on all DHCP servers",
      "IPAM"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Use",
      "Review and Use Logs",
      "Update asset inventory",
      "Weekly",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["1.1", "1.2", "1.3", "1.5"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating DHCP logging and IPAM solutions against CIS Control 1.4 requirements for network-based asset tracking.",
      objective: "Determine if a vendor solution provides DHCP logging or IP address management capabilities to enhance asset inventory accuracy.",
      guidelines: [
        "Verify DHCP logging capabilities on all DHCP servers",
        "Assess IP address management (IPAM) tool functionality",
        "Confirm weekly or more frequent log review and asset inventory updates",
        "Validate automatic correlation of IP assignments with asset records"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "1.5": {
    id: "1.5",
    title: "Use a Passive Asset Discovery Tool",
    description: "Use a passive discovery tool to identify assets connected to the enterprise's network. Review and use scans to update the enterprise's asset inventory at least weekly, or more frequently.",
    implementationGroup: "IG3",
    assetType: ["network"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "Use a passive discovery tool to identify assets connected to the enterprise's network",
      "Review and use scans to update the enterprise's asset inventory at least weekly, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "Passive Discovery Tool"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Use",
      "Review and Use scans",
      "Update asset inventory",
      "Weekly",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["1.1", "1.2", "1.3", "1.4"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating passive discovery tools against CIS Control 1.5 requirements for non-intrusive network asset identification.",
      objective: "Determine if a vendor solution provides passive discovery capabilities to identify network assets without active scanning.",
      guidelines: [
        "Verify passive network monitoring and asset discovery capabilities",
        "Assess non-intrusive traffic analysis for asset identification",
        "Confirm weekly or more frequent scan review and inventory updates",
        "Validate integration with asset inventory systems for comprehensive coverage"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.1": {
    id: "2.1",
    title: "Establish and Maintain a Software Inventory",
    description: "Establish and maintain a detailed inventory of all licensed software installed on enterprise assets",
    implementationGroup: "IG1",
    assetType: ["applications"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish and maintain a detailed inventory of all licensed software installed on enterprise assets",
      "The software inventory must document the title, publisher, initial install/use date, and business purpose for each entry; where appropriate, include the Uniform Resource Locator (URL), app store(s), version(s), deployment mechanism, and decommission date",
      "Review and update the software inventory bi-annually, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "Detailed inventory of all licensed software",
      "Installed on enterprise Assets"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Establish",
      "Maintain",
      "Must Document",
      "Title",
      "Publisher",
      "Initial Install / Use Date",
      "Business Purpose",
      "URL",
      "App Store(s)",
      "App Version(s)",
      "Deployment mechanism",
      "Decomm. Date",
      "Where appropriate",
      "bi-annually",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["1.1", "2.2", "2.3", "2.4", "2.5", "2.6", "2.7"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating software inventory solutions against CIS Control 2.1 requirements for comprehensive licensed software tracking.",
      objective: "Determine if a vendor solution provides complete software inventory capabilities for all licensed applications on enterprise assets.",
      guidelines: [
        "Verify detailed tracking of all licensed software installations",
        "Confirm documentation includes: title, publisher, install date, business purpose, URL, versions, deployment mechanism",
        "Assess bi-annual or more frequent inventory review capabilities",
        "Validate integration with asset management systems for comprehensive coverage"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.2": {
    id: "2.2",
    title: "Ensure That Only Currently Supported Software Is Designated as Authorized",
    description: "Ensure that only currently supported software is designated as authorized in the software inventory",
    implementationGroup: "IG1",
    assetType: ["applications"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Ensure that only currently supported software is designated as authorized in the software inventory for enterprise assets. If software is unsupported, yet necessary for the fulfillment of the enterprise's mission, document an exception detailing mitigating controls and residual risk acceptance. For any unsupported software without an exception documentation, designate as unauthorized. Review the software list to verify software support at least monthly, or more frequently."
    ],
    coreRequirements: [ // Green - The "what"
      "Currently supported software",
      "Authorized in the software inventory"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Ensure",
      "Determine if Authorized Software Is Currently Supported",
      "If Unsupported",
      "Determine Necessity for Business",
      "Document Exception detailing mitigating controls",
      "Document Residual risk acceptance",
      "Review the software list",
      "Monthly",
      "More frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["2.1", "2.3", "2.4", "2.5", "2.6", "2.7"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating software lifecycle management solutions against CIS Control 2.2 requirements for ensuring only supported software is authorized.",
      objective: "Determine if a vendor solution provides capabilities to track software support status and manage authorization based on vendor support lifecycle.",
      guidelines: [
        "Verify tracking of software vendor support status and end-of-life dates",
        "Assess automated designation of supported software as authorized",
        "Confirm exception documentation capabilities for necessary unsupported software",
        "Validate monthly or more frequent review processes for software support status"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.3": {
    id: "2.3",
    title: "Address Unauthorized Software",
    description: "Ensure that unauthorized software is either removed from use on enterprise assets or receives a documented exception. Review monthly, or more frequently.",
    implementationGroup: "IG1",
    assetType: ["applications"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "Ensure",
      "Review monthly, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "unauthorized software is either removed from use on enterprise assets or receives a documented exception"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Address Unauthorized Software",
      "Remove from use",
      "Document Exception",
      "Monthly",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["2.1", "2.2", "2.4", "2.5", "2.6", "2.7"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating software remediation solutions against CIS Control 2.3 requirements for addressing unauthorized software on enterprise assets.",
      objective: "Determine if a vendor solution provides capabilities to detect and remediate unauthorized software installations.",
      guidelines: [
        "Verify automated detection of unauthorized software on enterprise assets",
        "Assess software removal and uninstallation capabilities",
        "Confirm exception documentation and approval workflow features",
        "Validate monthly or more frequent review and remediation processes"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.4": {
    id: "2.4",
    title: "Utilize Automated Software Inventory Tools",
    description: "Utilize software inventory tools, when possible, throughout the enterprise to automate the discovery and documentation of installed software.",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "Utilize",
      "when possible"
    ],
    coreRequirements: [ // Green - The "what"
      "software inventory tools",
      "automate the discovery and documentation of installed software"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Automate Discovery",
      "Automate Documentation",
      "Installed Software",
      "When possible"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["2.1", "2.2", "2.3", "2.5", "2.6", "2.7"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating automated software inventory tools against CIS Control 2.4 requirements for enterprise-wide software discovery and documentation.",
      objective: "Determine if a vendor solution provides automated software discovery and inventory capabilities across the enterprise.",
      guidelines: [
        "Verify automated software discovery capabilities across all enterprise assets",
        "Assess comprehensive documentation of installed software details",
        "Confirm enterprise-wide deployment and coverage capabilities",
        "Validate integration with centralized inventory management systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.5": {
    id: "2.5",
    title: "Allowlist Authorized Software",
    description: "Use technical controls, such as application allowlisting, to ensure that only authorized software can execute or be accessed. Reassess bi-annually, or more frequently.",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Use",
      "Ensure",
      "Reassess bi-annually, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "technical controls",
      "only authorized software can execute or be accessed"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Allowlist Authorized Software",
      "Technical Controls",
      "Execute",
      "Accessed",
      "Reassess",
      "Bi-Annually",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Application Allowlisting"
    ],
    relatedSafeguards: ["2.1", "2.2", "2.3", "2.4", "2.6", "2.7"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating application allowlisting solutions against CIS Control 2.5 requirements for restricting software execution to authorized applications only.",
      objective: "Determine if a vendor solution provides technical controls to allowlist authorized software and prevent unauthorized execution.",
      guidelines: [
        "Verify application allowlisting and execution control capabilities",
        "Assess technical controls for software execution restriction",
        "Confirm bi-annual or more frequent reassessment processes",
        "Validate policy management and exception handling features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.6": {
    id: "2.6",
    title: "Allowlist Authorized Libraries",
    description: "Use technical controls to ensure that only authorized software libraries, such as specific .dll, .ocx, .so. files are allowed to load into a system process. Block unauthorized libraries from loading into a system process. Reassess bi-annually, or more frequently.",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Use",
      "Ensure",
      "Block unauthorized libraries from loading into a system process",
      "Reassess bi-annually, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "technical controls",
      "only authorized software libraries",
      "are allowed to load into a system process"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Only authorized software libraries",
      "Are allowed to load into a system process",
      "Technical Controls",
      "Block unauthorized libraries from loading into a system process",
      "Reassess",
      "Bi-Annually",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Specific .dll files",
      "Specific .ocx files",
      "Specific .so files"
    ],
    relatedSafeguards: ["2.1", "2.2", "2.3", "2.4", "2.5", "2.7"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating library allowlisting solutions against CIS Control 2.6 requirements for restricting software library loading to authorized libraries only.",
      objective: "Determine if a vendor solution provides technical controls to allowlist authorized software libraries and prevent unauthorized library loading.",
      guidelines: [
        "Verify software library allowlisting capabilities for .dll, .ocx, .so files",
        "Assess technical controls for preventing unauthorized library loading",
        "Confirm bi-annual or more frequent reassessment processes",
        "Validate system process protection and library validation features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "2.7": {
    id: "2.7",
    title: "Allowlist Authorized Scripts",
    description: "Use technical controls, such as digital signatures and version control, to ensure that only authorized scripts, such as specific .ps1, .py, files are allowed to execute. Block unauthorized scripts from executing. Reassess bi-annually, or more frequently.",
    implementationGroup: "IG3",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Use",
      "Ensure",
      "Block unauthorized scripts from executing",
      "Reassess bi-annually, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "technical controls",
      "only authorized files are allowed to execute"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Only authorized files are allowed to execute",
      "Technical Controls",
      "Block unauthorized scripts from executing",
      "Reassess",
      "Bi-Annually",
      "More Frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Digital signatures",
      "Version control",
      "Specific .ps1 files",
      "Specific .py files"
    ],
    relatedSafeguards: ["2.1", "2.2", "2.3", "2.4", "2.5", "2.6"],
    systemPrompt: {
      role: "asset_inventory_expert",
      context: "You are evaluating script allowlisting solutions against CIS Control 2.7 requirements for restricting script execution to authorized scripts only.",
      objective: "Determine if a vendor solution provides technical controls to allowlist authorized scripts and prevent unauthorized script execution.",
      guidelines: [
        "Verify script allowlisting capabilities for .ps1, .py, and other script files",
        "Assess digital signature validation and version control integration",
        "Confirm bi-annual or more frequent reassessment processes",
        "Validate script blocking capabilities for unauthorized execution attempts"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.1": {
    id: "3.1",
    title: "Establish and Maintain a Data Management Process",
    description: "Establish and maintain a documented data management process. In the process, address data sensitivity, data owner, handling of data, data retention limits, and disposal requirements, based on sensitivity and retention standards for the enterprise. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Maintain",
      "Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "documented data management process",
      "address data sensitivity, data owner, handling of data, data retention limits, and disposal requirements, based on sensitivity and retention standards for the enterprise"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Documented Data management process",
      "Data Sensitivity",
      "Data Owner",
      "Data Handling",
      "Data Retention Limits",
      "Disposal Requirements",
      "Retention Standards",
      "Review and update documentation",
      "Annually",
      "When significant enterprise changes occur that could impact this Safeguard"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.2", "3.3", "3.4", "3.5", "3.6", "3.7", "3.8", "3.9", "3.10", "3.11", "3.12", "3.13", "3.14"],
    systemPrompt: {
      role: "data_governance_expert",
      context: "You are evaluating data management solutions against CIS Control 3.1 requirements for comprehensive data governance processes.",
      objective: "Determine if a vendor solution provides documented data management processes covering sensitivity, ownership, handling, retention, and disposal.",
      guidelines: [
        "Verify comprehensive data management process documentation",
        "Confirm coverage of data sensitivity classification and handling procedures", 
        "Validate data ownership assignment and accountability measures",
        "Assess retention policies with both minimum and maximum limits",
        "Review disposal requirements commensurate with data sensitivity",
        "Check annual review processes and change management triggers"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.2": {
    id: "3.2",
    title: "Establish and Maintain a Data Inventory",
    description: "Establish and maintain a data inventory based on the enterprise's data management process. Inventory sensitive data, at a minimum. Review and update inventory annually, at a minimum, with a priority on sensitive data.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Maintain",
      "Review and update inventory annually, at a minimum, with a priority on sensitive data"
    ],
    coreRequirements: [ // Green - The "what"
      "data inventory based on the enterprise's data management process",
      "inventory sensitive data, at a minimum"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Data Inventory",
      "Based on Data Management process",
      "Sensitive Data at a Minimum",
      "Review and update inventory",
      "Annually, at a minimum",
      "Priority on sensitive data"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["1.1", "3.1", "3.3", "3.4", "3.5", "3.6", "3.7", "3.8", "3.9", "3.10", "3.11", "3.12", "3.13", "3.14"],
    systemPrompt: {
      role: "data_inventory_specialist",
      context: "You are evaluating data inventory solutions against CIS Control 3.2 requirements for comprehensive data asset tracking.",
      objective: "Determine if a vendor solution provides complete data inventory capabilities based on enterprise data management processes.",
      guidelines: [
        "Verify comprehensive data inventory creation and maintenance",
        "Confirm sensitive data identification and prioritization",
        "Validate integration with enterprise data management processes",
        "Assess annual review and update mechanisms",
        "Check inventory accuracy and completeness coverage",
        "Review automated discovery and classification capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.3": {
    id: "3.3",
    title: "Configure Data Access Control Lists",
    description: "Configure data access control lists based on a user's need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Configure",
      "Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications"
    ],
    coreRequirements: [ // Green - The "what"
      "data access control lists based on a user's need to know"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Data Access control lists",
      "Based on \"Need to Know\"",
      "ACLS - \"aka\" Access Permissions",
      "Local",
      "Remote File Systems",
      "Applications",
      "Databases"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.1", "3.2", "3.4", "3.5", "3.6", "5.1", "6.1", "6.2"],
    systemPrompt: {
      role: "access_control_specialist",
      context: "You are evaluating data access control solutions against CIS Control 3.3 requirements for need-to-know access management.",
      objective: "Determine if a vendor solution provides comprehensive data access control lists with need-to-know enforcement capabilities.",
      guidelines: [
        "Verify granular access control list configuration and management",
        "Confirm need-to-know principle enforcement mechanisms",
        "Validate coverage across local and remote file systems",
        "Assess database and application access permission capabilities",
        "Review user-based access control granularity",
        "Check integration with identity and access management systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.4": {
    id: "3.4",
    title: "Enforce Data Retention",
    description: "Retain data according to the enterprise's documented data management process. Data retention must include both minimum and maximum timelines.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Retain",
      "Enforce",
      "must include both minimum and maximum timelines"
    ],
    coreRequirements: [ // Green - The "what"
      "data according to the enterprise's documented data management process",
      "Data retention"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Data Retention",
      "Must Include",
      "Minimum Timelines",
      "Maximum timelines"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.1", "3.2", "3.5", "3.6", "3.10"],
    systemPrompt: {
      role: "data_retention_specialist",
      context: "You are evaluating data retention solutions against CIS Control 3.4 requirements for enterprise data lifecycle management.",
      objective: "Determine if a vendor solution provides comprehensive data retention enforcement with minimum and maximum timeline capabilities.",
      guidelines: [
        "Verify documented data retention policy implementation",
        "Confirm minimum and maximum timeline enforcement mechanisms",
        "Validate integration with enterprise data management processes",
        "Assess automated retention schedule management",
        "Review policy compliance monitoring and reporting",
        "Check data lifecycle automation and enforcement capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.5": {
    id: "3.5",
    title: "Securely Dispose of Data",
    description: "Securely dispose of data as outlined in the enterprise's data management process. Ensure the disposal process and method are commensurate with the data sensitivity.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Securely dispose of data",
      "Ensure"
    ],
    coreRequirements: [ // Green - The "what"
      "as outlined in the enterprise's data management process",
      "the disposal process and method are commensurate with the data sensitivity"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Securely dispose of data",
      "Disposal process and method are commensurate with the data sensitivity"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.1", "3.2", "3.4", "3.6", "3.10"],
    systemPrompt: {
      role: "data_disposal_expert",
      context: "You are evaluating secure data disposal solutions against CIS Control 3.5 requirements for enterprise data destruction.",
      objective: "Determine if a vendor solution provides secure data disposal capabilities commensurate with data sensitivity levels.",
      guidelines: [
        "Verify secure disposal method implementation and effectiveness",
        "Confirm data sensitivity-appropriate destruction techniques",
        "Validate integration with enterprise data management processes",
        "Assess destruction method documentation and verification",
        "Review disposal process automation and compliance tracking",
        "Check certification and audit trail capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.6": {
    id: "3.6",
    title: "Encrypt Data on End-User Devices",
    description: "Encrypt data on end-user devices containing sensitive data. Example implementations can include: Windows BitLocker®, Apple FileVault®, Linux® dm-crypt.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Encrypt"
    ],
    coreRequirements: [ // Green - The "what"
      "data on end-user devices containing sensitive data"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Data on end-user devices",
      "Sensitive data"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Windows Bitlocker",
      "Apple FileVault",
      "Linux dm-crypt"
    ],
    relatedSafeguards: ["1.1", "3.1", "3.2", "3.7", "3.8", "3.9", "3.11"],
    systemPrompt: {
      role: "endpoint_encryption_specialist",
      context: "You are evaluating endpoint encryption solutions against CIS Control 3.6 requirements for end-user device data protection.",
      objective: "Determine if a vendor solution provides comprehensive end-user device encryption for sensitive data protection.",
      guidelines: [
        "Verify full disk encryption implementation on end-user devices",
        "Confirm sensitive data encryption coverage and strength",
        "Validate encryption key management and recovery capabilities",
        "Assess cross-platform support (Windows, macOS, Linux)",
        "Review centralized encryption policy management",
        "Check compliance reporting and device encryption status monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.7": {
    id: "3.7",
    title: "Establish and Maintain a Data Classification Scheme",
    description: "Establish and maintain an overall data classification scheme for the enterprise. Enterprises may use labels, such as \"Sensitive,\" \"Confidential,\" and \"Public,\" and classify their data according to those labels. Review and update the classification scheme annually, or when significant enterprise changes occur that could impact this Safeguard.",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Maintain",
      "Review and update the classification scheme annually, or when significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "overall data classification scheme for the enterprise",
      "classify their data according to those labels"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Data classification scheme",
      "Classify their data according to labels",
      "Review and update classification scheme",
      "Annually",
      "When significant enterprise changes occur that could impact this Safeguard"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Sensitive",
      "Confidential", 
      "Public"
    ],
    relatedSafeguards: ["3.1", "3.2", "3.3", "3.8", "3.9", "3.10", "3.11", "3.12"],
    systemPrompt: {
      role: "data_classification_expert",
      context: "You are evaluating data classification solutions against CIS Control 3.7 requirements for enterprise data sensitivity management.",
      objective: "Determine if a vendor solution provides comprehensive data classification scheme establishment and maintenance capabilities.",
      guidelines: [
        "Verify data classification scheme creation and management",
        "Confirm sensitivity label implementation (Sensitive, Confidential, Public)",
        "Validate automated data classification and labeling capabilities",
        "Assess annual review and update processes",
        "Review integration with enterprise data management processes",
        "Check policy enforcement and compliance monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.8": {
    id: "3.8",
    title: "Document Data Flows",
    description: "Document data flows. Data flow documentation includes service provider data flows and should be based on the enterprise's data management process. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Document data flows",
      "Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "Data flow documentation includes service provider data flows and should be based on the enterprise's data management process"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Document data flows",
      "Enterprise Data Flows",
      "Service Provider Data Flows",
      "Review and update documentation",
      "Annually",
      "When significant enterprise changes occur that could impact this Safeguard"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Data management systems",
      "Data flow mapping tools",
      "Service provider documentation"
    ],
    relatedSafeguards: ["3.1", "3.2", "3.7", "3.9", "3.10", "3.11"],
    systemPrompt: {
      role: "data_flow_analyst",
      context: "You are evaluating data flow documentation solutions against CIS Control 3.8 requirements for enterprise data movement tracking.",
      objective: "Determine if a vendor solution provides comprehensive data flow documentation including service provider interactions.",
      guidelines: [
        "Verify comprehensive data flow mapping and documentation",
        "Confirm service provider data flow tracking capabilities",
        "Validate integration with enterprise data management processes",
        "Assess automated data lineage discovery and documentation",
        "Review annual update and change management processes",
        "Check visual mapping and reporting capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.9": {
    id: "3.9",
    title: "Encrypt Data on Removable Media",
    description: "Encrypt Data on Removable Media",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Encrypt Data on Removable Media"
    ],
    coreRequirements: [ // Green - The "what"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Data on Removable Media",
      "Maintain"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.1", "3.6", "3.7", "3.10", "3.11"],
    systemPrompt: {
      role: "removable_media_security_specialist",
      context: "You are evaluating removable media encryption solutions against CIS Control 3.9 requirements for portable storage protection.",
      objective: "Determine if a vendor solution provides comprehensive encryption for data on removable media devices.",
      guidelines: [
        "Verify encryption implementation for all removable media types",
        "Confirm automatic encryption enforcement on USB devices",
        "Validate encryption key management for portable storage",
        "Assess policy-based encryption controls and exceptions",
        "Review centralized management and monitoring capabilities",
        "Check compliance reporting and device access controls"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.10": {
    id: "3.10",
    title: "Encrypt Sensitive Data in Transit",
    description: "Encrypt sensitive data in transit. Example implementations can include: Transport Layer Security (TLS) and Open Secure Shell (OpenSSH).",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Encrypt"
    ],
    coreRequirements: [ // Green - The "what"
      "sensitive data in transit"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Sensitive data in transit"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "TLS",
      "OpenSSH"
    ],
    relatedSafeguards: ["3.1", "3.7", "3.8", "3.11", "13.1", "13.2"],
    systemPrompt: {
      role: "data_in_transit_encryption_expert",
      context: "You are evaluating data-in-transit encryption solutions against CIS Control 3.10 requirements for transmission protection.",
      objective: "Determine if a vendor solution provides comprehensive encryption for sensitive data during transmission.",
      guidelines: [
        "Verify encryption implementation for all data transmissions",
        "Confirm TLS/SSL protocol support and configuration",
        "Validate secure communication protocol enforcement",
        "Assess certificate management and PKI integration",
        "Review encryption strength and algorithm compliance",
        "Check monitoring and compliance reporting capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.11": {
    id: "3.11",
    title: "Encrypt Sensitive Data at Rest",
    description: "Encrypt sensitive data at rest on servers, applications, and databases. Storage-layer encryption, also known as server-side encryption, meets the minimum requirement of this Safeguard. Additional encryption methods may include application-layer encryption, also known as client-side encryption, where access to the data storage device(s) does not permit access to the plain-text data.",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Encrypt",
      "meets the minimum requirement of this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "sensitive data at rest on servers, applications, and databases",
      "Storage-layer encryption, also known as server-side encryption"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Encrypt Sensitive Data At Rest",
      "Servers",
      "Applications", 
      "Databases",
      "Storage Layer (server side) encryption",
      "Minimum Requirement"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Application layer (client-side) encryption",
      "Where access to the data storage device(s) does not permit access to the plain-text data"
    ],
    relatedSafeguards: ["3.1", "3.6", "3.7", "3.9", "3.10", "11.1"],
    systemPrompt: {
      role: "data_at_rest_encryption_specialist",
      context: "You are evaluating data-at-rest encryption solutions against CIS Control 3.11 requirements for stored data protection.",
      objective: "Determine if a vendor solution provides comprehensive encryption for sensitive data stored on servers, applications, and databases.",
      guidelines: [
        "Verify storage-layer encryption implementation on servers and databases",
        "Confirm application-layer encryption capabilities for sensitive data",
        "Validate encryption key management and protection mechanisms",
        "Assess transparent data encryption and file-level encryption",
        "Review encryption performance impact and optimization",
        "Check compliance reporting and encryption status monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.12": {
    id: "3.12",
    title: "Segment Data Processing and Storage Based on Sensitivity",
    description: "Segment data processing and storage based on the sensitivity of the data. Do not process sensitive data on enterprise assets intended for lower sensitivity data.",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Segment data processing and storage based on the sensitivity of the data",
      "Do not process sensitive data on enterprise assets intended for lower sensitivity data"
    ],
    coreRequirements: [ // Green - The "what"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Based on the sensitivity of data",
      "Segment data processing (compute)",
      "Segment Storage",
      "Do not process sensitive data on enterprise assets intended for lower sensitivity data"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.1", "3.7", "12.1", "12.2", "12.3"],
    systemPrompt: {
      role: "data_segmentation_architect",
      context: "You are evaluating data segmentation solutions against CIS Control 3.12 requirements for sensitivity-based data isolation.",
      objective: "Determine if a vendor solution provides comprehensive data processing and storage segmentation based on sensitivity levels.",
      guidelines: [
        "Verify data segmentation implementation based on classification",
        "Confirm isolation of sensitive data from lower sensitivity environments",
        "Validate network and storage separation capabilities",
        "Assess automated policy enforcement for data placement",
        "Review access control integration with segmentation",
        "Check monitoring and compliance reporting for data isolation"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.13": {
    id: "3.13",
    title: "Deploy a Data Loss Prevention Solution",
    description: "Implement an automated tool, such as a host-based Data Loss Prevention (DLP) tool to identify all sensitive data stored, processed, or transmitted through enterprise assets, including those located onsite or at a remote service provider, and update the enterprise's data inventory.",
    implementationGroup: "IG3",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Implement",
      "Update Data Inventory"
    ],
    coreRequirements: [ // Green - The "what"
      "automated tool to identify all sensitive data stored, processed, or transmitted through enterprise assets, including those located onsite or at a remote service provider"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Automated DLP Tool",
      "Identify all sensitive Data",
      "Stored",
      "Processed",
      "Transmitted",
      "Onsite Data",
      "Remote Service Provider",
      "Update Data Inventory"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Host-based Data loss Prevention (DLP) tool"
    ],
    relatedSafeguards: ["3.1", "3.7", "3.8", "3.10", "3.11"],
    systemPrompt: {
      role: "data_loss_prevention_specialist",
      context: "You are evaluating Data Loss Prevention solutions against CIS Control 3.13 requirements for automated sensitive data identification and protection.",
      objective: "Determine if a vendor solution provides comprehensive DLP capabilities for identifying and protecting sensitive data across all enterprise assets.",
      guidelines: [
        "Verify automated sensitive data discovery and classification",
        "Confirm comprehensive coverage across onsite and remote assets",
        "Validate data inventory integration and updating capabilities",
        "Assess policy-based data protection and loss prevention",
        "Review monitoring, alerting, and incident response integration",
        "Check service provider data protection coverage"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "3.14": {
    id: "3.14",
    title: "Log Sensitive Data Access",
    description: "Log sensitive data access, including modification and disposal.",
    implementationGroup: "IG3",
    assetType: ["data"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "Log"
    ],
    coreRequirements: [ // Green - The "what"
      "sensitive data access, including modification and disposal"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Sensitive Data access",
      "Access",
      "Modification",
      "Disposal"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
    ],
    relatedSafeguards: ["3.1", "3.7", "3.8", "8.1", "8.2"],
    systemPrompt: {
      role: "data_access_auditing_expert",
      context: "You are evaluating data access logging solutions against CIS Control 3.14 requirements for sensitive data activity monitoring.",
      objective: "Determine if a vendor solution provides comprehensive logging of sensitive data access, modification, and disposal activities.",
      guidelines: [
        "Verify comprehensive logging of all sensitive data access events",
        "Confirm modification and disposal activity tracking",
        "Validate integration with audit log management systems",
        "Assess real-time monitoring and alerting capabilities",
        "Review log retention and analysis capabilities",
        "Check compliance reporting and forensic investigation support"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.1": {
    id: "4.1",
    title: "Establish and Maintain a Secure Configuration Process",
    description: "Establish and maintain a documented secure configuration process for enterprise assets (end-user devices, including portable and mobile; non-computing/IoT devices; and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.",
    implementationGroup: "IG1",
    assetType: ["end-user devices", "network devices", "IoT devices", "servers", "applications"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Maintain",
      "Documented Secure Configuration Process",
      "Review and update documentation",
      "Annually",
      "When significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "documented secure configuration process for enterprise assets",
      "documented secure configuration process for software"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Enterprise assets",
      "Software",
      "End-user devices",
      "Mobile",
      "Portable",
      "Non-computing/IoT devices",
      "Servers",
      "OS",
      "Applications"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Secure Configuration Policy / Process",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["1.1", "2.1", "4.2", "4.3", "4.4", "4.5", "4.6", "4.7", "4.8", "4.9", "4.10", "4.11", "4.12"],
    systemPrompt: {
      role: "secure_configuration_expert",
      context: "You are evaluating secure configuration management solutions against CIS Control 4.1 requirements for enterprise asset hardening.",
      objective: "Determine if a vendor solution provides comprehensive secure configuration processes for enterprise assets and software.",
      guidelines: [
        "Verify documented secure configuration process establishment",
        "Confirm coverage of all enterprise assets and software types",
        "Validate configuration baseline management and enforcement",
        "Assess automated configuration monitoring and remediation",
        "Review annual process updates and change management",
        "Check integration with configuration management tools"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.2": {
    id: "4.2",
    title: "Establish and Maintain a Secure Configuration Process for Network Infrastructure",
    description: "Establish and maintain a documented secure configuration process for network devices. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.",
    implementationGroup: "IG1",
    assetType: ["network devices"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Maintain",
      "Documented Secure Network Configuration Process",
      "Review and update documentation",
      "Annually",
      "When significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "documented secure configuration process for network devices"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Network devices"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Secure Configuration Policy / Process",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["1.1", "2.1", "3.10", "4.1", "6.4", "8.1", "12.1", "12.2", "12.3", "12.4", "12.5", "13.3", "13.4", "13.6", "13.8", "13.9", "13.10"],
    systemPrompt: {
      role: "network_configuration_specialist",
      context: "You are evaluating network infrastructure configuration solutions against CIS Control 4.2 requirements for secure network device management.",
      objective: "Determine if a vendor solution provides comprehensive secure configuration processes for network infrastructure devices.",
      guidelines: [
        "Verify documented network configuration process establishment",
        "Confirm coverage of all network infrastructure device types",
        "Validate network security baseline management and enforcement",
        "Assess automated network configuration monitoring and compliance",
        "Review network change management and approval processes",
        "Check integration with network management and security tools"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.3": {
    id: "4.3",
    title: "Configure Automatic Session Locking on Enterprise Assets",
    description: "Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period Must Not Exceed 15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Configure",
      "Period must not exceed for 15 Minutes",
      "Period must not exceed for 2 Minutes"
    ],
    coreRequirements: [ // Green - The "what"
      "automatic session locking on enterprise assets after a defined period of inactivity",
      "general purpose operating systems",
      "mobile end-user devices"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Automatic Session Locking",
      "Period of inactivity",
      "General Purpose OSs",
      "Mobile end-user devices"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "session_security_specialist",
      context: "You are evaluating session management solutions against CIS Control 4.3 requirements for automatic session locking.",
      objective: "Determine if a vendor solution provides comprehensive automatic session locking capabilities for enterprise assets.",
      guidelines: [
        "Verify automatic session locking configuration and enforcement",
        "Confirm inactivity period customization and policy management",
        "Validate coverage across all enterprise asset types",
        "Assess mobile and desktop operating system support",
        "Review centralized policy deployment and monitoring",
        "Check user experience and security balance optimization"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.4": {
    id: "4.4",
    title: "Implement and Manage a Firewall on Servers",
    description: "Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third-party firewall agent.",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Implement",
      "Manage",
      "Where Supported"
    ],
    coreRequirements: [ // Green - The "what"
      "firewall on servers"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Server Firewall"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Virtual Firewall",
      "OS Firewall", 
      "Third Party Firewall",
      "Firewall",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "server_firewall_expert",
      context: "You are evaluating server firewall solutions against CIS Control 4.4 requirements for host-based server protection.",
      objective: "Determine if a vendor solution provides comprehensive firewall implementation and management for servers.",
      guidelines: [
        "Verify host-based firewall implementation on all servers",
        "Confirm virtual environment and container firewall support",
        "Validate centralized firewall policy management",
        "Assess rule automation and threat-based configuration",
        "Review monitoring, alerting, and compliance reporting",
        "Check integration with security management platforms"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.5": {
    id: "4.5",
    title: "Implement and Manage a Firewall on End-User Devices",
    description: "Implement and manage a host-based firewall or port-filtering tool on end-user devices, with a default-deny rule that drops all traffic except those services and ports that are explicitly allowed.",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Implement",
      "Manage",
      "Default deny rule that drops all traffic",
      "Except Explicitly Allowed"
    ],
    coreRequirements: [ // Green - The "what"
      "host-based firewall or port-filtering tool on end-user devices"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Host-based Firewall",
      "Port Filtering Tool",
      "End User Devices",
      "Services",
      "Ports"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Firewall",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "endpoint_firewall_specialist",
      context: "You are evaluating endpoint firewall solutions against CIS Control 4.5 requirements for end-user device protection.",
      objective: "Determine if a vendor solution provides comprehensive host-based firewall and port filtering for end-user devices.",
      guidelines: [
        "Verify host-based firewall implementation on all end-user devices",
        "Confirm default-deny policy with explicit allow configurations",
        "Validate port-filtering capabilities and rule management",
        "Assess centralized policy deployment and management",
        "Review monitoring, logging, and compliance reporting",
        "Check user experience and productivity impact minimization"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.6": {
    id: "4.6",
    title: "Securely Manage Enterprise Assets and Software",
    description: "Securely manage enterprise assets and software. Example implementations include managing configuration through version-controlled- Infrastructure-as-Code (IaC) and accessing administrative interfaces over secure network protocols, such as Secure Shell (SSH) and Hypertext Transfer Protocol Secure (HTTPS). Do not use insecure management protocols, such as Telnet (Teletype Network) and HTTP, unless operationally essential.",
    implementationGroup: "IG1",
    assetType: ["devices", "applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Do not use insecure management protocols",
      "Unless operationally essential"
    ],
    coreRequirements: [ // Green - The "what"
      "Securely manage enterprise assets and software"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Securely manage enterprise assets and software"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Manage configuration through version-controlled Infrastructure-as-Code (IaC)",
      "Accessing administrative interfaces over secure network protocols",
      "SSH",
      "HTTPS",
      "Telnet (Teletype Network)",
      "HTTP",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1", "12.3"],
    systemPrompt: {
      role: "secure_administration_expert",
      context: "You are evaluating secure administrative interface solutions against CIS Control 4.6 requirements for enterprise asset management.",
      objective: "Determine if a vendor solution provides secure management of enterprise assets and software administrative interfaces.",
      guidelines: [
        "Verify secure administrative interface implementation (SSH, HTTPS)",
        "Confirm infrastructure-as-code security management capabilities",
        "Validate encrypted administrative communication protocols",
        "Assess administrative access control and authentication",
        "Review privileged session monitoring and recording",
        "Check integration with privileged access management systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.7": {
    id: "4.7",
    title: "Manage Default Accounts on Enterprise Assets and Software",
    description: "Manage default accounts on enterprise assets and software, such as root, administrator, and other pre-configured vendor accounts. Example implementations can include: disabling default accounts or making them unusable.",
    implementationGroup: "IG1",
    assetType: ["devices", "applications", "users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Manage"
    ],
    coreRequirements: [ // Green - The "what"
      "default accounts on enterprise assets and software"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Default accounts",
      "Enterprise assets",
      "Software",
      "Root",
      "Administrator",
      "Other pre-configured vendor accounts"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Disabling",
      "Unusable",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "default_account_security_specialist",
      context: "You are evaluating default account management solutions against CIS Control 4.7 requirements for vendor account security.",
      objective: "Determine if a vendor solution provides comprehensive management of default accounts on enterprise assets and software.",
      guidelines: [
        "Verify identification and management of all default accounts",
        "Confirm default account disabling or secure configuration",
        "Validate vendor-supplied account discovery and remediation",
        "Assess automated default account detection and management",
        "Review policy enforcement and compliance monitoring",
        "Check integration with identity and access management systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.8": {
    id: "4.8",
    title: "Uninstall or Disable Unnecessary Services on Enterprise Assets and Software",
    description: "Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function.",
    implementationGroup: "IG2",
    assetType: ["devices", "applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Uninstall",
      "Disable"
    ],
    coreRequirements: [ // Green - The "what"
      "unnecessary services on enterprise assets and software"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Unnecessary Services",
      "Enterprise assets",
      "Software",
      "Unused file sharing service",
      "Web application module",
      "Service function"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "service_hardening_expert",
      context: "You are evaluating service management solutions against CIS Control 4.8 requirements for unnecessary service removal.",
      objective: "Determine if a vendor solution provides comprehensive identification and management of unnecessary services on enterprise assets.",
      guidelines: [
        "Verify identification of all unnecessary services and functions",
        "Confirm automated service removal and disabling capabilities",
        "Validate coverage across all enterprise asset types",
        "Assess risk-based service evaluation and recommendation",
        "Review service dependency analysis and impact assessment",
        "Check ongoing monitoring and compliance enforcement"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.9": {
    id: "4.9",
    title: "Configure Trusted DNS Servers on Enterprise Assets",
    description: "Configure trusted DNS servers on enterprise assets. Example implementations include: configuring assets to use enterprise-controlled DNS servers and/or reputable externally accessible DNS servers.",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Configure"
    ],
    coreRequirements: [ // Green - The "what"
      "trusted DNS servers on enterprise assets"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Trusted DNS Servers",
      "Enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Configuring assets to use enterprise-controlled DNS servers",
      "Reputable externally accessible DNS servers",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1", "8.6", "9.2"],
    systemPrompt: {
      role: "dns_security_specialist",
      context: "You are evaluating DNS security solutions against CIS Control 4.9 requirements for trusted DNS server configuration.",
      objective: "Determine if a vendor solution provides comprehensive trusted DNS server configuration and management for enterprise assets.",
      guidelines: [
        "Verify trusted DNS server configuration on all enterprise assets",
        "Confirm enterprise-controlled or reputable DNS service usage",
        "Validate DNS security policy enforcement and monitoring",
        "Assess DNS filtering and threat protection capabilities",
        "Review centralized DNS configuration management",
        "Check DNS query logging and analysis capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.10": {
    id: "4.10",
    title: "Enforce Automatic Device Lockout on Portable End-User Devices",
    description: "Enforce automatic device lockout following a predetermined threshold of local failed authentication attempts on portable end-user devices, where supported. For laptops, do not allow more than 20 failed authentication attempts; for tablets and smartphones, no more than 10 failed authentication attempts. Example implementations include Microsoft® InTune Device Lock and Apple® Configuration Profile maxFailedAttempts.",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Enforce",
      "Where supported",
      "Do not allow more than 20 Failed Authentication Attempts",
      "No more than 10 Failed Authentication Attempts"
    ],
    coreRequirements: [ // Green - The "what"
      "automatic device lockout following a predetermined threshold of local failed authentication attempts on portable end-user devices"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Automatic Device Lockout",
      "Predetermined threshold of local failed authentication attempts",
      "Portable end-user devices",
      "Laptops",
      "Tablets and smartphones"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Microsoft® InTune Device Lock",
      "Apple® Configuration Profile maxFailedAttempts",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "device_lockout_security_expert",
      context: "You are evaluating device lockout solutions against CIS Control 4.10 requirements for failed authentication protection.",
      objective: "Determine if a vendor solution provides comprehensive automatic device lockout enforcement for portable end-user devices.",
      guidelines: [
        "Verify automatic device lockout after failed authentication attempts",
        "Confirm coverage across all portable device types (laptops, tablets, smartphones)",
        "Validate lockout policy customization and management",
        "Assess integration with mobile device management platforms",
        "Review unlock procedures and security recovery mechanisms",
        "Check compliance monitoring and reporting capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.11": {
    id: "4.11",
    title: "Enforce Remote Wipe Capability on Portable End-User Devices",
    description: "Remotely wipe enterprise data from enterprise-owned portable end-user devices when deemed appropriate such as lost or stolen devices, or when an individual no longer supports the enterprise.",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "When deemed appropriate"
    ],
    coreRequirements: [ // Green - The "what"
      "Remotely wipe enterprise data from enterprise-owned portable end-user devices"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Remotely Wipe enterprise data",
      "Portable end-user devices",
      "Lost devices",
      "Stolen devices",
      "When an individual no longer supports the enterprise"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "remote_wipe_specialist",
      context: "You are evaluating remote wipe solutions against CIS Control 4.11 requirements for enterprise data protection on portable devices.",
      objective: "Determine if a vendor solution provides comprehensive remote wipe capabilities for enterprise data on portable end-user devices.",
      guidelines: [
        "Verify remote wipe capability for all enterprise-owned portable devices",
        "Confirm selective enterprise data wiping without affecting personal data",
        "Validate real-time remote wipe execution and verification",
        "Assess integration with mobile device management platforms",
        "Review policy-based automated wiping triggers",
        "Check audit trails and compliance reporting for wipe operations"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "4.12": {
    id: "4.12",
    title: "Separate Enterprise Workspaces on Mobile End-User Devices",
    description: "Ensure separate enterprise workspaces are used on mobile end-user devices, where supported. Example implementations include using an Apple® Configuration Profile or AndroidTM Work Profile to separate enterprise applications and data from personal applications and data.",
    implementationGroup: "IG3",
    assetType: ["devices", "data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Ensure",
      "Where Supported"
    ],
    coreRequirements: [ // Green - The "what"
      "separate enterprise workspaces are used on mobile end-user devices"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Separate enterprise workspaces",
      "On Mobile Devices",
      "Enterprise Applications",
      "Enterprise Data",
      "Personal Applications",
      "Personal Data"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Apple® Configuration Profile",
      "AndroidTM Work Profile",
      "Configuration Management Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "mobile_workspace_security_expert",
      context: "You are evaluating mobile workspace separation solutions against CIS Control 4.12 requirements for enterprise and personal data isolation.",
      objective: "Determine if a vendor solution provides comprehensive enterprise workspace separation on mobile end-user devices.",
      guidelines: [
        "Verify enterprise workspace separation on mobile devices",
        "Confirm support for Apple Configuration Profiles and Android Work Profiles",
        "Validate application and data isolation between enterprise and personal spaces",
        "Assess policy enforcement and workspace management capabilities",
        "Review user experience and productivity optimization",
        "Check compliance monitoring and enterprise data protection"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "5.2": {
    id: "5.2",
    title: "Use Unique Passwords",
    description: "Use unique passwords for all enterprise assets. Best practice implementation includes, at a minimum, an 8-character password for accounts using Multi-Factor Authentication (MFA) and a 14-character password for accounts not using MFA.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Use unique passwords for all enterprise assets",
      "Best practice implementation includes, at a minimum, an 8-character password for accounts using Multi-Factor Authentication (MFA) and a 14-character password for accounts not using MFA"
    ],
    coreRequirements: [ // Green - The "what"
      "Unique Passwords"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Use",
      "At a minimum",
      "All Enterprise Assets",
      "8-character password for accounts using MFA",
      "14-character password for accounts not using MFA"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Password Management Tool"
    ],
    relatedSafeguards: ["5.1"],
    systemPrompt: {
      role: "password_security_expert",
      context: "You are evaluating password management solutions against CIS Control 5.2 requirements for unique password enforcement.",
      objective: "Determine if a vendor solution provides comprehensive unique password enforcement for enterprise assets.",
      guidelines: [
        "Verify unique password requirement enforcement across all assets",
        "Confirm minimum length requirements (8-character minimum, 14-character for non-MFA)",
        "Validate password complexity and uniqueness checking",
        "Assess integration with multi-factor authentication systems",
        "Review password policy management and enforcement capabilities",
        "Check compliance monitoring and password strength reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "5.3": {
    id: "5.3",
    title: "Disable Dormant Accounts",
    description: "Delete or disable any dormant accounts after a period of 45 days of inactivity, where supported.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Delete or disable any dormant accounts after a period of 45 days of inactivity, where supported"
    ],
    coreRequirements: [ // Green - The "what"
      "Dormant Accounts"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Disable",
      "Delete",
      "Period of 45 days of inactivity",
      "Where Supported"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Identity and Access Management Tool"
    ],
    relatedSafeguards: ["5.1"],
    systemPrompt: {
      role: "dormant_account_management_specialist",
      context: "You are evaluating dormant account management solutions against CIS Control 5.3 requirements for inactive account cleanup.",
      objective: "Determine if a vendor solution provides comprehensive dormant account detection and management capabilities.",
      guidelines: [
        "Verify automated dormant account detection after 45 days inactivity",
        "Confirm account deletion or disabling capabilities",
        "Validate supported vs unsupported account handling",
        "Assess automated workflow and approval processes",
        "Review account activity monitoring and tracking",
        "Check compliance reporting and audit trail capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "5.4": {
    id: "5.4",
    title: "Restrict Administrator Privileges to Dedicated Administrator Accounts",
    description: "Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user's primary, non-privileged account.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Restrict administrator privileges to dedicated administrator accounts on enterprise assets",
      "Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user's primary, non-privileged account"
    ],
    coreRequirements: [ // Green - The "what"
      "Administrator Privileges",
      "Dedicated Admin Accounts"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Restrict",
      "Enterprise assets",
      "User's primary, non-privileged account",
      "General Computing Activities"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Identity and Access Management Tool",
      "Such as",
      "Internet browsing",
      "Email",
      "Productivity suite use"
    ],
    relatedSafeguards: ["4.1", "5.1"],
    systemPrompt: {
      role: "privileged_access_specialist",
      context: "You are evaluating privileged access management solutions against CIS Control 5.4 requirements for administrator privilege restriction.",
      objective: "Determine if a vendor solution provides comprehensive administrator privilege restriction and dedicated account management.",
      guidelines: [
        "Verify administrator privilege restriction to dedicated accounts only",
        "Confirm separation of administrative and general computing activities",
        "Validate privileged access controls and session management",
        "Assess just-in-time privilege elevation capabilities",
        "Review privileged session monitoring and recording",
        "Check compliance with principle of least privilege enforcement"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "5.5": {
    id: "5.5",
    title: "Establish and Maintain an Inventory of Service Accounts",
    description: "Establish and maintain an inventory of service accounts. The inventory, at a minimum, must contain department owner, review date, and purpose. Perform service account reviews to validate that all active accounts are authorized, on a recurring schedule at a minimum quarterly, or more frequently.",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish and maintain an inventory of service accounts",
      "The inventory, at a minimum, must contain department owner, review date, and purpose",
      "Perform service account reviews to validate that all active accounts are authorized, on a recurring schedule at a minimum quarterly, or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "Inventory of Service Accounts"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Establish",
      "Maintain",
      "At a Minimum Must Contain",
      "Perform service account reviews to validate that all active accounts are authorized",
      "On a recurring schedule",
      "Department Owner",
      "Review date",
      "Purpose",
      "At a minimum quarterly",
      "More frequently",
      "Or"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Identity and Access Management Tool"
    ],
    relatedSafeguards: ["5.1"],
    systemPrompt: {
      role: "service_account_management_expert",
      context: "You are evaluating service account management solutions against CIS Control 5.5 requirements for service account inventory and oversight.",
      objective: "Determine if a vendor solution provides comprehensive service account inventory management and quarterly validation processes.",
      guidelines: [
        "Verify comprehensive service account inventory establishment",
        "Confirm tracking of department, owner, purpose, and review dates",
        "Validate quarterly service account review and authorization processes",
        "Assess automated service account discovery and classification",
        "Review service account lifecycle management capabilities",
        "Check compliance monitoring and unauthorized account detection"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "5.6": {
    id: "5.6",
    title: "Centralize Account Management",
    description: "Centralize account management through a directory or identity service.",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Centralize account management through a directory or identity service"
    ],
    coreRequirements: [ // Green - The "what"
      "Account Management"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Centralize",
      "Directory Service",
      "Identity Service",
      "Or"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Identity and Access Management Tool"
    ],
    relatedSafeguards: ["5.1", "6.6", "6.7", "12.5"],
    systemPrompt: {
      role: "centralized_identity_specialist",
      context: "You are evaluating centralized identity management solutions against CIS Control 5.6 requirements for directory service implementation.",
      objective: "Determine if a vendor solution provides comprehensive centralized account management through directory or identity services.",
      guidelines: [
        "Verify centralized account management implementation",
        "Confirm directory service or identity service capabilities",
        "Validate integration with enterprise authentication systems",
        "Assess single sign-on and identity federation support",
        "Review account provisioning and deprovisioning automation",
        "Check scalability and multi-domain support capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.1": {
    id: "6.1",
    title: "Establish an Access Granting Process",
    description: "Establish and follow a documented process, preferably automated, for granting access to enterprise assets upon new hire or role change of a user.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Follow",
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process",
      "Documentation"
    ],
    coreRequirements: [ // Green - The "what"
      "documented process",
      "granting access to enterprise assets"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "preferably automated",
      "upon new hire",
      "role change of a user",
      "New Hire",
      "Role Change",
      "Enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process"
    ],
    relatedSafeguards: ["5.1", "6.7", "6.8"],
    systemPrompt: {
      role: "access_granting_process_expert",
      context: "You are evaluating access granting solutions against CIS Control 6.1 requirements for establishing documented access provisioning processes.",
      objective: "Determine if a vendor solution provides comprehensive access granting processes for new hires and role changes.",
      guidelines: [
        "Verify existence of documented access granting procedures",
        "Confirm automation capabilities for access provisioning",
        "Validate coverage of new hire onboarding scenarios",
        "Assess role change access modification processes",
        "Review enterprise asset access management integration",
        "Check process documentation and governance compliance"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.2": {
    id: "6.2",
    title: "Establish an Access Revoking Process",
    description: "Establish and follow a process, preferably automated, for revoking access to enterprise assets, through disabling accounts immediately upon termination, rights revocation, or role change of a user. Disabling accounts, instead of deleting accounts, may be necessary to preserve audit trails.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "Follow",
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process",
      "Documentation"
    ],
    coreRequirements: [ // Green - The "what"
      "process",
      "revoking access to enterprise assets",
      "disabling accounts immediately"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "preferably automated",
      "upon termination",
      "rights revocation",
      "role change of a user",
      "Role Change",
      "Termination",
      "Rights revocation",
      "Enterprise assets",
      "Disabling accounts immediately"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Disabling accounts, instead of deleting accounts, may be necessary to preserve audit trails",
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process"
    ],
    relatedSafeguards: ["5.1", "6.7"],
    systemPrompt: {
      role: "access_revocation_process_expert",
      context: "You are evaluating access revocation solutions against CIS Control 6.2 requirements for establishing documented access deprovisioning processes.",
      objective: "Determine if a vendor solution provides comprehensive access revocation processes for terminations, rights changes, and role modifications.",
      guidelines: [
        "Verify existence of documented access revocation procedures",
        "Confirm automation capabilities for access deprovisioning",
        "Validate immediate account disabling upon termination",
        "Assess role change access modification processes",
        "Review account preservation vs deletion for audit trail requirements",
        "Check process documentation and governance compliance"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.4": {
    id: "6.4",
    title: "Require MFA for Remote Network Access",
    description: "Require MFA for remote network access.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Require",
      "Account and Access Control Management",
      "Multi-Factor Authentication Tool"
    ],
    coreRequirements: [ // Green - The "what"
      "MFA",
      "remote network access"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Remote Network Access"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Multi-Factor Authentication Tool"
    ],
    relatedSafeguards: ["4.2", "12.7"],
    systemPrompt: {
      role: "remote_access_security_specialist",
      context: "You are evaluating remote access security solutions against CIS Control 6.4 requirements for MFA on remote network access.",
      objective: "Determine if a vendor solution provides comprehensive MFA enforcement for remote network access connections.",
      guidelines: [
        "Verify MFA requirement for all remote network access",
        "Confirm coverage of VPN, RDP, and other remote access methods",
        "Validate integration with network access control systems",
        "Assess conditional access and risk-based authentication",
        "Review remote access session monitoring and logging",
        "Check policy enforcement and compliance reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.5": {
    id: "6.5",
    title: "Require MFA for Administrative Access",
    description: "Require MFA for all administrative access accounts, where supported, on all enterprise assets, whether managed on-site or through a service provider.",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Require",
      "Account and Access Control Management",
      "Multi-Factor Authentication Tool"
    ],
    coreRequirements: [ // Green - The "what"
      "MFA",
      "all administrative access accounts",
      "all enterprise assets"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "where supported",
      "All Admin Access Accounts",
      "All enterprise assets",
      "Onsite Management",
      "Service Provider",
      "Or"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Multi-Factor Authentication Tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "administrative_access_security_expert",
      context: "You are evaluating administrative access security solutions against CIS Control 6.5 requirements for MFA on administrative accounts.",
      objective: "Determine if a vendor solution provides comprehensive MFA enforcement for administrative access to enterprise assets.",
      guidelines: [
        "Verify MFA requirement for all administrative account access",
        "Confirm coverage of onsite and service provider managed assets",
        "Validate privileged access management integration",
        "Assess just-in-time access and session management",
        "Review administrative session monitoring and recording",
        "Check policy enforcement and administrative access compliance"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.6": {
    id: "6.6",
    title: "Establish and Maintain an Inventory of Authentication and Authorization Systems",
    description: "Establish and maintain an inventory of the enterprise's authentication and authorization systems, including those hosted on-site or at a remote service provider. Review and update the inventory, at a minimum, annually, or more frequently.",
    implementationGroup: "IG2",
    assetType: ["software"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "Establish",
      "maintain",
      "Review and update",
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process"
    ],
    coreRequirements: [ // Green - The "what"
      "inventory of the enterprise's authentication and authorization systems"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "including those hosted on-site or at a remote service provider",
      "at a minimum, annually, or more frequently",
      "Hosted on-site",
      "Remote Service Provider",
      "Or",
      "At a minimum Annually",
      "More frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process"
    ],
    relatedSafeguards: ["1.1", "2.1", "3.3", "5.6", "6.7"],
    systemPrompt: {
      role: "authentication_authorization_inventory_expert",
      context: "You are evaluating authentication and authorization inventory solutions against CIS Control 6.6 requirements for comprehensive system tracking.",
      objective: "Determine if a vendor solution provides complete inventory capabilities for authentication and authorization systems across the enterprise.",
      guidelines: [
        "Verify comprehensive authentication system discovery and inventory",
        "Confirm authorization system tracking and documentation",
        "Validate coverage of on-site and remote service provider systems",
        "Assess inventory maintenance and annual review capabilities",
        "Review system classification and risk assessment features",
        "Check integration with identity governance platforms"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.7": {
    id: "6.7",
    title: "Centralize Access Control",
    description: "Centralize access control for all enterprise assets through a directory service or SSO provider, where supported.",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "Centralize",
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process",
      "Identity and Access Management Tool"
    ],
    coreRequirements: [ // Green - The "what"
      "access control",
      "all enterprise assets"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "through a directory service or SSO provider",
      "where supported",
      "Directory Service",
      "SSO Provider",
      "Or",
      "All enterprise assets",
      "Where Supported"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process",
      "Identity and Access Management Tool"
    ],
    relatedSafeguards: ["4.1", "5.1", "5.6", "6.1", "6.2", "6.6", "12.5", "12.7"],
    systemPrompt: {
      role: "centralized_access_control_expert",
      context: "You are evaluating centralized access control solutions against CIS Control 6.7 requirements for directory service and SSO-based access management.",
      objective: "Determine if a vendor solution provides comprehensive centralized access control for enterprise assets through directory services or SSO providers.",
      guidelines: [
        "Verify centralized access control implementation capabilities",
        "Confirm directory service integration and management",
        "Validate SSO provider connectivity and configuration",
        "Assess enterprise asset coverage and support levels",
        "Review access policy enforcement and administration",
        "Check scalability and performance of centralized systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "6.8": {
    id: "6.8",
    title: "Define and Maintain Role-Based Access Control",
    description: "Define and maintain role-based access control, through determining and documenting the access rights necessary for each role within the enterprise to successfully carry out its assigned duties. Perform access control reviews of enterprise assets to validate that all privileges are authorized, on a recurring schedule at a minimum annually, or more frequently.",
    implementationGroup: "IG3",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "Define",
      "maintain",
      "Perform access control reviews of enterprise assets to validate that all privileges are authorized, on a recurring schedule at a minimum annually, or more frequently",
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process",
      "Identity and Access management Tool"
    ],
    coreRequirements: [ // Green - The "what"
      "role-based access control",
      "determining and documenting the access rights necessary for each role within the enterprise to successfully carry out its assigned duties"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "Access rights",
      "Each Role",
      "Necessary",
      "Successfully carry out its assigned duties",
      "Determining",
      "Documenting",
      "At a minimum Annually",
      "More frequently",
      "Or"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Account and Access Control Management",
      "Account and Credential Management Policy/Process",
      "Identity and Access management Tool"
    ],
    relatedSafeguards: ["3.3", "4.1", "6.1"],
    systemPrompt: {
      role: "role_based_access_control_expert",
      context: "You are evaluating role-based access control solutions against CIS Control 6.8 requirements for defining, maintaining, and reviewing role-based permissions.",
      objective: "Determine if a vendor solution provides comprehensive RBAC capabilities including role definition, access rights documentation, and periodic reviews.",
      guidelines: [
        "Verify role definition and maintenance capabilities",
        "Confirm access rights documentation and mapping to roles",
        "Validate enterprise role modeling and assignment processes",
        "Assess access control review and validation features",
        "Review privilege authorization and least privilege enforcement",
        "Check annual review processes and compliance reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.2": {
    id: "7.2",
    title: "Establish and Maintain a Remediation Process",
    description: "Establish and maintain a remediation process and SLA for security vulnerabilities",
    implementationGroup: "IG1",
    assetType: ["applications"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "establish remediation process",
      "maintain remediation process",
      "SLA for security vulnerabilities",
      "vulnerability remediation governance"
    ],
    coreRequirements: [ // Green - The "what"
      "remediation process",
      "service level agreement",
      "security vulnerability handling",
      "remediation timeline management"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "vulnerability prioritization",
      "remediation timelines",
      "escalation procedures",
      "patch management integration",
      "risk-based remediation",
      "remediation tracking",
      "verification procedures"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "vulnerability management platforms",
      "patch management systems",
      "remediation workflow tools",
      "SLA tracking systems",
      "risk scoring frameworks"
    ],
    relatedSafeguards: ["7.1", "7.3", "7.4", "7.5", "7.6", "7.7"],
    systemPrompt: {
      role: "vulnerability_remediation_process_expert",
      context: "You are evaluating vulnerability remediation solutions against CIS Control 7.2 requirements for establishing remediation processes and SLAs.",
      objective: "Determine if a vendor solution provides comprehensive vulnerability remediation process management and SLA capabilities.",
      guidelines: [
        "Verify remediation process establishment and maintenance",
        "Confirm SLA definition and tracking for security vulnerabilities",
        "Validate vulnerability prioritization and timeline management",
        "Assess remediation workflow automation and escalation procedures",
        "Review patch management integration and coordination",
        "Check remediation verification and compliance reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.3": {
    id: "7.3",
    title: "Perform Automated Operating System Patch Management",
    description: "Perform automated operating system patch management on enterprise assets",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "perform automated OS patch management",
      "enterprise assets coverage",
      "automated patching requirement",
      "patch management governance"
    ],
    coreRequirements: [ // Green - The "what"
      "automated operating system patching",
      "enterprise asset coverage",
      "patch deployment automation",
      "OS security updates"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "patch deployment scheduling",
      "patch testing procedures",
      "rollback capabilities",
      "patch compliance monitoring",
      "emergency patching procedures",
      "patch approval workflows",
      "system restart management"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Windows Update Services",
      "patch management platforms",
      "configuration management tools",
      "automated patching solutions",
      "system center tools"
    ],
    relatedSafeguards: ["1.1", "4.1", "7.1", "7.2", "7.4", "7.5"],
    systemPrompt: {
      role: "automated_os_patch_management_expert",
      context: "You are evaluating automated OS patch management solutions against CIS Control 7.3 requirements for automated operating system patching.",
      objective: "Determine if a vendor solution provides comprehensive automated operating system patch management for enterprise assets.",
      guidelines: [
        "Verify automated OS patch deployment capabilities",
        "Confirm enterprise asset coverage and compatibility",
        "Validate patch testing and approval workflows",
        "Assess patch scheduling and deployment automation",
        "Review rollback capabilities and failure recovery",
        "Check compliance monitoring and patch status reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.4": {
    id: "7.4",
    title: "Perform Automated Application Patch Management",
    description: "Perform automated application patch management on enterprise assets",
    implementationGroup: "IG1",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "perform automated application patching",
      "enterprise assets coverage",
      "automated application updates",
      "application patch governance"
    ],
    coreRequirements: [ // Green - The "what"
      "automated application patching",
      "enterprise asset coverage",
      "application security updates",
      "patch deployment automation"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "application update management",
      "third-party software updates",
      "browser plugin updates",
      "security patch prioritization",
      "application compatibility testing",
      "update rollback procedures",
      "vendor patch notifications"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "application update managers",
      "third-party patch solutions",
      "automated deployment tools",
      "software inventory integration",
      "patch compliance scanners"
    ],
    relatedSafeguards: ["2.1", "2.2", "7.1", "7.2", "7.3", "7.5"],
    systemPrompt: {
      role: "automated_application_patch_management_expert",
      context: "You are evaluating automated application patch management solutions against CIS Control 7.4 requirements for automated application patching.",
      objective: "Determine if a vendor solution provides comprehensive automated application patch management for enterprise assets.",
      guidelines: [
        "Verify automated application patch deployment capabilities",
        "Confirm enterprise application coverage and compatibility",
        "Validate third-party application update management",
        "Assess browser plugin and security update automation",
        "Review compatibility testing and rollback procedures",
        "Check vendor patch notification and prioritization systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.5": {
    id: "7.5",
    title: "Perform Automated Vulnerability Scans of Internal Enterprise Assets",
    description: "Perform automated vulnerability scans of internal enterprise assets on a quarterly or more frequent basis",
    implementationGroup: "IG2",
    assetType: ["devices", "applications"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "perform automated vulnerability scans",
      "internal enterprise assets",
      "quarterly or more frequent basis",
      "vulnerability scanning governance"
    ],
    coreRequirements: [ // Green - The "what"
      "automated vulnerability scanning",
      "internal asset coverage",
      "quarterly scan frequency",
      "vulnerability detection"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "network vulnerability scanning",
      "host-based vulnerability scanning",
      "application vulnerability scanning",
      "database vulnerability scanning",
      "scan scheduling",
      "scan result analysis",
      "false positive management"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "vulnerability scanners",
      "network security scanners",
      "application security scanners",
      "automated scanning platforms",
      "vulnerability management systems"
    ],
    relatedSafeguards: ["1.1", "2.1", "7.1", "7.2", "7.3", "7.4", "7.6", "7.7"],
    systemPrompt: {
      role: "internal_vulnerability_scanning_expert",
      context: "You are evaluating internal vulnerability scanning solutions against CIS Control 7.5 requirements for automated vulnerability scanning of internal enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive automated vulnerability scanning capabilities for internal enterprise assets.",
      guidelines: [
        "Verify automated vulnerability scanning capabilities for internal assets",
        "Confirm quarterly or more frequent scanning schedules",
        "Validate coverage of devices and applications",
        "Assess scan result analysis and false positive management",
        "Review vulnerability prioritization and reporting features",
        "Check integration with vulnerability management platforms"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.6": {
    id: "7.6",
    title: "Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets",
    description: "Perform automated vulnerability scans of externally-exposed enterprise assets using either an internal or external vulnerability scanning service",
    implementationGroup: "IG2",
    assetType: ["devices", "applications"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "perform automated vulnerability scans",
      "externally-exposed enterprise assets",
      "internal or external scanning service",
      "external asset scanning governance"
    ],
    coreRequirements: [ // Green - The "what"
      "automated vulnerability scanning",
      "externally-exposed assets",
      "external vulnerability detection",
      "internet-facing asset scanning"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "external network scanning",
      "web application scanning",
      "exposed service scanning",
      "cloud asset scanning",
      "external IP monitoring",
      "internet exposure assessment",
      "attack surface analysis"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "external vulnerability scanners",
      "cloud security scanning",
      "web application scanners",
      "internet asset discovery",
      "third-party scanning services"
    ],
    relatedSafeguards: ["1.1", "2.1", "7.1", "7.2", "7.5", "7.7"],
    systemPrompt: {
      role: "external_vulnerability_scanning_expert",
      context: "You are evaluating external vulnerability scanning solutions against CIS Control 7.6 requirements for automated vulnerability scanning of externally-exposed enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive automated vulnerability scanning capabilities for externally-exposed enterprise assets.",
      guidelines: [
        "Verify automated vulnerability scanning for externally-exposed assets",
        "Confirm internal or external scanning service capabilities",
        "Validate internet-facing asset discovery and inventory",
        "Assess web application and cloud security scanning",
        "Review external scan scheduling and result management",
        "Check integration with threat intelligence and attack surface monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "7.7": {
    id: "7.7",
    title: "Remediate Detected Vulnerabilities",
    description: "Remediate detected vulnerabilities in software through processes and tooling on a monthly, or more frequent, basis",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "remediate detected vulnerabilities",
      "software vulnerability remediation",
      "monthly or more frequent basis",
      "vulnerability remediation governance"
    ],
    coreRequirements: [ // Green - The "what"
      "vulnerability remediation",
      "detected vulnerability handling",
      "monthly remediation cycles",
      "software security updates"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "vulnerability assessment",
      "risk-based prioritization",
      "patch deployment",
      "compensating controls",
      "remediation verification",
      "remediation tracking",
      "exception management"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "vulnerability management platforms",
      "automated remediation tools",
      "patch management integration",
      "remediation workflow systems",
      "risk assessment tools"
    ],
    relatedSafeguards: ["7.1", "7.2", "7.3", "7.4", "7.5", "7.6"],
    systemPrompt: {
      role: "vulnerability_remediation_specialist",
      context: "You are evaluating vulnerability remediation solutions against CIS Control 7.7 requirements for monthly remediation of detected vulnerabilities.",
      objective: "Determine if a vendor solution provides comprehensive vulnerability remediation capabilities with monthly or more frequent cycles.",
      guidelines: [
        "Verify vulnerability remediation processes and automation",
        "Confirm monthly or more frequent remediation cycles",
        "Validate software vulnerability handling and patching",
        "Assess remediation workflow and tracking systems",
        "Review patch management integration and coordination",
        "Check remediation verification and compliance reporting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.1": {
    id: "8.1",
    title: "Establish and Maintain an Audit Log Management Process",
    description: "Establish and maintain a documented audit log management process that defines the enterprise's logging requirements. At a minimum, address the collection, review, and retention of audit logs for enterprise assets. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard.",
    implementationGroup: "IG1",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Govern"],
    governanceElements: [
      "establish and maintain",
      "documented audit log management process", 
      "review and update documentation annually",
      "when significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [
      "enterprise's logging requirements",
      "collection, review, and retention of audit logs",
      "enterprise assets"
    ],
    subTaxonomicalElements: [
      "collection",
      "review", 
      "retention",
      "annually",
      "minimum"
    ],
    implementationSuggestions: [
      "log management policy/process",
      "documentation"
    ],
    relatedSafeguards: ["8.2", "8.3", "8.5", "8.6", "8.7", "8.8", "8.9", "8.10", "8.11", "8.12"],
    systemPrompt: {
      role: "audit_log_management_process_expert",
      context: "You are evaluating audit log management solutions against CIS Control 8.1 requirements for establishing documented audit log management processes.",
      objective: "Determine if a vendor solution provides comprehensive audit log management process establishment and maintenance capabilities.",
      guidelines: [
        "Verify documented audit log management process creation",
        "Confirm enterprise logging requirements definition",
        "Validate audit log collection, review, and retention capabilities",
        "Assess process documentation and annual review procedures",
        "Review enterprise asset coverage and logging scope",
        "Check compliance with enterprise change management integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.2": {
    id: "8.2", 
    title: "Collect Audit Logs",
    description: "Collect audit logs. Ensure that logging, per the enterprise's audit log management process, has been enabled across enterprise assets.",
    implementationGroup: "IG1",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Detect"],
    governanceElements: [
      "per the enterprise's audit log management process"
    ],
    coreRequirements: [
      "collect audit logs",
      "logging enabled", 
      "enterprise assets"
    ],
    subTaxonomicalElements: [
      "enabled"
    ],
    implementationSuggestions: [
      "log management tool",
      "OS dependent"
    ],
    relatedSafeguards: ["8.1"],
    systemPrompt: {
      role: "audit_log_collection_expert",
      context: "You are evaluating audit log collection solutions against CIS Control 8.2 requirements for comprehensive audit log collection across enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive audit log collection capabilities for enterprise assets.",
      guidelines: [
        "Verify audit log collection across all enterprise assets",
        "Confirm logging enablement per enterprise audit log management process",
        "Validate comprehensive log source coverage and integration",
        "Assess log collection tools and mechanisms",
        "Review OS-dependent and platform-specific logging capabilities",
        "Check log management tool integration and compatibility"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.3": {
    id: "8.3",
    title: "Ensure Adequate Audit Log Storage", 
    description: "Ensure that logging destinations maintain adequate storage to comply with the enterprise's audit log management process.",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [
      "comply with the enterprise's audit log management process"
    ],
    coreRequirements: [
      "logging destinations maintain adequate storage"
    ],
    subTaxonomicalElements: [
      "adequate storage",
      "maintain",
      "comply",
      "logging destinations"
    ],
    implementationSuggestions: [
      "log management tool", 
      "potentially OS dependent"
    ],
    relatedSafeguards: ["8.1", "8.9", "8.10"],
    systemPrompt: {
      role: "audit_log_storage_expert",
      context: "You are evaluating audit log storage solutions against CIS Control 8.3 requirements for ensuring adequate audit log storage capacity.",
      objective: "Determine if a vendor solution provides adequate audit log storage to comply with enterprise audit log management processes.",
      guidelines: [
        "Verify adequate storage capacity for audit log retention",
        "Confirm logging destination storage management",
        "Validate compliance with enterprise audit log management processes",
        "Assess storage scalability and expansion capabilities",
        "Review storage performance and reliability features",
        "Check storage monitoring and capacity alerting systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.4": {
    id: "8.4",
    title: "Standardize Time Synchronization",
    description: "Standardize time synchronization. Configure at least two synchronized time sources across enterprise assets, where supported.",
    implementationGroup: "IG2", 
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Protect"],
    governanceElements: [
      "standardize time synchronization"
    ],
    coreRequirements: [
      "configure at least two synchronized time sources",
      "enterprise assets", 
      "where supported"
    ],
    subTaxonomicalElements: [
      "at least two",
      "synchronized",
      "time sources",
      "where supported"
    ],
    implementationSuggestions: [
      "secure configuration policy/process",
      "potentially OS dependent"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "time_synchronization_expert",
      context: "You are evaluating time synchronization solutions against CIS Control 8.4 requirements for standardized time synchronization across enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive time synchronization capabilities for enterprise assets.",
      guidelines: [
        "Verify time synchronization standardization across enterprise assets",
        "Confirm configuration of at least two synchronized time sources",
        "Validate enterprise asset coverage where supported",
        "Assess secure configuration policy and process integration",
        "Review OS-dependent time synchronization capabilities",
        "Check time source reliability and redundancy features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.5": {
    id: "8.5",
    title: "Collect Detailed Audit Logs",
    description: "Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation.",
    implementationGroup: "IG2",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Detect"], 
    governanceElements: [
      "configure detailed audit logging"
    ],
    coreRequirements: [
      "enterprise assets containing sensitive data",
      "forensic investigation"
    ],
    subTaxonomicalElements: [
      "event source",
      "date", 
      "username",
      "timestamp",
      "source addresses",
      "destination addresses", 
      "other useful elements"
    ],
    implementationSuggestions: [
      "log management tool",
      "log management policy/process",
      "potentially OS dependent"
    ],
    relatedSafeguards: ["8.1", "1.1", "3.2"],
    systemPrompt: {
      role: "detailed_audit_logging_expert",
      context: "You are evaluating detailed audit logging solutions against CIS Control 8.5 requirements for comprehensive audit logging of enterprise assets containing sensitive data.",
      objective: "Determine if a vendor solution provides detailed audit logging capabilities for forensic investigation support.",
      guidelines: [
        "Verify detailed audit logging configuration for sensitive data assets",
        "Confirm inclusion of event source, date, username, timestamp details",
        "Validate source and destination address logging capabilities",
        "Assess forensic investigation support and log detail completeness",
        "Review log management tool integration and policy compliance",
        "Check OS-dependent logging capabilities and platform coverage"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.6": {
    id: "8.6",
    title: "Collect DNS Query Audit Logs", 
    description: "Collect DNS query audit logs on enterprise assets, where appropriate and supported.",
    implementationGroup: "IG2",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Detect"],
    governanceElements: [
      "where appropriate and supported"
    ],
    coreRequirements: [
      "collect DNS query audit logs",
      "enterprise assets"
    ],
    subTaxonomicalElements: [
      "DNS query logs",
      "where appropriate",
      "where supported"
    ],
    implementationSuggestions: [
      "log management tool",
      "secure configuration policy/process", 
      "potentially OS dependent"
    ],
    relatedSafeguards: ["8.1", "4.9"],
    systemPrompt: {
      role: "dns_audit_logging_expert",
      context: "You are evaluating DNS audit logging solutions against CIS Control 8.6 requirements for DNS query audit log collection.",
      objective: "Determine if a vendor solution provides comprehensive DNS query audit logging capabilities for enterprise assets.",
      guidelines: [
        "Verify DNS query audit log collection capabilities",
        "Confirm enterprise asset coverage where appropriate and supported",
        "Validate log management tool integration for DNS logging",
        "Assess secure configuration policy and process compliance",
        "Review OS-dependent DNS logging capabilities",
        "Check DNS query logging completeness and accuracy"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.7": {
    id: "8.7",
    title: "Collect URL Request Audit Logs",
    description: "Collect URL request audit logs on enterprise assets, where appropriate and supported.",
    implementationGroup: "IG2",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Detect"],
    governanceElements: [
      "where appropriate and supported"
    ],
    coreRequirements: [
      "collect URL request audit logs", 
      "enterprise assets"
    ],
    subTaxonomicalElements: [
      "URL request audit logs",
      "where appropriate", 
      "where supported"
    ],
    implementationSuggestions: [
      "log management tool",
      "secure configuration policy/process",
      "potentially OS dependent"
    ],
    relatedSafeguards: ["8.1"],
    systemPrompt: {
      role: "url_request_audit_logging_expert",
      context: "You are evaluating URL request audit logging solutions against CIS Control 8.7 requirements for URL request audit log collection.",
      objective: "Determine if a vendor solution provides comprehensive URL request audit logging capabilities for enterprise assets.",
      guidelines: [
        "Verify URL request audit log collection capabilities",
        "Confirm enterprise asset coverage where appropriate and supported",
        "Validate web traffic logging and URL request capture",
        "Assess log management tool integration for web logs",
        "Review secure configuration policy and process compliance",
        "Check OS-dependent URL logging capabilities and browser coverage"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.8": {
    id: "8.8",
    title: "Collect Command-Line Audit Logs",
    description: "Collect command-line audit logs. Example implementations include collecting audit logs from PowerShell®, BASH™, and remote administrative terminals.",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Detect"],
    governanceElements: [
      "collect command-line audit logs"
    ],
    coreRequirements: [
      "command-line audit logs"
    ],
    subTaxonomicalElements: [
      "PowerShell",
      "BASH", 
      "remote administrative terminals"
    ],
    implementationSuggestions: [
      "log management tool",
      "secure configuration policy/process",
      "OS dependent"
    ],
    relatedSafeguards: ["8.1"],
    systemPrompt: {
      role: "command_line_audit_logging_expert",
      context: "You are evaluating command-line audit logging solutions against CIS Control 8.8 requirements for command-line audit log collection.",
      objective: "Determine if a vendor solution provides comprehensive command-line audit logging capabilities including PowerShell, BASH, and remote terminals.",
      guidelines: [
        "Verify command-line audit log collection capabilities",
        "Confirm PowerShell, BASH, and remote terminal logging coverage",
        "Validate administrative terminal session logging",
        "Assess log management tool integration for command logs",
        "Review secure configuration policy and OS-dependent capabilities",
        "Check command execution tracking and security monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.9": {
    id: "8.9",
    title: "Centralize Audit Logs",
    description: "Centralize, to the extent possible, audit log collection and retention across enterprise assets in accordance with the documented audit log management process. Example implementations include leveraging a SIEM tool to centralize multiple log sources.",
    implementationGroup: "IG2",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Detect"], 
    governanceElements: [
      "in accordance with documented audit log management process",
      "to the extent possible"
    ],
    coreRequirements: [
      "centralize audit log collection and retention",
      "enterprise assets"
    ],
    subTaxonomicalElements: [
      "audit log collection",
      "audit log retention",
      "to the extent possible"
    ],
    implementationSuggestions: [
      "SIEM tool",
      "log analytics and centralization tool", 
      "OS dependent"
    ],
    relatedSafeguards: ["8.1", "8.3", "12.5", "13.1"],
    systemPrompt: {
      role: "centralized_audit_logging_expert",
      context: "You are evaluating centralized audit logging solutions against CIS Control 8.9 requirements for centralized audit log collection and retention.",
      objective: "Determine if a vendor solution provides comprehensive centralized audit log collection and retention capabilities for enterprise assets.",
      guidelines: [
        "Verify centralized audit log collection capabilities across enterprise assets",
        "Confirm compliance with documented audit log management processes",
        "Validate SIEM tool integration and multiple log source support",
        "Assess log analytics and centralization tool capabilities",
        "Review scalability and enterprise-wide log aggregation",
        "Check OS-dependent log collection and centralization features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.10": {
    id: "8.10",
    title: "Retain Audit Logs", 
    description: "Retain audit logs across enterprise assets for a minimum of 90 days.",
    implementationGroup: "IG2",
    assetType: ["enterprise assets", "data"],
    securityFunction: ["Protect"],
    governanceElements: [
      "minimum of 90 days"
    ],
    coreRequirements: [
      "retain audit logs",
      "enterprise assets"
    ],
    subTaxonomicalElements: [
      "minimum of 90 days"
    ],
    implementationSuggestions: [
      "log analytics and centralization tool"
    ],
    relatedSafeguards: ["8.1", "8.3"],
    systemPrompt: {
      role: "audit_log_retention_expert",
      context: "You are evaluating audit log retention solutions against CIS Control 8.10 requirements for 90-day minimum audit log retention.",
      objective: "Determine if a vendor solution provides adequate audit log retention capabilities for enterprise assets with minimum 90-day retention.",
      guidelines: [
        "Verify audit log retention capabilities for minimum 90 days",
        "Confirm enterprise asset coverage for retention policies",
        "Validate log analytics and centralization tool retention features",
        "Assess automated retention management and policy enforcement",
        "Review storage optimization and archival capabilities",
        "Check compliance monitoring and retention reporting features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.11": {
    id: "8.11",
    title: "Conduct Audit Log Reviews",
    description: "Conduct reviews of audit logs to detect anomalies or abnormal events that could indicate a potential threat. Conduct reviews on a weekly, or more frequent, basis.",
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Detect"],
    governanceElements: [
      "conduct reviews on a weekly, or more frequent, basis"
    ],
    coreRequirements: [
      "detect anomalies or abnormal events",
      "potential threat"
    ],
    subTaxonomicalElements: [
      "weekly", 
      "more frequent",
      "anomalies",
      "abnormal events"
    ],
    implementationSuggestions: [
      "log analytics and centralization tool"
    ],
    relatedSafeguards: ["8.1", "8.12"],
    systemPrompt: {
      role: "audit_log_review_expert",
      context: "You are evaluating audit log review solutions against CIS Control 8.11 requirements for weekly audit log reviews to detect anomalies and threats.",
      objective: "Determine if a vendor solution provides comprehensive audit log review capabilities for anomaly and threat detection.",
      guidelines: [
        "Verify audit log review capabilities for anomaly detection",
        "Confirm weekly or more frequent review scheduling",
        "Validate abnormal event detection and potential threat identification",
        "Assess log analytics and automated review capabilities",
        "Review threat detection algorithms and alert mechanisms",
        "Check review workflow integration and analyst productivity tools"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "8.12": {
    id: "8.12",
    title: "Collect Service Provider Logs",
    description: "Collect service provider logs, where supported. Example implementations include collecting authentication and authorization events, data creation and disposal events, and user management events.",
    implementationGroup: "IG3",
    assetType: ["data"], 
    securityFunction: ["Detect"],
    governanceElements: [
      "where supported"
    ],
    coreRequirements: [
      "collect service provider logs"
    ],
    subTaxonomicalElements: [
      "authentication events",
      "authorization events",
      "data creation events", 
      "disposal events",
      "user management events"
    ],
    implementationSuggestions: [
      "log analytics and centralization tool",
      "secure configuration policy/process"
    ],
    relatedSafeguards: ["8.1", "8.11", "15.1"],
    systemPrompt: {
      role: "service_provider_log_collection_expert",
      context: "You are evaluating service provider log collection solutions against CIS Control 8.12 requirements for collecting service provider logs where supported.",
      objective: "Determine if a vendor solution provides comprehensive service provider log collection capabilities including authentication, authorization, and data events.",
      guidelines: [
        "Verify service provider log collection capabilities where supported",
        "Confirm authentication and authorization event logging",
        "Validate data creation, disposal, and user management event capture",
        "Assess log analytics and centralization tool integration",
        "Review secure configuration policy and process compliance",
        "Check third-party service provider log aggregation and API integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.1": {
    id: "10.1",
    title: "Deploy and Maintain Anti-Malware Software",
    description: "Deploy and maintain anti-malware software on all enterprise assets",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "deploy anti-malware software",
      "maintain anti-malware software",
      "all enterprise assets coverage",
      "anti-malware software management"
    ],
    coreRequirements: [ // Green - The "what"
      "anti-malware software deployment",
      "anti-malware software maintenance",
      "enterprise assets protection",
      "malware detection capabilities"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy",
      "maintain", 
      "anti-malware software",
      "all enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "endpoint protection platforms",
      "anti-virus solutions",
      "endpoint detection and response",
      "malware protection tools",
      "security software management"
    ],
    relatedSafeguards: ["4.1", "10.2", "10.4", "10.6", "10.7", "13.5"],
    systemPrompt: {
      role: "endpoint_security_anti_malware_expert",
      context: "You are evaluating anti-malware solutions against CIS Control 10.1 requirements for deploying and maintaining anti-malware software on all enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive anti-malware software deployment and maintenance capabilities across all enterprise assets.",
      guidelines: [
        "Verify anti-malware software deployment capabilities and coverage",
        "Confirm maintenance and update management for anti-malware software",
        "Validate comprehensive enterprise asset protection and coverage",
        "Assess malware detection capabilities and effectiveness",
        "Review endpoint protection platform integration and management",
        "Check security software management and centralized administration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.2": {
    id: "10.2",
    title: "Configure Automatic Anti-Malware Signature Updates",
    description: "Configure automatic updates for anti-malware signature files on all enterprise assets",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "configure automatic updates",
      "anti-malware signature files",
      "all enterprise assets coverage",
      "signature update management"
    ],
    coreRequirements: [ // Green - The "what"
      "automatic updates configuration",
      "anti-malware signature files",
      "enterprise assets coverage",
      "signature currency maintenance"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "configure",
      "automatic updates",
      "anti-malware signature files",
      "all enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "automatic update systems",
      "signature distribution mechanisms",
      "centralized update management",
      "update scheduling tools"
    ],
    relatedSafeguards: ["10.1"],
    systemPrompt: {
      role: "anti_malware_signature_management_expert",
      context: "You are evaluating anti-malware signature update solutions against CIS Control 10.2 requirements for configuring automatic updates for anti-malware signature files on all enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive automatic anti-malware signature update capabilities across all enterprise assets.",
      guidelines: [
        "Verify automatic update configuration capabilities and reliability",
        "Confirm anti-malware signature file management and distribution",
        "Validate comprehensive enterprise asset coverage for updates",
        "Assess signature currency maintenance and update frequency",
        "Review centralized update management and scheduling systems",
        "Check signature distribution mechanisms and update verification"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.3": {
    id: "10.3", 
    title: "Disable Autorun and Autoplay for Removable Media",
    description: "Disable autorun and autoplay auto-execute functionality for removable media",
    implementationGroup: "IG1",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "disable autorun functionality",
      "disable autoplay functionality", 
      "auto-execute prevention",
      "removable media security"
    ],
    coreRequirements: [ // Green - The "what"
      "autorun disabling",
      "autoplay disabling", 
      "auto-execute prevention",
      "removable media protection"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "disable",
      "autorun",
      "autoplay",
      "auto-execute functionality",
      "removable media"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "group policy settings",
      "registry modifications",
      "configuration management tools",
      "secure configuration policy/process"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "removable_media_security_expert",
      context: "You are evaluating removable media security solutions against CIS Control 10.3 requirements for disabling autorun and autoplay auto-execute functionality for removable media.",
      objective: "Determine if a vendor solution provides comprehensive autorun and autoplay disabling capabilities to prevent auto-execute functionality on removable media.",
      guidelines: [
        "Verify autorun functionality disabling capabilities and enforcement",
        "Confirm autoplay functionality disabling and auto-execute prevention",
        "Validate comprehensive removable media security controls",
        "Assess configuration management and policy enforcement tools",
        "Review group policy settings and registry modification capabilities",
        "Check secure configuration policy implementation and process management"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.4": {
    id: "10.4",
    title: "Configure Automatic Anti-Malware Scanning of Removable Media", 
    description: "Configure anti-malware software to automatically scan removable media",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "configure anti-malware software",
      "automatic scanning configuration",
      "removable media scanning",
      "scanning policy management"
    ],
    coreRequirements: [ // Green - The "what"
      "anti-malware software configuration",
      "automatic scanning",
      "removable media protection",
      "malware detection on media"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "configure",
      "anti-malware software",
      "automatically scan",
      "removable media"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "anti-malware software configuration policy/process",
      "endpoint scanning policies",
      "media scanning tools",
      "automated threat detection"
    ],
    relatedSafeguards: ["10.1"],
    systemPrompt: {
      role: "anti_malware_scanning_configuration_expert",
      context: "You are evaluating anti-malware scanning solutions against CIS Control 10.4 requirements for configuring anti-malware software to automatically scan removable media.",
      objective: "Determine if a vendor solution provides comprehensive anti-malware configuration capabilities for automatic removable media scanning.",
      guidelines: [
        "Verify anti-malware software configuration capabilities for removable media",
        "Confirm automatic scanning configuration and policy enforcement",
        "Validate comprehensive removable media protection and malware detection",
        "Assess scanning policy management and automated threat detection",
        "Review endpoint scanning policies and media scanning tools integration",
        "Check anti-malware software configuration policy and process effectiveness"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.5": {
    id: "10.5",
    title: "Enable Anti-Exploitation Features",
    description: "Enable anti-exploitation features on enterprise assets and software, where possible, such as Microsoft® Data Execution Prevention (DEP), Windows® Defender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and Gatekeeper™",
    implementationGroup: "IG2", 
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "enable anti-exploitation features",
      "enterprise assets coverage", 
      "software protection",
      "where possible implementation"
    ],
    coreRequirements: [ // Green - The "what"
      "anti-exploitation features",
      "enterprise assets protection",
      "software security",
      "exploit prevention"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "enable",
      "anti-exploitation features",
      "enterprise assets",
      "software", 
      "where possible"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "Microsoft® Data Execution Prevention (DEP)",
      "Windows® Defender Exploit Guard (WDEG)", 
      "Apple® System Integrity Protection (SIP)",
      "Gatekeeper™",
      "configuration management tool"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "anti_exploitation_security_expert",
      context: "You are evaluating anti-exploitation solutions against CIS Control 10.5 requirements for enabling anti-exploitation features on enterprise assets and software, including DEP, WDEG, SIP, and Gatekeeper.",
      objective: "Determine if a vendor solution provides comprehensive anti-exploitation feature enablement capabilities across enterprise assets and software platforms.",
      guidelines: [
        "Verify anti-exploitation feature enablement capabilities and coverage",
        "Confirm enterprise asset and software protection implementation",
        "Validate exploit prevention mechanisms and effectiveness",
        "Assess platform-specific anti-exploitation features (DEP, WDEG, SIP, Gatekeeper)",
        "Review configuration management tools and security policy enforcement",
        "Check compatibility and implementation feasibility across different platforms"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.6": {
    id: "10.6",
    title: "Centrally Manage Anti-Malware Software", 
    description: "Centrally manage anti-malware software",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "centrally manage anti-malware",
      "centralized management process",
      "anti-malware software governance", 
      "management infrastructure"
    ],
    coreRequirements: [ // Green - The "what"
      "centralized management",
      "anti-malware software",
      "management capabilities",
      "centralized control"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "centrally manage",
      "anti-malware software"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "anti-malware software configuration policy/process",
      "centralized management platforms",
      "security management consoles",
      "enterprise security tools"
    ],
    relatedSafeguards: ["10.1"],
    systemPrompt: {
      role: "centralized_anti_malware_management_expert",
      context: "You are evaluating centralized anti-malware management solutions against CIS Control 10.6 requirements for centrally managing anti-malware software across the enterprise.",
      objective: "Determine if a vendor solution provides comprehensive centralized anti-malware software management capabilities with centralized control and governance.",
      guidelines: [
        "Verify centralized anti-malware management capabilities and infrastructure",
        "Confirm centralized management process implementation and effectiveness",
        "Validate anti-malware software governance and policy enforcement",
        "Assess management infrastructure scalability and reliability",
        "Review centralized management platforms and security management consoles",
        "Check enterprise security tools integration and centralized control features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "10.7": {
    id: "10.7",
    title: "Use Behavior-Based Anti-Malware Software",
    description: "Use behavior-based anti-malware software", 
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "use behavior-based anti-malware",
      "behavioral analysis implementation",
      "advanced threat detection",
      "behavior-based protection"
    ],
    coreRequirements: [ // Green - The "what"
      "behavior-based anti-malware software",
      "behavioral analysis",
      "advanced malware detection",
      "dynamic threat identification"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "use",
      "behavior-based",
      "anti-malware software"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "anti-malware software configuration policy/process", 
      "behavioral analysis tools",
      "advanced endpoint detection",
      "machine learning security"
    ],
    relatedSafeguards: ["10.1"],
    systemPrompt: {
      role: "behavioral_anti_malware_analysis_expert",
      context: "You are evaluating behavior-based anti-malware solutions against CIS Control 10.7 requirements for using behavior-based anti-malware software with advanced threat detection capabilities.",
      objective: "Determine if a vendor solution provides comprehensive behavior-based anti-malware software capabilities with behavioral analysis and dynamic threat identification.",
      guidelines: [
        "Verify behavior-based anti-malware software implementation and effectiveness",
        "Confirm behavioral analysis capabilities and advanced threat detection",
        "Validate dynamic threat identification and behavior-based protection",
        "Assess advanced malware detection accuracy and false positive management",
        "Review behavioral analysis tools and machine learning security integration",
        "Check advanced endpoint detection capabilities and threat response mechanisms"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "11.1": {
    id: "11.1",
    title: "Establish and Maintain a Data Recovery Process",
    description: "Establish and maintain a documented data recovery process. In the process, address the scope of data recovery activities, recovery prioritization, and the security of backup data. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish documented data recovery process",
      "maintain documented data recovery process",
      "review and update documentation annually",
      "when significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "documented data recovery process",
      "scope of data recovery activities",
      "recovery prioritization", 
      "security of backup data"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish",
      "maintain",
      "documented data recovery process",
      "scope of data recovery activities",
      "recovery prioritization",
      "security of backup data",
      "review and update documentation",
      "annually",
      "when significant enterprise changes occur"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "data recovery policy/process",
      "business continuity documentation",
      "recovery procedures manual",
      "backup and recovery strategy"
    ],
    relatedSafeguards: ["3.2", "3.4", "3.5", "3.8", "11.2", "11.3", "11.4", "11.5"],
    systemPrompt: {
      role: "data_recovery_governance_expert",
      context: "You are evaluating data recovery governance solutions against CIS Control 11.1 requirements for establishing and maintaining a documented data recovery process with scope, prioritization, and backup security considerations.",
      objective: "Determine if a vendor solution provides comprehensive data recovery process documentation, governance, and management capabilities including annual reviews and change management.",
      guidelines: [
        "Verify documented data recovery process establishment and maintenance",
        "Confirm scope of data recovery activities and recovery prioritization",
        "Validate security of backup data and protection mechanisms",
        "Assess annual documentation review and update processes",
        "Review business continuity documentation and recovery procedures",
        "Check change management for significant enterprise changes impacting recovery"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "11.2": {
    id: "11.2", 
    title: "Perform Automated Backups",
    description: "Perform automated backups of in-scope enterprise assets. Run backups weekly, or more frequently, based on the sensitivity of the data",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Recover"],
    governanceElements: [ // Orange - MUST be met
      "perform automated backups",
      "in-scope enterprise assets",
      "run backups weekly or more frequently",
      "based on sensitivity of data"
    ],
    coreRequirements: [ // Green - The "what"
      "automated backups",
      "in-scope enterprise assets",
      "backup frequency requirements",
      "data sensitivity considerations"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "perform",
      "automated backups",
      "in-scope enterprise assets",
      "run backups",
      "weekly",
      "more frequently", 
      "based on sensitivity of the data"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "data backup and recovery tool",
      "automated backup systems",
      "backup scheduling software",
      "enterprise backup solutions"
    ],
    relatedSafeguards: ["1.1", "2.1", "11.1"],
    systemPrompt: {
      role: "automated_backup_systems_expert",
      context: "You are evaluating automated backup solutions against CIS Control 11.2 requirements for performing automated backups of in-scope enterprise assets with weekly or more frequent schedules based on data sensitivity.",
      objective: "Determine if a vendor solution provides comprehensive automated backup capabilities with appropriate frequency scheduling and enterprise asset coverage.",
      guidelines: [
        "Verify automated backup performance and enterprise asset coverage",
        "Confirm backup frequency requirements (weekly or more frequent)",
        "Validate data sensitivity-based backup scheduling and prioritization",
        "Assess in-scope enterprise asset identification and backup coverage",
        "Review backup scheduling software and automated backup system reliability",
        "Check enterprise backup solution scalability and management features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "11.3": {
    id: "11.3",
    title: "Protect Recovery Data", 
    description: "Protect recovery data with equivalent controls to the original data. Reference encryption or data separation, based on requirements",
    implementationGroup: "IG1",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "protect recovery data",
      "equivalent controls to original data",
      "reference encryption or data separation", 
      "based on requirements"
    ],
    coreRequirements: [ // Green - The "what"
      "recovery data protection",
      "equivalent controls",
      "original data protection parity",
      "requirements-based implementation"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "protect",
      "recovery data", 
      "equivalent controls to the original data",
      "reference encryption",
      "data separation",
      "based on requirements"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "data backup and recovery tool",
      "backup encryption systems",
      "secure backup storage",
      "data separation technologies"
    ],
    relatedSafeguards: ["3.3", "3.10", "3.11", "11.1"],
    systemPrompt: {
      role: "backup_data_protection_expert",
      context: "You are evaluating backup data protection solutions against CIS Control 11.3 requirements for protecting recovery data with equivalent controls to the original data, including encryption or data separation based on requirements.",
      objective: "Determine if a vendor solution provides comprehensive recovery data protection capabilities with equivalent controls, encryption, and data separation mechanisms.",
      guidelines: [
        "Verify recovery data protection implementation and equivalent controls",
        "Confirm original data protection parity and control equivalence",
        "Validate encryption capabilities for backup data protection",
        "Assess data separation technologies and implementation options",
        "Review backup encryption systems and secure backup storage solutions",
        "Check requirements-based implementation flexibility and compliance"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "11.4": {
    id: "11.4",
    title: "Establish and Maintain an Isolated Instance of Recovery Data",
    description: "Establish and maintain an isolated instance of recovery data. Example implementations include version controlling backup destinations through offline, cloud, or off-site systems or services",
    implementationGroup: "IG1", 
    assetType: ["data"],
    securityFunction: ["Recover"],
    governanceElements: [ // Orange - MUST be met
      "establish isolated instance of recovery data",
      "maintain isolated instance of recovery data",
      "version controlling backup destinations",
      "example implementations include offline, cloud, or off-site systems or services"
    ],
    coreRequirements: [ // Green - The "what"
      "isolated instance of recovery data",
      "backup destination control",
      "recovery data isolation",
      "implementation flexibility"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish",
      "maintain",
      "isolated instance of recovery data",
      "version controlling backup destinations",
      "offline", 
      "cloud",
      "off-site systems",
      "services"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "data backup and recovery tool",
      "offline backup systems",
      "cloud backup services", 
      "off-site storage solutions",
      "version controlling backup destinations"
    ],
    relatedSafeguards: ["11.1"],
    systemPrompt: {
      role: "isolated_backup_recovery_expert",
      context: "You are evaluating isolated backup recovery solutions against CIS Control 11.4 requirements for establishing and maintaining an isolated instance of recovery data with version controlling backup destinations through offline, cloud, or off-site systems.",
      objective: "Determine if a vendor solution provides comprehensive isolated recovery data capabilities with backup destination control and implementation flexibility.",
      guidelines: [
        "Verify isolated instance of recovery data establishment and maintenance",
        "Confirm version controlling backup destinations and destination management",
        "Validate offline, cloud, and off-site implementation options",
        "Assess recovery data isolation effectiveness and security",
        "Review backup destination control mechanisms and flexibility",
        "Check off-site storage solutions and cloud backup service integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "11.5": {
    id: "11.5",
    title: "Test Data Recovery",
    description: "Test backup recovery quarterly, or more frequently, for a sampling of in-scope enterprise assets", 
    implementationGroup: "IG2",
    assetType: ["data"],
    securityFunction: ["Recover"],
    governanceElements: [ // Orange - MUST be met
      "test backup recovery quarterly or more frequently",
      "sampling of in-scope enterprise assets",
      "recovery testing requirements",
      "testing frequency management"
    ],
    coreRequirements: [ // Green - The "what"
      "backup recovery testing", 
      "quarterly testing frequency",
      "in-scope enterprise assets sampling",
      "recovery validation"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "test backup recovery",
      "quarterly",
      "more frequently",
      "sampling",
      "in-scope enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "data recovery policy/process",
      "data backup and recovery tool",
      "recovery testing procedures",
      "backup validation systems"
    ],
    relatedSafeguards: ["11.1"],
    systemPrompt: {
      role: "backup_recovery_testing_expert",
      context: "You are evaluating backup recovery testing solutions against CIS Control 11.5 requirements for testing backup recovery quarterly or more frequently for a sampling of in-scope enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive backup recovery testing capabilities with appropriate frequency and enterprise asset sampling.",
      guidelines: [
        "Verify backup recovery testing implementation and quarterly frequency",
        "Confirm in-scope enterprise asset sampling and selection methods",
        "Validate recovery validation processes and testing effectiveness",
        "Assess testing frequency management and scheduling capabilities",
        "Review recovery testing procedures and backup validation systems",
        "Check data recovery testing automation and reporting features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.1": {
    id: "12.1",
    title: "Ensure Network Infrastructure is Up-to-Date",
    description: "Ensure network infrastructure is kept up-to-date. Example implementations include running the latest stable release of software and/or using currently supported network-as-a-service (NaaS) offerings. Review software versions monthly, or more frequently, to verify software support",
    implementationGroup: "IG1",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "ensure network infrastructure is kept up-to-date",
      "review software versions monthly or more frequently",
      "verify software support",
      "network infrastructure maintenance"
    ],
    coreRequirements: [ // Green - The "what"
      "network infrastructure up-to-date",
      "latest stable release of software",
      "currently supported network-as-a-service offerings",
      "software version review"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "ensure",
      "network infrastructure is kept up-to-date",
      "running the latest stable release of software",
      "using currently supported network-as-a-service (NaaS) offerings",
      "review software versions",
      "monthly",
      "more frequently",
      "verify software support"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "enterprise and software asset management tool",
      "network management systems",
      "automated patching tools",
      "network-as-a-service platforms"
    ],
    relatedSafeguards: ["4.2", "7.3"],
    systemPrompt: {
      role: "network_infrastructure_management_expert",
      context: "You are evaluating network infrastructure management solutions against CIS Control 12.1 requirements for ensuring network infrastructure is kept up-to-date with latest stable software releases and supported NaaS offerings.",
      objective: "Determine if a vendor solution provides comprehensive network infrastructure update management with monthly software version reviews and support verification.",
      guidelines: [
        "Verify network infrastructure up-to-date maintenance capabilities",
        "Confirm latest stable software release management and deployment",
        "Validate currently supported network-as-a-service offering utilization",
        "Assess monthly software version review processes and frequency",
        "Review automated patching tools and network management systems",
        "Check software support verification and maintenance tracking"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.2": {
    id: "12.2",
    title: "Establish and Maintain a Secure Network Architecture",
    description: "Design and maintain a secure network architecture. A secure network architecture must address segmentation, least privilege, and availability, at a minimum. Example implementations may include documentation, policy, and design components",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "design secure network architecture",
      "maintain secure network architecture",
      "must address segmentation, least privilege, and availability at minimum",
      "secure network architecture requirements"
    ],
    coreRequirements: [ // Green - The "what"
      "secure network architecture",
      "segmentation",
      "least privilege (POLP)",
      "availability"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "design",
      "maintain", 
      "secure network architecture",
      "must address",
      "segmentation",
      "least privilege",
      "availability",
      "at a minimum"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "documentation",
      "policy", 
      "design components",
      "network architecture tools"
    ],
    relatedSafeguards: ["3.3", "3.10", "4.2", "12.4", "13.3", "13.4", "13.6", "13.8", "13.9", "13.10"],
    systemPrompt: {
      role: "network_architecture_security_expert",
      context: "You are evaluating secure network architecture solutions against CIS Control 12.2 requirements for designing and maintaining secure network architecture with segmentation, least privilege, and availability considerations.",
      objective: "Determine if a vendor solution provides comprehensive secure network architecture capabilities including segmentation, least privilege implementation, and availability management.",
      guidelines: [
        "Verify secure network architecture design and maintenance capabilities",
        "Confirm network segmentation implementation and effectiveness",
        "Validate least privilege network access controls and enforcement",
        "Assess availability management and resilience features",
        "Review network architecture documentation, policy, and design components",
        "Check secure network management tools and architecture frameworks"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.3": {
    id: "12.3",
    title: "Securely Manage Network Infrastructure",
    description: "Securely manage network infrastructure. Example implementations include version-controlled-infrastructure-as code, and the use of secure network protocols, such as SSH and HTTPS",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "securely manage network infrastructure",
      "secure network protocols usage",
      "infrastructure security management",
      "secure management practices"
    ],
    coreRequirements: [ // Green - The "what"
      "secure network management",
      "version-controlled infrastructure-as-code", 
      "secure network protocols",
      "infrastructure security"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "securely manage",
      "network infrastructure",
      "version-controlled infrastructure-as-code",
      "use of secure network protocols",
      "SSH",
      "HTTPS"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "network management and monitoring tool",
      "infrastructure-as-code platforms",
      "secure protocol implementations"
    ],
    relatedSafeguards: ["4.2", "12.6"],
    systemPrompt: {
      role: "network_infrastructure_security_management_expert",
      context: "You are evaluating network infrastructure security management solutions against CIS Control 12.3 requirements for securely managing network infrastructure with version-controlled infrastructure-as-code and secure network protocols like SSH and HTTPS.",
      objective: "Determine if a vendor solution provides comprehensive secure network infrastructure management capabilities including infrastructure-as-code and secure protocol implementation.",
      guidelines: [
        "Verify secure network infrastructure management capabilities and practices",
        "Confirm version-controlled infrastructure-as-code implementation and management",
        "Validate secure network protocol usage (SSH, HTTPS) and enforcement",
        "Assess infrastructure security controls and management frameworks",
        "Review network management and monitoring tools integration",
        "Check secure protocol implementation and infrastructure automation"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.4": {
    id: "12.4",
    title: "Establish and Maintain Architecture Diagram(s)",
    description: "Establish and maintain architecture diagram(s) and/or other network system documentation. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["documentation"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish architecture diagrams",
      "maintain architecture diagrams", 
      "review and update documentation annually",
      "when significant enterprise changes occur that could impact this Safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "architecture diagrams",
      "network system documentation",
      "documentation review and updates",
      "enterprise change management"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish",
      "maintain",
      "architecture diagrams",
      "other network system documentation",
      "review and update documentation",
      "annually",
      "when significant enterprise changes occur"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "network architecture diagramming tool",
      "documentation management systems",
      "architecture visualization tools"
    ],
    relatedSafeguards: ["3.8", "4.2", "12.2"],
    systemPrompt: {
      role: "network_architecture_documentation_expert",
      context: "You are evaluating network architecture documentation solutions against CIS Control 12.4 requirements for establishing and maintaining architecture diagrams and network system documentation with annual reviews and change management.",
      objective: "Determine if a vendor solution provides comprehensive network architecture documentation capabilities including diagramming, documentation management, and regular updates.",
      guidelines: [
        "Verify architecture diagram establishment and maintenance capabilities",
        "Confirm network system documentation management and organization",
        "Validate annual documentation review and update processes",
        "Assess change management for significant enterprise changes",
        "Review network architecture diagramming tools and visualization systems",
        "Check documentation management systems and version control features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.5": {
    id: "12.5",
    title: "Centralize Network Authentication, Authorization, and Auditing (AAA)",
    description: "Centralize network AAA",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "centralize network AAA",
      "network authentication centralization",
      "network authorization centralization", 
      "network auditing centralization"
    ],
    coreRequirements: [ // Green - The "what"
      "network AAA centralization",
      "authentication",
      "authorization",
      "auditing"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "centralize",
      "network AAA",
      "authentication",
      "authorization", 
      "auditing"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "identity and access management tool",
      "AAA servers",
      "centralized authentication systems"
    ],
    relatedSafeguards: ["4.2", "5.6", "6.7", "8.9", "12.6", "12.7"],
    systemPrompt: {
      role: "network_aaa_centralization_expert",
      context: "You are evaluating network AAA centralization solutions against CIS Control 12.5 requirements for centralizing network authentication, authorization, and auditing (AAA) functions.",
      objective: "Determine if a vendor solution provides comprehensive centralized network AAA capabilities with authentication, authorization, and auditing integration.",
      guidelines: [
        "Verify centralized network AAA implementation and effectiveness",
        "Confirm network authentication centralization and management",
        "Validate authorization controls and centralized access management",
        "Assess auditing capabilities and centralized logging integration",
        "Review AAA servers and centralized authentication systems",
        "Check identity and access management tool integration and AAA functionality"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.6": {
    id: "12.6",
    title: "Use of Secure Network Management and Communication Protocols",
    description: "Use secure network management and communication protocols (e.g., 802.1X, Wi-Fi Protected Access 2 (WPA2) Enterprise or greater)",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "use secure network management protocols",
      "use secure communication protocols",
      "secure protocol implementation",
      "enterprise-grade security protocols"
    ],
    coreRequirements: [ // Green - The "what"
      "secure network management",
      "secure communication protocols",
      "802.1X implementation",
      "WPA2 Enterprise or greater"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "use",
      "secure network management",
      "communication protocols",
      "802.1X", 
      "Wi-Fi Protected Access 2 (WPA2) Enterprise",
      "greater"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "802.1X authentication systems",
      "enterprise wireless controllers",
      "secure protocol implementations"
    ],
    relatedSafeguards: ["12.3", "12.5"],
    systemPrompt: {
      role: "secure_network_protocol_expert",
      context: "You are evaluating secure network management and communication protocol solutions against CIS Control 12.6 requirements for implementing enterprise-grade secure protocols.",
      objective: "Determine if a vendor solution provides comprehensive secure network management and communication protocol capabilities including 802.1X and WPA2 Enterprise or greater.",
      guidelines: [
        "Verify secure network management protocol implementation",
        "Confirm secure communication protocol deployment (802.1X, WPA2 Enterprise+)",
        "Validate enterprise-grade security protocol capabilities",
        "Assess secure protocol implementation and configuration",
        "Review network security policy and process integration",
        "Check wireless security and authentication system compatibility"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.7": {
    id: "12.7",
    title: "Ensure Remote Devices Utilize a VPN and are Connecting to an Enterprise's AAA Infrastructure",
    description: "Require users to authenticate to enterprise-managed VPN and authentication services prior to accessing enterprise resources on end-user devices",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "require users to authenticate to enterprise-managed VPN",
      "authenticate to authentication services",
      "prior to accessing enterprise resources on end-user devices",
      "VPN and AAA integration requirements"
    ],
    coreRequirements: [ // Green - The "what"
      "enterprise-managed VPN",
      "authentication services",
      "user authentication requirements",
      "enterprise resource access control"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "require",
      "users to authenticate",
      "enterprise-managed VPN",
      "authentication services",
      "prior to accessing enterprise resources",
      "end-user devices"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "VPN/encryption tool",
      "enterprise VPN solutions",
      "AAA integration systems"
    ],
    relatedSafeguards: ["6.4", "12.5"],
    systemPrompt: {
      role: "remote_access_vpn_expert",
      context: "You are evaluating remote access VPN and AAA integration solutions against CIS Control 12.7 requirements for ensuring remote devices utilize enterprise-managed VPN and authentication.",
      objective: "Determine if a vendor solution provides comprehensive remote device VPN requirements and AAA infrastructure integration for enterprise resource access.",
      guidelines: [
        "Verify enterprise-managed VPN deployment and user authentication requirements",
        "Confirm AAA infrastructure integration and authentication services",
        "Validate remote device access control and enterprise resource protection",
        "Assess VPN and authentication service integration capabilities",
        "Review secure network management policy and VPN tool compatibility",
        "Check end-user device authentication and access control systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "12.8": {
    id: "12.8",
    title: "Establish and Maintain Dedicated Computing Resources for All Administrative Work",
    description: "Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access",
    implementationGroup: "IG3",
    assetType: ["devices"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "establish dedicated computing resources for administrative work",
      "maintain dedicated computing resources",
      "segmented from enterprise's primary network",
      "not allowed internet access"
    ],
    coreRequirements: [ // Green - The "what"
      "dedicated computing resources (SAW)",
      "administrative tasks isolation", 
      "administrative access separation",
      "network segmentation from primary network"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish",
      "maintain",
      "dedicated computing resources",
      "physically or logically separated",
      "all administrative tasks",
      "tasks requiring administrative access",
      "segmented from primary network",
      "no internet access"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure network management and design policy/process",
      "secure admin workstations (SAW)",
      "network segmentation tools",
      "administrative isolation systems"
    ],
    relatedSafeguards: ["1.1", "5.1"],
    systemPrompt: {
      role: "secure_admin_workstation_expert",
      context: "You are evaluating secure administrative workstation (SAW) solutions against CIS Control 12.8 requirements for establishing dedicated computing resources for administrative work.",
      objective: "Determine if a vendor solution provides comprehensive dedicated computing resources for administrative tasks with proper network segmentation and internet access restrictions.",
      guidelines: [
        "Verify dedicated computing resource establishment and maintenance for administrative work",
        "Confirm administrative task isolation and access separation capabilities",
        "Validate network segmentation from enterprise primary network",
        "Assess internet access restriction and administrative isolation systems",
        "Review secure network management policy and SAW implementation",
        "Check administrative workstation security and separation tools"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 13: Network Monitoring and Defense
  "13.1": {
    id: "13.1",
    title: "Centralize Security Event Alerting",
    description: "Centralize security event alerting across enterprise assets for log correlation and analysis. Security event alerting includes, at a minimum, active exploitation attempts of enterprise assets",
    implementationGroup: "IG2",
    assetType: ["network", "devices"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "centralize security event alerting across enterprise assets",
      "log correlation and analysis",
      "active exploitation attempts monitoring"
    ],
    coreRequirements: [ // Green - The "what"
      "centralized security event alerting",
      "log correlation capabilities", 
      "analysis of security events",
      "active exploitation attempt detection"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "centralize security event alerting",
      "across enterprise assets",
      "for log correlation",
      "for analysis",
      "active exploitation attempts",
      "of enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security information and event management (SIEM)",
      "security orchestration, automation and response (SOAR)",
      "log aggregation platforms",
      "event correlation engines"
    ],
    relatedSafeguards: ["8.1", "8.2", "8.11", "13.2", "13.3", "13.11"],
    systemPrompt: {
      role: "security_event_alerting_expert",
      context: "You are evaluating security event alerting and correlation solutions against CIS Control 13.1 requirements for centralizing security event alerting across enterprise assets.",
      objective: "Determine if a vendor solution provides comprehensive centralized security event alerting with log correlation and analysis capabilities for detecting active exploitation attempts.",
      guidelines: [
        "Verify centralized security event alerting across all enterprise assets",
        "Confirm log correlation and analysis capabilities",
        "Validate active exploitation attempt detection and monitoring",
        "Assess SIEM/SOAR integration and event management systems",
        "Review security information correlation and automated response",
        "Check enterprise-wide security event coverage and alerting"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.2": {
    id: "13.2", 
    title: "Deploy a Host-Based Intrusion Detection Solution",
    description: "Deploy a host-based intrusion detection solution on enterprise assets, where technically feasible",
    implementationGroup: "IG2",
    assetType: ["devices"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "deploy host-based intrusion detection solution",
      "on enterprise assets",
      "where technically feasible"
    ],
    coreRequirements: [ // Green - The "what"
      "host-based intrusion detection solution",
      "deployment on enterprise assets",
      "technical feasibility assessment"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy",
      "host-based intrusion detection solution",
      "on enterprise assets", 
      "where technically feasible"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "host-based intrusion detection systems (HIDS)",
      "endpoint detection and response (EDR)",
      "host-based security monitoring",
      "behavioral analysis tools"
    ],
    relatedSafeguards: ["1.1", "13.1", "13.3", "13.7"],
    systemPrompt: {
      role: "host_intrusion_detection_expert",
      context: "You are evaluating host-based intrusion detection solutions against CIS Control 13.2 requirements for deploying HIDS on enterprise assets where technically feasible.",
      objective: "Determine if a vendor solution provides comprehensive host-based intrusion detection capabilities for enterprise asset deployment and protection.",
      guidelines: [
        "Verify host-based intrusion detection solution deployment capabilities",
        "Confirm enterprise asset coverage where technically feasible",
        "Validate HIDS/EDR functionality and behavioral analysis",
        "Assess technical feasibility assessment and deployment planning",
        "Review host-based security monitoring and detection capabilities",
        "Check endpoint protection and response integration systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.3": {
    id: "13.3",
    title: "Deploy a Network Intrusion Detection Solution", 
    description: "Deploy a network intrusion detection solution with ruleset tuned for threats facing the enterprise's industry sector",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "deploy network intrusion detection solution",
      "ruleset tuned for threats facing enterprise's industry sector"
    ],
    coreRequirements: [ // Green - The "what"
      "network intrusion detection solution",
      "threat-tuned rulesets",
      "industry-specific threat focus"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy",
      "network intrusion detection solution", 
      "with ruleset tuned",
      "for threats facing",
      "the enterprise's industry sector"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "network intrusion detection systems (NIDS)",
      "network security monitoring",
      "threat intelligence integration",
      "industry-specific threat feeds"
    ],
    relatedSafeguards: ["13.1", "13.2", "13.8"],
    systemPrompt: {
      role: "network_intrusion_detection_expert",
      context: "You are evaluating network intrusion detection solutions against CIS Control 13.3 requirements for deploying NIDS with industry-specific threat-tuned rulesets.",
      objective: "Determine if a vendor solution provides comprehensive network intrusion detection with threat rulesets tuned for the enterprise's industry sector.",
      guidelines: [
        "Verify network intrusion detection solution deployment capabilities",
        "Confirm threat-tuned rulesets for industry-specific threats",
        "Validate industry sector threat focus and intelligence integration",
        "Assess NIDS configuration and threat feed integration",
        "Review network security monitoring and threat detection capabilities",
        "Check industry-specific threat intelligence and rule customization"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.4": {
    id: "13.4",
    title: "Perform Traffic Filtering Between Network Segments",
    description: "Perform traffic filtering between network segments, where technically feasible",
    implementationGroup: "IG2", 
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "perform traffic filtering between network segments",
      "where technically feasible"
    ],
    coreRequirements: [ // Green - The "what"
      "traffic filtering between network segments",
      "network segmentation controls",
      "technical feasibility assessment"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "perform traffic filtering",
      "between network segments",
      "where technically feasible"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "network firewalls",
      "micro-segmentation",
      "network access control",
      "software-defined perimeter"
    ],
    relatedSafeguards: ["12.2", "12.3", "13.9"],
    systemPrompt: {
      role: "network_traffic_filtering_expert",
      context: "You are evaluating network traffic filtering solutions against CIS Control 13.4 requirements for performing traffic filtering between network segments where technically feasible.",
      objective: "Determine if a vendor solution provides comprehensive traffic filtering capabilities between network segments with technical feasibility assessment.",
      guidelines: [
        "Verify traffic filtering capabilities between network segments",
        "Confirm network segmentation controls and micro-segmentation",
        "Validate technical feasibility assessment for filtering implementation",
        "Assess network firewall and access control capabilities",
        "Review software-defined perimeter and network access control",
        "Check network security architecture and segmentation tools"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.5": {
    id: "13.5",
    title: "Manage Access Control for Remote Assets",
    description: "Manage access control for assets remotely connecting to enterprise networks. Determine amount of access to the enterprise network based on: up-to-date anti-malware software, up-to date system patches, up-to-date host-based firewall, and up-to-date host-based intrusion detection or intrusion prevention system",
    implementationGroup: "IG2",
    assetType: ["devices", "network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "manage access control for assets remotely connecting to enterprise networks",
      "determine amount of access based on security posture"
    ],
    coreRequirements: [ // Green - The "what"
      "access control for remote assets",
      "remote connection management",
      "security posture-based access"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "manage access control",
      "for assets remotely connecting", 
      "to enterprise networks",
      "determine amount of access",
      "up-to-date anti-malware software",
      "up-to-date system patches",
      "up-to-date host-based firewall", 
      "up-to-date host-based intrusion detection or prevention"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "network access control (NAC)",
      "zero trust network access",
      "device compliance checking",
      "posture assessment tools"
    ],
    relatedSafeguards: ["6.1", "10.1", "10.7", "12.1", "13.2"],
    systemPrompt: {
      role: "remote_access_control_expert",
      context: "You are evaluating remote access control solutions against CIS Control 13.5 requirements for managing access control for assets remotely connecting to enterprise networks based on security posture.",
      objective: "Determine if a vendor solution provides comprehensive remote asset access control based on security posture including anti-malware, patches, firewalls, and intrusion detection/prevention.",
      guidelines: [
        "Verify remote asset access control management capabilities",
        "Confirm security posture-based access determination (anti-malware, patches, firewall, IDS/IPS)",
        "Validate network access control (NAC) and zero trust capabilities",
        "Assess device compliance checking and posture assessment tools",
        "Review remote connection management and enterprise network protection",
        "Check up-to-date security control verification and access enforcement"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.6": {
    id: "13.6",
    title: "Collect Network Traffic Flow Logs",
    description: "Collect network traffic flow logs and/or network traffic to review and alert upon",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "collect network traffic flow logs and/or network traffic",
      "to review and alert upon"
    ],
    coreRequirements: [ // Green - The "what"
      "network traffic flow log collection",
      "network traffic monitoring",
      "review and alerting capabilities"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "collect network traffic flow logs",
      "collect network traffic",
      "to review",
      "to alert upon"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "network flow analyzers",
      "packet capture systems",
      "network monitoring tools",
      "traffic analysis platforms"
    ],
    relatedSafeguards: ["8.5", "13.1", "13.3"],
    systemPrompt: {
      role: "network_traffic_monitoring_expert",
      context: "You are evaluating network traffic flow monitoring solutions against CIS Control 13.6 requirements for collecting network traffic flow logs and traffic for review and alerting.",
      objective: "Determine if a vendor solution provides comprehensive network traffic flow log collection and monitoring capabilities for review and alerting purposes.",
      guidelines: [
        "Verify network traffic flow log collection capabilities",
        "Confirm network traffic monitoring and capture systems",
        "Validate review and alerting capabilities for traffic analysis",
        "Assess network flow analyzers and packet capture systems",
        "Review traffic analysis platforms and monitoring tools",
        "Check network security monitoring and flow-based detection"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.7": {
    id: "13.7",
    title: "Deploy a Host-Based Intrusion Prevention Solution",
    description: "Deploy a host-based intrusion prevention solution on enterprise assets, where technically feasible",
    implementationGroup: "IG3",
    assetType: ["devices"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "deploy host-based intrusion prevention solution",
      "on enterprise assets",
      "where technically feasible"
    ],
    coreRequirements: [ // Green - The "what"
      "host-based intrusion prevention solution",
      "deployment on enterprise assets",
      "technical feasibility assessment"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy",
      "host-based intrusion prevention solution",
      "on enterprise assets",
      "where technically feasible"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "host-based intrusion prevention systems (HIPS)",
      "endpoint protection platforms",
      "behavioral blocking systems",
      "automated threat response"
    ],
    relatedSafeguards: ["13.2", "13.8"],
    systemPrompt: {
      role: "host_intrusion_prevention_expert",
      context: "You are evaluating host-based intrusion prevention solutions against CIS Control 13.7 requirements for deploying HIPS on enterprise assets where technically feasible.",
      objective: "Determine if a vendor solution provides comprehensive host-based intrusion prevention capabilities for enterprise asset deployment and automated threat response.",
      guidelines: [
        "Verify host-based intrusion prevention solution deployment capabilities",
        "Confirm enterprise asset coverage where technically feasible",
        "Validate HIPS/EPP functionality and behavioral blocking systems",
        "Assess automated threat response and prevention capabilities",
        "Review endpoint protection platforms and response automation",
        "Check real-time threat prevention and blocking systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.8": {
    id: "13.8",
    title: "Deploy a Network Intrusion Prevention Solution",
    description: "Deploy a network intrusion prevention solution to block malicious network traffic in real-time",
    implementationGroup: "IG3",
    assetType: ["network"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "deploy network intrusion prevention solution",
      "to block malicious network traffic in real-time"
    ],
    coreRequirements: [ // Green - The "what"
      "network intrusion prevention solution",
      "malicious traffic blocking",
      "real-time response capabilities"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy",
      "network intrusion prevention solution",
      "to block malicious network traffic",
      "in real-time"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "network intrusion prevention systems (NIPS)",
      "inline security appliances",
      "automated blocking systems",
      "real-time threat mitigation"
    ],
    relatedSafeguards: ["13.3", "13.7"],
    systemPrompt: {
      role: "network_intrusion_prevention_expert",
      context: "You are evaluating network intrusion prevention solutions against CIS Control 13.8 requirements for deploying NIPS to block malicious network traffic in real-time.",
      objective: "Determine if a vendor solution provides comprehensive network intrusion prevention capabilities for real-time malicious traffic blocking and automated threat mitigation.",
      guidelines: [
        "Verify network intrusion prevention solution deployment capabilities",
        "Confirm real-time malicious traffic blocking and response",
        "Validate NIPS functionality and inline security appliances",
        "Assess automated blocking systems and threat mitigation",
        "Review real-time threat response and prevention capabilities",
        "Check network-based attack prevention and blocking efficiency"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.9": {
    id: "13.9",
    title: "Deploy Port-Level Access Control",
    description: "Deploy port-level access control. Port-level access control utilizes 802.1x, or similar network access control protocols, such as certificates",
    implementationGroup: "IG3",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "deploy port-level access control",
      "utilizes 802.1x or similar network access control protocols"
    ],
    coreRequirements: [ // Green - The "what"
      "port-level access control",
      "802.1x implementation",
      "network access control protocols"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy port-level access control",
      "utilizes 802.1x",
      "similar network access control protocols",
      "such as certificates"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "802.1x authentication",
      "network access control systems",
      "certificate-based authentication",
      "port-based network access control"
    ],
    relatedSafeguards: ["12.7", "13.4"],
    systemPrompt: {
      role: "port_access_control_expert",
      context: "You are evaluating port-level access control solutions against CIS Control 13.9 requirements for deploying 802.1x or similar network access control protocols for port-level access control.",
      objective: "Determine if a vendor solution provides comprehensive port-level access control capabilities using 802.1x or similar network access control protocols including certificate-based authentication.",
      guidelines: [
        "Verify port-level access control deployment capabilities",
        "Confirm 802.1x implementation and network access control protocols",
        "Validate certificate-based authentication and similar protocols",
        "Assess network access control systems and port-based authentication",
        "Review 802.1x infrastructure and certificate management",
        "Check port-based network access control and authentication systems"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.10": {
    id: "13.10",
    title: "Perform Application Layer Filtering",
    description: "Perform application layer filtering to protect against the enterprise's most common network-based attacks",
    implementationGroup: "IG3",
    assetType: ["network", "applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "perform application layer filtering",
      "to protect against enterprise's most common network-based attacks"
    ],
    coreRequirements: [ // Green - The "what"
      "application layer filtering",
      "protection against common network-based attacks",
      "enterprise-specific threat focus"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "perform application layer filtering",
      "to protect against",
      "the enterprise's most common",
      "network-based attacks"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "web application firewalls",
      "application layer gateways",
      "deep packet inspection",
      "application-aware filtering"
    ],
    relatedSafeguards: ["13.4", "16.11"],
    systemPrompt: {
      role: "application_layer_filtering_expert",
      context: "You are evaluating application layer filtering solutions against CIS Control 13.10 requirements for performing application layer filtering to protect against enterprise's most common network-based attacks.",
      objective: "Determine if a vendor solution provides comprehensive application layer filtering capabilities to protect against common network-based attacks specific to the enterprise environment.",
      guidelines: [
        "Verify application layer filtering capabilities and deployment",
        "Confirm protection against enterprise's most common network-based attacks",
        "Validate web application firewalls and application layer gateways",
        "Assess deep packet inspection and application-aware filtering",
        "Review enterprise-specific threat focus and attack prevention",
        "Check application layer security and network-based attack mitigation"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "13.11": {
    id: "13.11",
    title: "Tune Security Event Alerting Thresholds",
    description: "Tune security event alerting thresholds monthly, or more frequently",
    implementationGroup: "IG3",
    assetType: ["network", "devices"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "tune security event alerting thresholds",
      "monthly or more frequently"
    ],
    coreRequirements: [ // Green - The "what"
      "security event alerting threshold tuning",
      "monthly tuning frequency",
      "threshold optimization"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "tune security event alerting thresholds",
      "monthly",
      "or more frequently"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "SIEM tuning processes",
      "threshold optimization tools",
      "alert management platforms",
      "false positive reduction"
    ],
    relatedSafeguards: ["13.1", "8.11"],
    systemPrompt: {
      role: "security_alert_tuning_expert",
      context: "You are evaluating security event alerting threshold tuning solutions against CIS Control 13.11 requirements for tuning security event alerting thresholds monthly or more frequently.",
      objective: "Determine if a vendor solution provides comprehensive security event alerting threshold tuning capabilities with monthly or more frequent optimization cycles.",
      guidelines: [
        "Verify security event alerting threshold tuning capabilities",
        "Confirm monthly or more frequent tuning frequency and processes",
        "Validate SIEM tuning processes and threshold optimization tools",
        "Assess alert management platforms and false positive reduction",
        "Review threshold optimization and alerting efficiency",
        "Check automated tuning capabilities and performance monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 9: Email and Web Browser Protections
  "9.1": {
    id: "9.1",
    title: "Ensure Use of Only Fully Supported Browsers and Email Clients",
    description: "Ensure only fully supported browsers and email clients are allowed to execute in the enterprise, only using the latest version of browsers and email clients provided through the vendor",
    implementationGroup: "IG1",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "ensure only fully supported browsers and email clients are allowed to execute",
      "only using the latest version provided through the vendor"
    ],
    coreRequirements: [ // Green - The "what"
      "fully supported browsers only",
      "fully supported email clients only", 
      "latest vendor versions only",
      "execution restriction enforcement"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "ensure only fully supported",
      "browsers and email clients",
      "are allowed to execute",
      "in the enterprise",
      "only using the latest version",
      "provided through the vendor"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "enterprise and software asset management tools",
      "application allowlisting",
      "software inventory systems",
      "automated patch management"
    ],
    relatedSafeguards: ["2.1", "4.1", "7.4"],
    systemPrompt: {
      role: "browser_email_client_security_expert",
      context: "You are evaluating browser and email client security solutions against CIS Control 9.1 requirements for ensuring only fully supported, latest versions are used.",
      objective: "Determine if a vendor solution provides comprehensive browser and email client version management and execution control.",
      guidelines: [
        "Verify enforcement of fully supported browsers and email clients only",
        "Confirm latest vendor version requirement and update management",
        "Validate execution restriction and application allowlisting capabilities",
        "Assess enterprise software asset management tool integration",
        "Review automated patch management for browsers and email clients",
        "Check software inventory and compliance monitoring features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "9.2": {
    id: "9.2",
    title: "Use DNS Filtering Services",
    description: "Use DNS filtering services on all end-user devices, including remote and on-premise assets, to block access to known malicious domains",
    implementationGroup: "IG1",
    assetType: ["devices", "network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "use DNS filtering services on all end-user devices",
      "including remote and on-premise assets",
      "to block access to known malicious domains"
    ],
    coreRequirements: [ // Green - The "what"
      "DNS filtering services deployment",
      "all end-user device coverage",
      "malicious domain blocking",
      "remote and on-premise asset inclusion"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "use DNS filtering services",
      "on all end-user devices", 
      "including remote assets",
      "including on-premise assets",
      "to block access",
      "to known malicious domains"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "DNS filtering services",
      "secure DNS servers",
      "DNS security platforms",
      "cloud-based DNS filtering"
    ],
    relatedSafeguards: ["4.1", "4.9"],
    systemPrompt: {
      role: "dns_filtering_security_expert",
      context: "You are evaluating DNS filtering solutions against CIS Control 9.2 requirements for DNS filtering services to block malicious domains.",
      objective: "Determine if a vendor solution provides comprehensive DNS filtering capabilities for all end-user devices to block malicious domains.",
      guidelines: [
        "Verify DNS filtering service deployment for all end-user devices",
        "Confirm malicious domain blocking capabilities and coverage",
        "Validate remote and on-premise asset inclusion",
        "Assess DNS filtering service effectiveness and accuracy",
        "Review secure DNS server configuration and cloud-based filtering",
        "Check DNS security platform integration and management features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "9.3": {
    id: "9.3",
    title: "Maintain and Enforce Network-Based URL Filters",
    description: "Enforce and update network-based URL filters to limit an enterprise asset from connecting to potentially malicious or unapproved websites. Example implementations include category-based filtering, reputation-based filtering, or through the use of block lists. Enforce filters for all enterprise assets",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "enforce and update network-based URL filters",
      "to limit enterprise asset from connecting to potentially malicious or unapproved websites",
      "enforce filters for all enterprise assets"
    ],
    coreRequirements: [ // Green - The "what"
      "network-based URL filters",
      "enterprise asset connection limiting",
      "malicious website blocking",
      "unapproved website blocking"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "enforce network-based URL filters",
      "update network-based URL filters",
      "limit enterprise asset from connecting",
      "to potentially malicious websites",
      "to unapproved websites",
      "enforce filters for all enterprise assets"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "URL filtering tools",
      "category-based filtering",
      "reputation-based filtering", 
      "block lists",
      "web content filtering"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "network_security_filtering_expert",
      context: "You are evaluating network-based URL filtering solutions against CIS Control 9.3 requirements for network-based URL filters to limit enterprise asset connections to malicious or unapproved websites.",
      objective: "Determine if a vendor solution provides comprehensive network-based URL filtering capabilities to enforce connection limits for all enterprise assets.",
      guidelines: [
        "Verify network-based URL filter implementation and enforcement",
        "Confirm malicious and unapproved website blocking capabilities",
        "Validate coverage for all enterprise assets in the filtering system",
        "Assess category-based, reputation-based, and block list filtering methods",
        "Review filter update mechanisms and management processes",
        "Check network-level enforcement and bypass prevention"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "9.4": {
    id: "9.4",
    title: "Restrict Unnecessary or Unauthorized Browser and Email Client Extensions",
    description: "Restrict, either through uninstalling or disabling, any unauthorized or unnecessary browser or email client plugins, extensions, and add-on applications",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "restrict unauthorized or unnecessary browser or email client plugins, extensions, and add-on applications",
      "either through uninstalling or disabling"
    ],
    coreRequirements: [ // Green - The "what"
      "browser plugin restrictions",
      "email client plugin restrictions",
      "browser extension restrictions",
      "add-on application restrictions"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "restrict through uninstalling or disabling",
      "unauthorized browser plugins",
      "unnecessary browser plugins",
      "unauthorized email client plugins",
      "unnecessary email client plugins",
      "unauthorized browser extensions",
      "unnecessary browser extensions",
      "unauthorized add-on applications",
      "unnecessary add-on applications"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "configuration management tools",
      "browser management systems",
      "application control policies",
      "extension management platforms"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "browser_security_management_expert",
      context: "You are evaluating browser and email client extension management solutions against CIS Control 9.4 requirements for restricting unauthorized or unnecessary plugins, extensions, and add-on applications.",
      objective: "Determine if a vendor solution provides comprehensive browser and email client extension restriction capabilities through uninstalling or disabling mechanisms.",
      guidelines: [
        "Verify browser plugin and extension restriction capabilities",
        "Confirm email client plugin and extension management",
        "Validate unauthorized and unnecessary application identification",
        "Assess uninstalling and disabling mechanisms and enforcement",
        "Review configuration management and policy enforcement tools",
        "Check browser management system integration and compliance monitoring"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "9.5": {
    id: "9.5",
    title: "Implement DMARC",
    description: "To lower the chance of spoofed or modified emails from valid domains, implement DMARC policy and verification, starting with implementing the Sender Policy Framework (SPF) and the DomainKeys Identified Mail (DKIM) standards",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "implement DMARC policy and verification",
      "to lower the chance of spoofed or modified emails from valid domains",
      "starting with implementing SPF and DKIM standards"
    ],
    coreRequirements: [ // Green - The "what"
      "DMARC policy implementation",
      "DMARC verification implementation",
      "SPF standard implementation",
      "DKIM standard implementation"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "implement DMARC policy",
      "implement DMARC verification",
      "to lower the chance of spoofed emails",
      "to lower the chance of modified emails",
      "from valid domains",
      "starting with implementing SPF",
      "starting with implementing DKIM",
      "Sender Policy Framework standards",
      "DomainKeys Identified Mail standards"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "DMARC management tools",
      "email authentication services",
      "SPF record management",
      "DKIM signature management"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "email_authentication_security_expert",
      context: "You are evaluating email authentication solutions against CIS Control 9.5 requirements for implementing DMARC policy and verification, including SPF and DKIM standards to prevent spoofed or modified emails.",
      objective: "Determine if a vendor solution provides comprehensive DMARC, SPF, and DKIM implementation capabilities to protect against email spoofing and modification from valid domains.",
      guidelines: [
        "Verify DMARC policy implementation and verification capabilities",
        "Confirm SPF (Sender Policy Framework) standard implementation",
        "Validate DKIM (DomainKeys Identified Mail) standard implementation",
        "Assess spoofed and modified email detection and prevention",
        "Review DMARC management tools and email authentication services",
        "Check SPF record management and DKIM signature management integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "9.6": {
    id: "9.6",
    title: "Block Unnecessary File Types",
    description: "Block unnecessary file types attempting to enter the enterprise's email gateway",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "block unnecessary file types attempting to enter the enterprise's email gateway"
    ],
    coreRequirements: [ // Green - The "what"
      "unnecessary file type blocking",
      "email gateway protection",
      "file type filtering"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "block unnecessary file types",
      "attempting to enter",
      "the enterprise's email gateway"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "email security tools",
      "email gateway filtering",
      "file type blocking systems",
      "email content filtering"
    ],
    relatedSafeguards: ["4.1"],
    systemPrompt: {
      role: "email_gateway_security_expert",
      context: "You are evaluating email gateway security solutions against CIS Control 9.6 requirements for blocking unnecessary file types attempting to enter the enterprise's email gateway.",
      objective: "Determine if a vendor solution provides comprehensive email gateway file type blocking capabilities to prevent unnecessary file types from entering the enterprise.",
      guidelines: [
        "Verify email gateway file type blocking capabilities and coverage",
        "Confirm unnecessary file type identification and filtering mechanisms",
        "Validate comprehensive email gateway protection and security controls",
        "Assess file type blocking system effectiveness and accuracy",
        "Review email security tools and content filtering integration",
        "Check email gateway filtering policies and management features"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "9.7": {
    id: "9.7",
    title: "Deploy and Maintain Email Server Anti-Malware Protections",
    description: "Deploy and maintain email server anti-malware protections, such as attachment scanning and/or sandboxing",
    implementationGroup: "IG1",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "deploy and maintain email server anti-malware protections",
      "such as attachment scanning and/or sandboxing"
    ],
    coreRequirements: [ // Green - The "what"
      "email server anti-malware protections",
      "attachment scanning capabilities",
      "sandboxing capabilities",
      "deployment and maintenance"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "deploy email server anti-malware protections",
      "maintain email server anti-malware protections",
      "such as attachment scanning",
      "such as sandboxing",
      "attachment scanning and/or sandboxing"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "email security tools",
      "anti-malware platforms",
      "attachment scanning systems",
      "email sandboxing solutions"
    ],
    relatedSafeguards: ["4.1", "10.1"],
    systemPrompt: {
      role: "email_security_anti_malware_expert",
      context: "You are evaluating email server anti-malware solutions against CIS Control 9.7 requirements for deploying and maintaining email server anti-malware protections including attachment scanning and sandboxing.",
      objective: "Determine if a vendor solution provides comprehensive email server anti-malware protection capabilities with attachment scanning and sandboxing features.",
      guidelines: [
        "Verify email server anti-malware protection deployment and maintenance",
        "Confirm attachment scanning capabilities and effectiveness",
        "Validate sandboxing capabilities and threat isolation",
        "Assess comprehensive email security protection coverage",
        "Review anti-malware platform integration and management",
        "Check email sandboxing solution effectiveness and threat detection"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 14: Security Awareness and Skills Training
  "14.1": {
    id: "14.1",
    title: "Establish and Maintain a Security Awareness Program",
    description: "Establish and maintain a security awareness program. The purpose of a security awareness program is to educate the enterprise's workforce on how to interact with enterprise assets and data in a secure manner. Conduct training at hire and, at a minimum, annually. Review and update content annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a security awareness program",
      "conduct training at hire and at a minimum annually",
      "review and update content annually or when significant enterprise changes occur"
    ],
    coreRequirements: [ // Green - The "what"
      "security awareness program establishment",
      "workforce education on secure interaction",
      "enterprise assets and data security training",
      "training frequency requirements"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish security awareness program",
      "maintain security awareness program",
      "educate enterprise workforce",
      "how to interact with enterprise assets",
      "how to interact with data in secure manner",
      "conduct training at hire",
      "conduct training minimum annually",
      "review and update content annually",
      "when significant enterprise changes occur"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "security training and awareness policy/process",
      "training documentation systems",
      "learning management systems"
    ],
    relatedSafeguards: ["14.2", "14.3", "14.4", "14.5", "14.6", "14.7", "14.8", "14.9"],
    systemPrompt: {
      role: "security_awareness_program_expert",
      context: "You are evaluating security awareness program solutions against CIS Control 14.1 requirements for establishing and maintaining comprehensive security awareness programs with annual training and content updates.",
      objective: "Determine if a vendor solution provides comprehensive security awareness program establishment and maintenance capabilities including workforce education, training delivery, and content management.",
      guidelines: [
        "Verify security awareness program establishment and maintenance capabilities",
        "Confirm workforce education on secure interaction with enterprise assets and data",
        "Validate training delivery at hire and minimum annually",
        "Assess content review and update processes annually or when enterprise changes occur",
        "Review learning management systems and training documentation capabilities",
        "Check security training and awareness tools integration and policy management"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.2": {
    id: "14.2",
    title: "Train Workforce Members to Recognize Social Engineering Attacks",
    description: "Train workforce members to recognize social engineering attacks, such as phishing, business email compromise (BEC), pretexting, and tailgating",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce members to recognize social engineering attacks",
      "such as phishing, business email compromise, pretexting, and tailgating"
    ],
    coreRequirements: [ // Green - The "what"
      "workforce training on social engineering recognition",
      "phishing attack awareness",
      "business email compromise awareness",
      "pretexting attack awareness",
      "tailgating attack awareness"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce members",
      "to recognize social engineering attacks",
      "such as phishing",
      "such as business email compromise (BEC)",
      "such as pretexting",
      "such as tailgating"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "phishing simulation platforms",
      "social engineering awareness training",
      "security awareness modules"
    ],
    relatedSafeguards: ["14.1"],
    systemPrompt: {
      role: "social_engineering_awareness_expert",
      context: "You are evaluating social engineering awareness training solutions against CIS Control 14.2 requirements for training workforce members to recognize various social engineering attacks.",
      objective: "Determine if a vendor solution provides comprehensive social engineering awareness training covering phishing, business email compromise, pretexting, and tailgating attack recognition.",
      guidelines: [
        "Verify social engineering attack recognition training capabilities",
        "Confirm phishing awareness and business email compromise (BEC) training",
        "Validate pretexting and tailgating attack awareness modules",
        "Assess phishing simulation platforms and interactive training tools",
        "Review security awareness modules and attack scenario training",
        "Check social engineering awareness training effectiveness and measurement"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.3": {
    id: "14.3",
    title: "Train Workforce Members on Authentication Best Practices",
    description: "Train workforce members on authentication best practices. Example topics include MFA, password composition, and credential management",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce members on authentication best practices",
      "example topics include MFA, password composition, and credential management"
    ],
    coreRequirements: [ // Green - The "what"
      "authentication best practices training",
      "MFA training",
      "password composition training",
      "credential management training"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce members",
      "on authentication best practices",
      "example topics include MFA",
      "example topics include password composition",
      "example topics include credential management"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "authentication training modules",
      "password security training",
      "MFA awareness programs"
    ],
    relatedSafeguards: ["14.1", "6.2", "6.3"],
    systemPrompt: {
      role: "authentication_training_expert",
      context: "You are evaluating authentication best practices training solutions against CIS Control 14.3 requirements for training workforce members on MFA, password composition, and credential management.",
      objective: "Determine if a vendor solution provides comprehensive authentication best practices training covering MFA, password security, and credential management education.",
      guidelines: [
        "Verify authentication best practices training program capabilities",
        "Confirm multi-factor authentication (MFA) training and awareness",
        "Validate password composition and security training modules",
        "Assess credential management training and best practices education",
        "Review authentication training modules and MFA awareness programs",
        "Check password security training effectiveness and user engagement"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.4": {
    id: "14.4",
    title: "Train Workforce on Data Handling Best Practices",
    description: "Train workforce members on how to identify and properly store, transfer, archive, and destroy sensitive data. This also includes training workforce members on clear screen and desk best practices, such as locking their screen when they step away from their enterprise asset, erasing physical and virtual whiteboards at the end of meetings, and storing data and assets securely",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce members on how to identify and properly store, transfer, archive, and destroy sensitive data",
      "training on clear screen and desk best practices",
      "such as locking screen when stepping away, erasing whiteboards, storing data securely"
    ],
    coreRequirements: [ // Green - The "what"
      "data handling best practices training",
      "sensitive data identification training",
      "secure data storage, transfer, archive, destroy procedures",
      "clear screen and desk policies"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce members on how to",
      "identify sensitive data",
      "properly store sensitive data",
      "properly transfer sensitive data",
      "properly archive sensitive data",
      "properly destroy sensitive data",
      "clear screen best practices",
      "clear desk best practices",
      "locking screen when stepping away",
      "erasing physical whiteboards at end of meetings",
      "erasing virtual whiteboards at end of meetings",
      "storing data and assets securely"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "data handling training modules",
      "clean desk policy training",
      "data classification training"
    ],
    relatedSafeguards: ["14.1", "3.1", "3.2"],
    systemPrompt: {
      role: "data_handling_training_expert",
      context: "You are evaluating data handling best practices training solutions against CIS Control 14.4 requirements for training workforce on sensitive data identification, storage, transfer, archival, destruction, and clear screen/desk practices.",
      objective: "Determine if a vendor solution provides comprehensive data handling training covering sensitive data lifecycle management and workspace security best practices.",
      guidelines: [
        "Verify data handling best practices training and sensitive data identification",
        "Confirm secure data storage, transfer, archive, and destruction training",
        "Validate clear screen and desk best practices including screen locking",
        "Assess whiteboard erasing and secure data storage training modules",
        "Review data classification training and clean desk policy education",
        "Check data handling training effectiveness and workspace security awareness"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.5": {
    id: "14.5",
    title: "Train Workforce Members on Causes of Unintentional Data Exposure",
    description: "Train workforce members to be aware of causes for unintentional data exposure. Example topics include mis-delivery of sensitive data, losing a portable end-user device, or publishing data to unintended audiences",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce members to be aware of causes for unintentional data exposure",
      "example topics include mis-delivery, losing portable devices, publishing to unintended audiences"
    ],
    coreRequirements: [ // Green - The "what"
      "unintentional data exposure awareness training",
      "mis-delivery prevention training",
      "portable device security awareness",
      "data publication controls training"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce members",
      "to be aware of causes for unintentional data exposure",
      "example topics include mis-delivery of sensitive data",
      "example topics include losing a portable end-user device",
      "example topics include publishing data to unintended audiences"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "data loss prevention training",
      "device security awareness training",
      "data sharing awareness programs"
    ],
    relatedSafeguards: ["14.1", "3.3"],
    systemPrompt: {
      role: "data_exposure_awareness_expert",
      context: "You are evaluating unintentional data exposure awareness training solutions against CIS Control 14.5 requirements for training workforce on causes and prevention of unintentional data exposure.",
      objective: "Determine if a vendor solution provides comprehensive training on unintentional data exposure causes including mis-delivery, portable device loss, and unintended data publication.",
      guidelines: [
        "Verify unintentional data exposure awareness training coverage",
        "Confirm mis-delivery prevention and sensitive data handling training",
        "Validate portable device security awareness and loss prevention training",
        "Assess data publication controls and unintended audience protection",
        "Review data loss prevention training and device security awareness",
        "Check data sharing awareness programs and exposure prevention education"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.6": {
    id: "14.6",
    title: "Train Workforce Members on Recognizing and Reporting Security Incidents",
    description: "Train workforce members to be able to recognize a potential incident and be able to report such an incident",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce members to be able to recognize a potential incident",
      "train workforce members to be able to report such an incident"
    ],
    coreRequirements: [ // Green - The "what"
      "security incident recognition training",
      "incident reporting training",
      "potential incident identification",
      "incident reporting procedures"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce members",
      "to be able to recognize a potential incident",
      "to be able to report such an incident"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "incident response training",
      "security incident awareness programs",
      "incident reporting tools"
    ],
    relatedSafeguards: ["14.1", "17.3"],
    systemPrompt: {
      role: "incident_recognition_training_expert",
      context: "You are evaluating security incident recognition and reporting training solutions against CIS Control 14.6 requirements for training workforce to recognize potential incidents and report them.",
      objective: "Determine if a vendor solution provides comprehensive security incident recognition training and effective incident reporting procedures for workforce members.",
      guidelines: [
        "Verify security incident recognition training capabilities and coverage",
        "Confirm potential incident identification and awareness training",
        "Validate incident reporting procedures and training effectiveness",
        "Assess incident response training and security awareness programs",
        "Review incident reporting tools and notification procedures",
        "Check security incident awareness and response training integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.7": {
    id: "14.7",
    title: "Train Workforce on How to Identify and Report if Their Enterprise Assets are Missing Security Updates",
    description: "Train workforce to understand how to verify and report out-of-date software patches or any failures in automated processes and tools. Part of this training should include notifying IT personnel of any failures in automated processes and tools",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce to understand how to verify and report out-of-date software patches",
      "train on reporting failures in automated processes and tools",
      "include notifying IT personnel of any failures in automated processes and tools"
    ],
    coreRequirements: [ // Green - The "what"
      "security update verification training",
      "out-of-date software patch identification",
      "automated process failure reporting",
      "IT personnel notification procedures"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce to understand how to",
      "verify out-of-date software patches",
      "report out-of-date software patches",
      "report any failures in automated processes",
      "report any failures in automated tools",
      "training should include notifying IT personnel",
      "of any failures in automated processes",
      "of any failures in automated tools"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "patch management awareness training",
      "IT support reporting procedures",
      "automated system monitoring training"
    ],
    relatedSafeguards: ["14.1", "7.3", "7.4"],
    systemPrompt: {
      role: "security_update_awareness_expert",
      context: "You are evaluating security update awareness training solutions against CIS Control 14.7 requirements for training workforce to identify and report missing security updates and automated process failures.",
      objective: "Determine if a vendor solution provides comprehensive training on security update verification, patch identification, and automated process failure reporting to IT personnel.",
      guidelines: [
        "Verify security update verification training and out-of-date patch identification",
        "Confirm automated process and tool failure reporting training",
        "Validate IT personnel notification procedures and reporting mechanisms",
        "Assess patch management awareness training and system monitoring education",
        "Review automated system monitoring training and failure detection",
        "Check IT support reporting procedures and escalation training"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.8": {
    id: "14.8",
    title: "Train Workforce on the Dangers of Connecting to and Transmitting Enterprise Data Over Insecure Networks",
    description: "Train workforce members on the dangers of connecting to, and transmitting data over, insecure networks for enterprise activities. If the enterprise has remote workers, training must include guidance to ensure that all users securely configure their home network infrastructure",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "train workforce members on dangers of connecting to and transmitting data over insecure networks",
      "if enterprise has remote workers, training must include guidance for secure home network configuration"
    ],
    coreRequirements: [ // Green - The "what"
      "insecure network dangers training",
      "secure connection practices",
      "enterprise data transmission security",
      "remote worker home network security"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "train workforce members on the dangers of",
      "connecting to insecure networks",
      "transmitting data over insecure networks",
      "for enterprise activities",
      "if enterprise has remote workers",
      "training must include guidance",
      "to ensure all users securely configure",
      "their home network infrastructure"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "network security awareness training",
      "remote work security training",
      "home network configuration guides"
    ],
    relatedSafeguards: ["14.1", "12.1"],
    systemPrompt: {
      role: "network_security_awareness_expert",
      context: "You are evaluating network security awareness training solutions against CIS Control 14.8 requirements for training workforce on dangers of insecure networks and remote work security including home network configuration.",
      objective: "Determine if a vendor solution provides comprehensive training on insecure network dangers, secure connection practices, and remote worker home network security configuration.",
      guidelines: [
        "Verify training on dangers of connecting to and transmitting data over insecure networks",
        "Confirm enterprise data transmission security and secure connection practices",
        "Validate remote worker training and home network security configuration guidance",
        "Assess network security awareness training and remote work security education",
        "Review home network configuration guides and insecure network identification",
        "Check enterprise activity security and remote infrastructure protection training"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "14.9": {
    id: "14.9",
    title: "Conduct Role-Specific Security Awareness and Skills Training",
    description: "Conduct role-specific security awareness and skills training. Example implementations include secure system administration courses for IT professionals, OWASP Top 10 vulnerability awareness and prevention training for web application developers, and advanced social engineering awareness training for high-profile roles",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "conduct role-specific security awareness and skills training",
      "example implementations include secure system administration courses, OWASP Top 10 training, and advanced social engineering training"
    ],
    coreRequirements: [ // Green - The "what"
      "role-specific security awareness training",
      "role-specific skills training",
      "IT professional system administration courses",
      "developer OWASP Top 10 training",
      "high-profile role advanced social engineering training"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "conduct role-specific security awareness training",
      "conduct role-specific skills training",
      "secure system administration courses for IT professionals",
      "OWASP Top 10 vulnerability awareness and prevention training for web application developers",
      "advanced social engineering awareness training for high-profile roles"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "role-based training programs",
      "specialized security courses",
      "professional development programs"
    ],
    relatedSafeguards: ["14.1", "16.9"],
    systemPrompt: {
      role: "role_specific_training_expert",
      context: "You are evaluating role-specific security awareness and skills training solutions against CIS Control 14.9 requirements for conducting specialized training including secure system administration, OWASP Top 10, and advanced social engineering awareness.",
      objective: "Determine if a vendor solution provides comprehensive role-specific security training including IT professional courses, developer vulnerability training, and high-profile role security awareness.",
      guidelines: [
        "Verify role-specific security awareness and skills training capabilities",
        "Confirm secure system administration courses for IT professionals",
        "Validate OWASP Top 10 vulnerability awareness and prevention training for developers",
        "Assess advanced social engineering awareness training for high-profile roles",
        "Review specialized security courses and professional development programs",
        "Check role-based training program customization and effectiveness measurement"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 15: Service Provider Management
  "15.1": {
    id: "15.1",
    title: "Establish and Maintain an Inventory of Service Providers",
    description: "Establish and maintain an inventory of service providers. The inventory is to list all known service providers, include classification(s), and designate an enterprise contact for each service provider. Review and update the inventory annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain an inventory of service providers",
      "list all known service providers, include classifications, designate enterprise contact",
      "review and update inventory annually or when significant enterprise changes occur"
    ],
    coreRequirements: [ // Green - The "what"
      "service provider inventory establishment",
      "comprehensive service provider listing",
      "classification system implementation",
      "enterprise contact designation"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish inventory of service providers",
      "maintain inventory of service providers",
      "list all known service providers",
      "include classifications",
      "designate an enterprise contact for each service provider",
      "review and update the inventory annually",
      "when significant enterprise changes occur that could impact this safeguard"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "third-party risk management tools",
      "service provider management platforms",
      "vendor inventory systems",
      "supplier relationship management tools"
    ],
    relatedSafeguards: ["2.1", "8.12", "15.2", "15.3", "15.4", "15.5", "15.6", "15.7"],
    systemPrompt: {
      role: "service_provider_inventory_expert",
      context: "You are evaluating service provider inventory management solutions against CIS Control 15.1 requirements for establishing and maintaining comprehensive inventories of service providers with classifications and enterprise contacts.",
      objective: "Determine if a vendor solution provides comprehensive service provider inventory capabilities including classification systems, contact management, and annual review processes.",
      guidelines: [
        "Verify service provider inventory establishment and maintenance capabilities",
        "Confirm comprehensive service provider listing and classification systems",
        "Validate enterprise contact designation and management for each provider",
        "Assess annual review processes and enterprise change impact assessment",
        "Review third-party risk management tools and vendor inventory systems",
        "Check service provider management platform integration and supplier relationship management"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "15.2": {
    id: "15.2",
    title: "Establish and Maintain a Service Provider Management Policy",
    description: "Establish and maintain a service provider management policy. Ensure the policy addresses the classification, inventory, assessment, monitoring, and decommissioning of service providers. Review and update the policy annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a service provider management policy",
      "ensure policy addresses classification, inventory, assessment, monitoring, and decommissioning",
      "review and update policy annually or when significant enterprise changes occur"
    ],
    coreRequirements: [ // Green - The "what"
      "service provider management policy establishment",
      "comprehensive policy coverage",
      "classification processes",
      "inventory management processes",
      "assessment processes",
      "monitoring processes",
      "decommissioning processes"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "establish service provider management policy",
      "maintain service provider management policy",
      "ensure policy addresses classification",
      "ensure policy addresses inventory", 
      "ensure policy addresses assessment",
      "ensure policy addresses monitoring",
      "ensure policy addresses decommissioning of service providers",
      "review and update policy annually",
      "when significant enterprise changes occur that could impact this safeguard"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "service provider management policy documentation",
      "third-party risk management frameworks",
      "vendor management policy templates",
      "supplier governance documentation"
    ],
    relatedSafeguards: ["15.1", "15.3", "15.4", "15.5", "15.6", "15.7"],
    systemPrompt: {
      role: "service_provider_policy_expert",
      context: "You are evaluating service provider management policy solutions against CIS Control 15.2 requirements for establishing and maintaining comprehensive policies covering classification, inventory, assessment, monitoring, and decommissioning.",
      objective: "Determine if a vendor solution provides comprehensive service provider management policy capabilities including all lifecycle processes and annual review requirements.",
      guidelines: [
        "Verify service provider management policy establishment and maintenance",
        "Confirm policy coverage of classification, inventory, assessment, monitoring, and decommissioning",
        "Validate annual policy review and enterprise change impact assessment",
        "Assess third-party risk management frameworks and policy documentation",
        "Review vendor management policy templates and supplier governance",
        "Check policy implementation and lifecycle process integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "15.3": {
    id: "15.3",
    title: "Classify Service Providers",
    description: "Classify service providers. Classification consideration may include one or more characteristics, such as data sensitivity, data volume, availability requirements, applicable regulations, inherent risk, and mitigated risk. Update and review classifications annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "classify service providers",
      "classification may include data sensitivity, data volume, availability requirements, applicable regulations, inherent risk, mitigated risk",
      "update and review classifications annually or when significant enterprise changes occur"
    ],
    coreRequirements: [ // Green - The "what"
      "service provider classification system",
      "risk-based classification criteria",
      "data sensitivity classification",
      "regulatory compliance classification"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "classify service providers",
      "classification consideration may include one or more characteristics",
      "such as data sensitivity",
      "such as data volume",
      "such as availability requirements",
      "such as applicable regulations",
      "such as inherent risk",
      "such as mitigated risk",
      "update and review classifications annually",
      "when significant enterprise changes occur that could impact this safeguard"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "service provider management policy",
      "risk classification frameworks",
      "data sensitivity classification schemes",
      "regulatory compliance matrices"
    ],
    relatedSafeguards: ["15.1", "15.2"],
    systemPrompt: {
      role: "service_provider_classification_expert",
      context: "You are evaluating service provider classification solutions against CIS Control 15.3 requirements for classifying service providers based on data sensitivity, volume, availability, regulations, and risk factors.",
      objective: "Determine if a vendor solution provides comprehensive service provider classification capabilities including risk-based criteria, data sensitivity assessment, and regulatory compliance classification.",
      guidelines: [
        "Verify service provider classification system implementation",
        "Confirm risk-based classification criteria including data sensitivity and volume",
        "Validate availability requirements and regulatory compliance classification",
        "Assess inherent and mitigated risk classification capabilities",
        "Review classification framework annual updates and enterprise change management",
        "Check data sensitivity classification schemes and regulatory compliance matrices"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "15.4": {
    id: "15.4",
    title: "Ensure Service Provider Contracts Include Security Requirements",
    description: "Ensure service provider contracts include security requirements. Example requirements may include minimum security program requirements, security incident and/or data breach notification and response, data encryption requirements, and data disposal commitments. These security requirements must be consistent with the enterprise's service provider management policy. Review service provider contracts annually to ensure contracts are not missing security requirements",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "ensure service provider contracts include security requirements",
      "security requirements must be consistent with enterprise's service provider management policy",
      "review service provider contracts annually to ensure contracts are not missing security requirements"
    ],
    coreRequirements: [ // Green - The "what"
      "contract security requirements inclusion",
      "minimum security program requirements",
      "security incident and data breach notification requirements",
      "data encryption requirements",
      "data disposal commitments"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "ensure service provider contracts include security requirements",
      "example requirements may include minimum security program requirements",
      "security incident and/or data breach notification and response",
      "data encryption requirements",
      "data disposal commitments",
      "security requirements must be consistent with enterprise's service provider management policy",
      "review service provider contracts annually",
      "to ensure contracts are not missing security requirements"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "contract management systems",
      "service provider management policy",
      "legal contract templates",
      "security requirement checklists"
    ],
    relatedSafeguards: ["15.1", "15.2"],
    systemPrompt: {
      role: "service_provider_contract_security_expert",
      context: "You are evaluating service provider contract security management solutions against CIS Control 15.4 requirements for ensuring contracts include comprehensive security requirements consistent with enterprise policies.",
      objective: "Determine if a vendor solution provides comprehensive contract security requirement capabilities including incident notification, data encryption, disposal commitments, and annual review processes.",
      guidelines: [
        "Verify service provider contract security requirement inclusion and management",
        "Confirm minimum security program requirements and incident/breach notification",
        "Validate data encryption requirements and data disposal commitments",
        "Assess consistency with enterprise service provider management policy",
        "Review annual contract review processes and security requirement compliance",
        "Check contract management systems and security requirement checklists"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "15.5": {
    id: "15.5",
    title: "Assess Service Providers",
    description: "Assess service providers consistent with the enterprise's service provider management policy. Assessment scope may vary based on classification(s), and may include review of standardized assessment reports, such as Service Organization Control 2 (SOC 2) and Payment Card Industry (PCI) Attestation of Compliance (AoC), customized questionnaires, or other appropriately rigorous processes. Reassess service providers annually, at a minimum, or with new and renewed contracts",
    implementationGroup: "IG3",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "assess service providers consistent with enterprise's service provider management policy",
      "assessment scope may vary based on classifications and may include SOC 2, PCI AoC, customized questionnaires, or other rigorous processes",
      "reassess service providers annually at minimum or with new and renewed contracts"
    ],
    coreRequirements: [ // Green - The "what"
      "service provider assessment processes",
      "standardized assessment report reviews",
      "customized questionnaire assessments",
      "rigorous assessment methodologies"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "assess service providers consistent with enterprise's service provider management policy",
      "assessment scope may vary based on classifications",
      "may include review of standardized assessment reports",
      "such as Service Organization Control 2 (SOC 2)",
      "Payment Card Industry (PCI) Attestation of Compliance (AoC)",
      "customized questionnaires",
      "other appropriately rigorous processes",
      "reassess service providers annually at a minimum",
      "or with new and renewed contracts"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "third-party risk management tools",
      "service provider management policy",
      "assessment questionnaire platforms",
      "compliance monitoring systems"
    ],
    relatedSafeguards: ["15.1", "15.2"],
    systemPrompt: {
      role: "service_provider_assessment_expert",
      context: "You are evaluating service provider assessment solutions against CIS Control 15.5 requirements for conducting rigorous assessments including SOC 2, PCI AoC, customized questionnaires, and annual reassessments.",
      objective: "Determine if a vendor solution provides comprehensive service provider assessment capabilities including standardized reports, customized questionnaires, and classification-based assessment scoping.",
      guidelines: [
        "Verify service provider assessment processes consistent with enterprise policy",
        "Confirm standardized assessment report reviews (SOC 2, PCI AoC)",
        "Validate customized questionnaire capabilities and rigorous assessment methodologies",
        "Assess classification-based assessment scoping and annual reassessment processes",
        "Review third-party risk management tools and compliance monitoring systems",
        "Check assessment questionnaire platforms and new/renewed contract triggers"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "15.6": {
    id: "15.6",
    title: "Monitor Service Providers",
    description: "Monitor service providers consistent with the enterprise's service provider management policy. Monitoring may include periodic reassessment of service provider compliance, monitoring service provider release notes, and dark web monitoring",
    implementationGroup: "IG3",
    assetType: ["data"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "monitor service providers consistent with enterprise's service provider management policy",
      "monitoring may include periodic reassessment, release notes monitoring, and dark web monitoring"
    ],
    coreRequirements: [ // Green - The "what"
      "service provider monitoring processes",
      "periodic compliance reassessment",
      "service provider release notes monitoring",
      "dark web monitoring"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "monitor service providers",
      "consistent with enterprise's service provider management policy",
      "monitoring may include periodic reassessment of service provider compliance",
      "monitoring service provider release notes",
      "dark web monitoring"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "third-party risk management tools",
      "service provider management policy",
      "dark web monitoring services",
      "compliance monitoring platforms"
    ],
    relatedSafeguards: ["15.1", "15.2"],
    systemPrompt: {
      role: "service_provider_monitoring_expert",
      context: "You are evaluating service provider monitoring solutions against CIS Control 15.6 requirements for monitoring service providers including periodic reassessment, release notes monitoring, and dark web monitoring.",
      objective: "Determine if a vendor solution provides comprehensive service provider monitoring capabilities including compliance reassessment, release notes tracking, and dark web monitoring services.",
      guidelines: [
        "Verify service provider monitoring processes consistent with enterprise policy",
        "Confirm periodic compliance reassessment and service provider monitoring",
        "Validate service provider release notes monitoring and tracking",
        "Assess dark web monitoring services and threat intelligence integration",
        "Review third-party risk management tools and compliance monitoring platforms",
        "Check continuous monitoring capabilities and policy compliance tracking"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "15.7": {
    id: "15.7",
    title: "Securely Decommission Service Providers",
    description: "Securely decommission service providers. Example considerations include user and service account deactivation, termination of data flows, and secure disposal of enterprise data within service provider systems",
    implementationGroup: "IG3",
    assetType: ["data"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "securely decommission service providers",
      "example considerations include user and service account deactivation, termination of data flows, secure disposal of enterprise data"
    ],
    coreRequirements: [ // Green - The "what"
      "secure service provider decommissioning",
      "user and service account deactivation",
      "data flow termination",
      "secure enterprise data disposal"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "securely decommission service providers",
      "example considerations include user and service account deactivation",
      "termination of data flows",
      "secure disposal of enterprise data within service provider systems"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "service provider management policy",
      "data destruction procedures",
      "account deactivation processes",
      "secure decommissioning checklists"
    ],
    relatedSafeguards: ["15.1", "15.2"],
    systemPrompt: {
      role: "service_provider_decommissioning_expert",
      context: "You are evaluating service provider decommissioning solutions against CIS Control 15.7 requirements for securely decommissioning service providers including account deactivation, data flow termination, and secure data disposal.",
      objective: "Determine if a vendor solution provides comprehensive secure service provider decommissioning capabilities including user/service account management, data flow control, and enterprise data disposal.",
      guidelines: [
        "Verify secure service provider decommissioning processes and procedures",
        "Confirm user and service account deactivation capabilities",
        "Validate data flow termination and enterprise data disposal processes",
        "Assess secure decommissioning checklists and account management",
        "Review data destruction procedures and secure disposal verification",
        "Check decommissioning policy compliance and process automation"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 16: Application Software Security
  "16.1": {
    id: "16.1",
    title: "Establish and Maintain a Secure Application Development Process",
    description: "Establish and maintain a secure application development process. In the process, address such items as: secure application design standards, secure coding practices, developer training, vulnerability management, security of third-party code, and application security testing procedures. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a secure application development process",
      "review and update documentation annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "secure application development process",
      "secure application design standards",
      "secure coding practices",
      "developer training",
      "vulnerability management",
      "security of third-party code",
      "application security testing procedures"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "address such items as secure application design standards",
      "address such items as secure coding practices",
      "address such items as developer training",
      "address such items as vulnerability management",
      "address such items as security of third-party code",
      "address such items as application security testing procedures",
      "review and update documentation annually",
      "when significant enterprise changes occur"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure development lifecycle (SDLC) frameworks",
      "application security policies",
      "development process documentation",
      "security training programs for developers"
    ],
    relatedSafeguards: ["16.2", "16.3", "16.4", "16.5", "16.6", "16.7", "16.8", "16.9", "16.10", "16.11", "16.12", "16.13", "16.14"],
    systemPrompt: {
      role: "secure_development_process_expert",
      context: "You are evaluating secure application development process solutions against CIS Control 16.1 requirements for establishing comprehensive secure development lifecycles including design standards, coding practices, training, and security testing.",
      objective: "Determine if a vendor solution provides comprehensive secure application development process capabilities including design standards, secure coding, developer training, vulnerability management, third-party code security, and testing procedures.",
      guidelines: [
        "Verify secure application development process establishment and maintenance",
        "Confirm secure application design standards and secure coding practices",
        "Validate developer training programs and vulnerability management integration",
        "Assess third-party code security and application security testing procedures",
        "Review SDLC frameworks and application security policies",
        "Check annual documentation updates and enterprise change impact assessment"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.2": {
    id: "16.2",
    title: "Establish and Maintain a Process to Accept and Address Software Vulnerabilities",
    description: "Establish and maintain a process to accept and address reports of software vulnerabilities, including providing a means for external entities to report. The process is to include such items as: a vulnerability handling policy that identifies reporting process, responsible party for handling vulnerability reports, and a process for intake, assignment, remediation, and remediation testing. As part of the process, use a vulnerability tracking system that includes severity ratings, and metrics for measuring timing for identification, analysis, and remediation of vulnerabilities. Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. Third-party application developers need to consider this an externally-facing policy that helps to set expectations for outside stakeholders",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a process to accept and address reports of software vulnerabilities",
      "provide a means for external entities to report vulnerabilities",
      "review and update documentation annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "process to accept and address software vulnerabilities",
      "vulnerability handling policy",
      "reporting process",
      "responsible party for handling vulnerability reports",
      "process for intake, assignment, remediation, and remediation testing",
      "vulnerability tracking system",
      "severity ratings",
      "metrics for measuring timing"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "vulnerability handling policy that identifies reporting process",
      "process for intake",
      "process for assignment",
      "process for remediation",
      "process for remediation testing",
      "vulnerability tracking system that includes severity ratings",
      "metrics for measuring timing for identification of vulnerabilities",
      "metrics for measuring timing for analysis of vulnerabilities",
      "metrics for measuring timing for remediation of vulnerabilities",
      "externally-facing policy that helps to set expectations for outside stakeholders"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "vulnerability disclosure platforms",
      "bug bounty programs",
      "vulnerability management systems",
      "incident response tools"
    ],
    relatedSafeguards: ["16.1", "16.3", "16.6"],
    systemPrompt: {
      role: "vulnerability_disclosure_process_expert",
      context: "You are evaluating vulnerability disclosure and handling process solutions against CIS Control 16.2 requirements for accepting and addressing software vulnerability reports including external reporting mechanisms and comprehensive tracking systems.",
      objective: "Determine if a vendor solution provides comprehensive vulnerability disclosure process capabilities including external reporting, vulnerability handling policy, tracking systems, and metrics for identification, analysis, and remediation timing.",
      guidelines: [
        "Verify vulnerability disclosure process establishment for internal and external reporting",
        "Confirm vulnerability handling policy including intake, assignment, remediation, and testing",
        "Validate vulnerability tracking system with severity ratings and timing metrics",
        "Assess external entity reporting mechanisms and stakeholder expectation management",
        "Review vulnerability disclosure platforms and bug bounty program integration",
        "Check annual documentation updates and responsible party designation"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.3": {
    id: "16.3",
    title: "Perform Root Cause Analysis on Security Vulnerabilities",
    description: "Perform root cause analysis on security vulnerabilities. When reviewing vulnerabilities, root cause analysis is the task of evaluating underlying issues that create vulnerabilities in code, and allows development teams to move beyond just fixing individual vulnerabilities as they arise",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "perform root cause analysis on security vulnerabilities"
    ],
    coreRequirements: [ // Green - The "what"
      "root cause analysis on security vulnerabilities",
      "evaluating underlying issues that create vulnerabilities in code"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "when reviewing vulnerabilities",
      "root cause analysis is the task of evaluating underlying issues",
      "allows development teams to move beyond just fixing individual vulnerabilities as they arise"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "code analysis tools",
      "vulnerability assessment platforms",
      "development team training on root cause analysis",
      "systematic vulnerability review processes"
    ],
    relatedSafeguards: ["16.1", "16.2"],
    systemPrompt: {
      role: "vulnerability_root_cause_analysis_expert",
      context: "You are evaluating vulnerability root cause analysis solutions against CIS Control 16.3 requirements for performing systematic root cause analysis on security vulnerabilities to address underlying issues in code.",
      objective: "Determine if a vendor solution provides comprehensive root cause analysis capabilities for security vulnerabilities including evaluation of underlying issues and systematic vulnerability review processes.",
      guidelines: [
        "Verify root cause analysis capabilities for security vulnerabilities",
        "Confirm systematic evaluation of underlying issues that create vulnerabilities",
        "Validate development team movement beyond individual vulnerability fixes",
        "Assess code analysis tools and vulnerability assessment platform integration",
        "Review development team training on root cause analysis methodologies",
        "Check systematic vulnerability review processes and pattern identification"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.4": {
    id: "16.4",
    title: "Establish and Manage an Inventory of Third-Party Software Components",
    description: "Establish and manage an updated inventory of third-party components used in development, often referred to as a \"bill of materials,\" as well as components slated for future use. This inventory is to include any risks that each third-party component could pose. Evaluate the list at least monthly to identify any changes or updates to these components, and validate that the component is still supported",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "establish and manage an updated inventory of third-party components used in development",
      "evaluate the list at least monthly to identify any changes or updates to these components and validate that the component is still supported"
    ],
    coreRequirements: [ // Green - The "what"
      "updated inventory of third-party components",
      "bill of materials",
      "components slated for future use",
      "risks that each third-party component could pose",
      "monthly evaluation",
      "component support validation"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "third-party components used in development",
      "often referred to as bill of materials",
      "components slated for future use",
      "any risks that each third-party component could pose",
      "identify any changes or updates to these components",
      "validate that the component is still supported"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "software composition analysis (SCA) tools",
      "dependency management systems",
      "component vulnerability databases",
      "automated inventory tracking tools"
    ],
    relatedSafeguards: ["16.1", "16.5"],
    systemPrompt: {
      role: "third_party_component_inventory_expert",
      context: "You are evaluating third-party software component inventory management solutions against CIS Control 16.4 requirements for maintaining bill of materials, risk assessment, and monthly component validation.",
      objective: "Determine if a vendor solution provides comprehensive third-party component inventory capabilities including bill of materials management, risk assessment, monthly evaluation, and component support validation.",
      guidelines: [
        "Verify third-party component inventory establishment and bill of materials management",
        "Confirm risk assessment for each third-party component",
        "Validate monthly evaluation processes for component changes and updates",
        "Assess component support validation and software composition analysis",
        "Review dependency management systems and component vulnerability databases",
        "Check automated inventory tracking tools and future use component planning"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.5": {
    id: "16.5",
    title: "Use Up-to-Date and Trusted Third-Party Software Components",
    description: "Use up-to-date and trusted third-party software components. When possible, choose established and proven frameworks and libraries that provide adequate security. Acquire these components from trusted sources or evaluate the software for vulnerabilities before use",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "use up-to-date and trusted third-party software components"
    ],
    coreRequirements: [ // Green - The "what"
      "up-to-date third-party software components",
      "trusted third-party software components",
      "established and proven frameworks and libraries",
      "adequate security",
      "trusted sources",
      "vulnerability evaluation before use"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "when possible choose established and proven frameworks and libraries",
      "that provide adequate security",
      "acquire these components from trusted sources",
      "evaluate the software for vulnerabilities before use"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "software composition analysis (SCA) tools",
      "trusted software repositories",
      "vulnerability scanning tools",
      "component security assessment processes"
    ],
    relatedSafeguards: ["16.1", "16.4", "16.11", "7.1"],
    systemPrompt: {
      role: "trusted_component_security_expert",
      context: "You are evaluating trusted third-party software component solutions against CIS Control 16.5 requirements for using up-to-date, trusted components from established sources with adequate security and vulnerability evaluation.",
      objective: "Determine if a vendor solution provides comprehensive trusted third-party component capabilities including up-to-date components, trusted sources, vulnerability evaluation, and proven framework selection.",
      guidelines: [
        "Verify up-to-date and trusted third-party software component usage",
        "Confirm established and proven frameworks with adequate security",
        "Validate trusted source acquisition and vulnerability evaluation before use",
        "Assess software composition analysis and component security assessment",
        "Review trusted software repositories and vulnerability scanning integration",
        "Check component security validation and source verification processes"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.6": {
    id: "16.6",
    title: "Establish and Maintain a Severity Rating System and Process for Application Vulnerabilities",
    description: "Establish and maintain a severity rating system and process for application vulnerabilities that facilitates prioritizing the order in which discovered vulnerabilities are fixed. This process includes setting a minimum level of security acceptability for releasing code or applications. Severity ratings bring a systematic way of triaging vulnerabilities that improves risk management and helps ensure the most severe bugs are fixed first. Review and update the system and process annually",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a severity rating system and process for application vulnerabilities",
      "review and update the system and process annually"
    ],
    coreRequirements: [ // Green - The "what"
      "severity rating system",
      "process for application vulnerabilities",
      "prioritizing the order in which discovered vulnerabilities are fixed",
      "minimum level of security acceptability for releasing code or applications",
      "systematic way of triaging vulnerabilities"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "facilitates prioritizing the order in which discovered vulnerabilities are fixed",
      "setting a minimum level of security acceptability for releasing code or applications",
      "severity ratings bring a systematic way of triaging vulnerabilities",
      "improves risk management",
      "helps ensure the most severe bugs are fixed first"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "CVSS scoring systems",
      "vulnerability management platforms",
      "risk assessment frameworks",
      "prioritization workflows"
    ],
    relatedSafeguards: ["16.1", "16.2"],
    systemPrompt: {
      role: "vulnerability_severity_rating_expert",
      context: "You are evaluating vulnerability severity rating system solutions against CIS Control 16.6 requirements for establishing systematic vulnerability prioritization, triaging, and risk management with minimum security acceptability levels.",
      objective: "Determine if a vendor solution provides comprehensive vulnerability severity rating capabilities including prioritization systems, triaging workflows, risk management, and minimum security acceptability standards.",
      guidelines: [
        "Verify vulnerability severity rating system establishment and maintenance",
        "Confirm systematic vulnerability prioritization and triaging capabilities",
        "Validate minimum security acceptability levels for code/application releases",
        "Assess risk management improvement and severe bug prioritization",
        "Review CVSS scoring systems and vulnerability management platforms",
        "Check annual system updates and prioritization workflow effectiveness"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.7": {
    id: "16.7",
    title: "Use Standard Hardening Configuration Templates for Application Infrastructure",
    description: "Use standard, industry-recommended hardening configuration templates for application infrastructure components. This includes underlying servers, databases, and web servers, and applies to cloud containers, Platform as a Service (PaaS) components, and SaaS components. Do not allow in-house developed software to weaken configuration hardening",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "use standard, industry-recommended hardening configuration templates for application infrastructure components",
      "do not allow in-house developed software to weaken configuration hardening"
    ],
    coreRequirements: [ // Green - The "what"
      "standard hardening configuration templates",
      "application infrastructure components",
      "underlying servers",
      "databases",
      "web servers",
      "cloud containers",
      "Platform as a Service (PaaS) components",
      "SaaS components"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "industry-recommended hardening configuration templates",
      "includes underlying servers, databases, and web servers",
      "applies to cloud containers",
      "applies to Platform as a Service (PaaS) components",
      "applies to SaaS components"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "configuration baseline tools",
      "infrastructure as code (IaC) templates",
      "security hardening guides",
      "automated configuration management"
    ],
    relatedSafeguards: ["16.1"],
    systemPrompt: {
      role: "infrastructure_hardening_template_expert",
      context: "You are evaluating infrastructure hardening configuration template solutions against CIS Control 16.7 requirements for using standard industry-recommended hardening templates for application infrastructure including servers, databases, web servers, cloud containers, PaaS, and SaaS components.",
      objective: "Determine if a vendor solution provides comprehensive infrastructure hardening template capabilities including industry-recommended configurations for servers, databases, cloud components, and configuration hardening protection.",
      guidelines: [
        "Verify standard industry-recommended hardening configuration template usage",
        "Confirm application infrastructure component coverage (servers, databases, web servers)",
        "Validate cloud containers, PaaS, and SaaS component hardening templates",
        "Assess configuration hardening protection against in-house software weakening",
        "Review configuration baseline tools and infrastructure as code (IaC) templates",
        "Check automated configuration management and security hardening guide integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.8": {
    id: "16.8",
    title: "Separate Production and Non-Production Systems",
    description: "Maintain separate environments for production and non-production systems",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "maintain separate environments for production and non-production systems"
    ],
    coreRequirements: [ // Green - The "what"
      "separate environments",
      "production systems",
      "non-production systems"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "separate environments for production systems",
      "separate environments for non-production systems"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "network segmentation tools",
      "environment isolation technologies",
      "access control systems",
      "deployment pipeline controls"
    ],
    relatedSafeguards: ["16.1"],
    systemPrompt: {
      role: "environment_separation_expert",
      context: "You are evaluating environment separation solutions against CIS Control 16.8 requirements for maintaining separate environments for production and non-production systems.",
      objective: "Determine if a vendor solution provides comprehensive environment separation capabilities including production and non-production system isolation with proper access controls and deployment controls.",
      guidelines: [
        "Verify separate environment maintenance for production and non-production systems",
        "Confirm environment isolation technologies and network segmentation",
        "Validate access control systems and deployment pipeline controls",
        "Assess environment separation enforcement and security boundaries",
        "Review environment isolation technologies and segregation mechanisms",
        "Check production system protection and non-production environment management"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.9": {
    id: "16.9",
    title: "Train Developers in Application Security Concepts and Secure Coding",
    description: "Ensure that all software development personnel receive training in writing secure code for their specific development environment and responsibilities. Training can include general security principles and application security standard practices. Conduct training at least annually and design in a way to promote security within the development team, and build a culture of security among the developers",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "ensure that all software development personnel receive training in writing secure code",
      "conduct training at least annually"
    ],
    coreRequirements: [ // Green - The "what"
      "training in writing secure code",
      "specific development environment and responsibilities",
      "general security principles",
      "application security standard practices",
      "promote security within the development team",
      "build a culture of security among the developers"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "all software development personnel receive training",
      "for their specific development environment and responsibilities",
      "training can include general security principles",
      "training can include application security standard practices",
      "design in a way to promote security within the development team",
      "build a culture of security among the developers"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security training and awareness tools",
      "secure coding training programs",
      "developer security certifications",
      "hands-on security workshops"
    ],
    relatedSafeguards: ["16.1", "14.1", "14.9"],
    systemPrompt: {
      role: "developer_security_training_expert",
      context: "You are evaluating developer security training solutions against CIS Control 16.9 requirements for training all software development personnel in secure coding, application security principles, and building a security culture.",
      objective: "Determine if a vendor solution provides comprehensive developer security training including secure coding for specific environments, annual training programs, and security culture development within development teams.",
      guidelines: [
        "Verify comprehensive secure coding training for all software development personnel",
        "Confirm training specific to development environment and responsibilities",
        "Validate annual training programs and security principle education",
        "Assess security culture building and development team security promotion",
        "Review secure coding training programs and developer security certifications",
        "Check hands-on security workshops and application security standard practices training"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.10": {
    id: "16.10",
    title: "Apply Secure Design Principles in Application Architectures",
    description: "Apply secure design principles in application architectures. Secure design principles include the concept of least privilege and enforcing mediation to validate every operation that the user makes, promoting the concept of \"never trust user input.\" Examples include ensuring that explicit error checking is performed and documented for all input, including for size, data type, and acceptable ranges or formats. Secure design also means minimizing the application infrastructure attack surface, such as turning off unprotected ports and services, removing unnecessary programs and files, and renaming or removing default accounts",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "apply secure design principles in application architectures"
    ],
    coreRequirements: [ // Green - The "what"
      "secure design principles",
      "concept of least privilege",
      "enforcing mediation to validate every operation",
      "never trust user input",
      "explicit error checking for all input",
      "minimizing the application infrastructure attack surface"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "concept of least privilege",
      "enforcing mediation",
      "validate every operation that the user makes",
      "promoting the concept of never trust user input",
      "ensuring that explicit error checking is performed and documented for all input",
      "including for size, data type, and acceptable ranges or formats",
      "turning off unprotected ports and services",
      "removing unnecessary programs and files",
      "renaming or removing default accounts"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "secure architecture frameworks",
      "input validation libraries",
      "access control systems",
      "security design patterns"
    ],
    relatedSafeguards: ["16.1"],
    systemPrompt: {
      role: "secure_architecture_design_expert",
      context: "You are evaluating secure application architecture design solutions against CIS Control 16.10 requirements for applying secure design principles including least privilege, input validation, and attack surface minimization.",
      objective: "Determine if a vendor solution provides comprehensive secure design principle capabilities including least privilege enforcement, user input validation, explicit error checking, and application infrastructure attack surface minimization.",
      guidelines: [
        "Verify secure design principle application in application architectures",
        "Confirm least privilege implementation and operation validation mediation",
        "Validate 'never trust user input' principle and explicit error checking",
        "Assess input validation for size, data type, and acceptable ranges/formats",
        "Review attack surface minimization including port/service management and default account removal",
        "Check secure architecture frameworks and security design pattern integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.11": {
    id: "16.11",
    title: "Leverage Vetted Modules or Services for Application Security Components",
    description: "Leverage vetted modules or services for application security components, such as identity management, encryption, and auditing and logging. Using platform features in critical security functions will reduce developers' workload and minimize the likelihood of design or implementation errors. Modern operating systems provide effective mechanisms for identification, authentication, and authorization and make those mechanisms available to applications. Use only standardized, currently accepted, and extensively reviewed encryption algorithms. Operating systems also provide mechanisms to create and maintain secure audit logs",
    implementationGroup: "IG2",
    assetType: ["applications"],
    securityFunction: ["Identify"],
    governanceElements: [ // Orange - MUST be met
      "leverage vetted modules or services for application security components",
      "use only standardized, currently accepted, and extensively reviewed encryption algorithms"
    ],
    coreRequirements: [ // Green - The "what"
      "vetted modules or services",
      "application security components",
      "identity management",
      "encryption",
      "auditing and logging",
      "platform features in critical security functions",
      "identification, authentication, and authorization mechanisms",
      "secure audit logs"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "such as identity management, encryption, and auditing and logging",
      "using platform features in critical security functions will reduce developers' workload",
      "minimize the likelihood of design or implementation errors",
      "modern operating systems provide effective mechanisms for identification, authentication, and authorization",
      "make those mechanisms available to applications",
      "operating systems also provide mechanisms to create and maintain secure audit logs"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "established security libraries",
      "platform security services",
      "cryptographic modules",
      "operating system security features"
    ],
    relatedSafeguards: ["16.1", "16.5"],
    systemPrompt: {
      role: "vetted_security_module_expert",
      context: "You are evaluating vetted security module and service solutions against CIS Control 16.11 requirements for leveraging established security components including identity management, encryption, auditing, logging, and platform security features.",
      objective: "Determine if a vendor solution provides comprehensive vetted security module capabilities including identity management, encryption, auditing/logging, platform security features, and standardized cryptographic algorithms.",
      guidelines: [
        "Verify vetted modules and services for application security components",
        "Confirm identity management, encryption, auditing, and logging capabilities",
        "Validate platform security features and critical security function integration",
        "Assess standardized, accepted, and extensively reviewed encryption algorithms",
        "Review established security libraries and cryptographic modules",
        "Check operating system security feature utilization and secure audit log mechanisms"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.12": {
    id: "16.12",
    title: "Implement Code-Level Security Checks",
    description: "Apply static and dynamic analysis tools within the application life cycle to verify that secure coding practices are being followed",
    implementationGroup: "IG3",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "apply static and dynamic analysis tools within the application life cycle to verify that secure coding practices are being followed"
    ],
    coreRequirements: [ // Green - The "what"
      "static analysis tools",
      "dynamic analysis tools",
      "application life cycle",
      "secure coding practices verification"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "apply static analysis tools within the application life cycle",
      "apply dynamic analysis tools within the application life cycle",
      "verify that secure coding practices are being followed"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "code analysis tools",
      "static application security testing (SAST)",
      "dynamic application security testing (DAST)",
      "interactive application security testing (IAST)"
    ],
    relatedSafeguards: ["16.1"],
    systemPrompt: {
      role: "code_security_analysis_expert",
      context: "You are evaluating code-level security analysis solutions against CIS Control 16.12 requirements for implementing static and dynamic analysis tools within application lifecycles to verify secure coding practices.",
      objective: "Determine if a vendor solution provides comprehensive code-level security checking capabilities including static analysis, dynamic analysis, and secure coding practice verification within application development lifecycles.",
      guidelines: [
        "Verify static and dynamic analysis tool implementation in application lifecycle",
        "Confirm secure coding practices verification and compliance checking",
        "Validate SAST, DAST, and IAST capabilities and integration",
        "Assess code analysis tool effectiveness and lifecycle integration",
        "Review application security testing automation and continuous security",
        "Check secure coding standard enforcement and development process integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.13": {
    id: "16.13",
    title: "Conduct Application Penetration Testing",
    description: "Conduct application penetration testing. For critical applications, authenticated penetration testing is better suited to finding business logic vulnerabilities than code scanning and automated security testing. Penetration testing relies on the skill of the tester to manually manipulate an application as an authenticated and unauthenticated user",
    implementationGroup: "IG3",
    assetType: ["applications"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "conduct application penetration testing"
    ],
    coreRequirements: [ // Green - The "what"
      "application penetration testing",
      "authenticated penetration testing for critical applications",
      "business logic vulnerabilities",
      "manual manipulation of application",
      "authenticated and unauthenticated user testing"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "for critical applications",
      "authenticated penetration testing is better suited to finding business logic vulnerabilities",
      "than code scanning and automated security testing",
      "penetration testing relies on the skill of the tester",
      "to manually manipulate an application as an authenticated and unauthenticated user"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "application security testing tools",
      "penetration testing frameworks",
      "security testing methodologies",
      "skilled penetration testers"
    ],
    relatedSafeguards: ["16.1"],
    systemPrompt: {
      role: "application_penetration_testing_expert",
      context: "You are evaluating application penetration testing solutions against CIS Control 16.13 requirements for conducting penetration testing including authenticated testing for critical applications and business logic vulnerability identification.",
      objective: "Determine if a vendor solution provides comprehensive application penetration testing capabilities including authenticated testing, business logic vulnerability discovery, and manual application manipulation for critical applications.",
      guidelines: [
        "Verify application penetration testing capabilities and methodologies",
        "Confirm authenticated penetration testing for critical applications",
        "Validate business logic vulnerability identification and manual manipulation testing",
        "Assess authenticated and unauthenticated user testing approaches",
        "Review penetration testing frameworks and skilled tester capabilities",
        "Check testing effectiveness beyond code scanning and automated security testing"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "16.14": {
    id: "16.14",
    title: "Conduct Threat Modeling",
    description: "Conduct threat modeling. Threat modeling is the process of identifying and addressing application security design flaws within a design, before code is created. It is conducted through specially trained individuals who evaluate the application design and gauge security risks for each entry point and access level. The goal is to map out the application, architecture, and infrastructure in a structured way to understand its weaknesses",
    implementationGroup: "IG3",
    assetType: ["applications"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "conduct threat modeling"
    ],
    coreRequirements: [ // Green - The "what"
      "threat modeling",
      "identifying and addressing application security design flaws",
      "before code is created",
      "specially trained individuals",
      "evaluate application design",
      "gauge security risks for each entry point and access level",
      "map out the application, architecture, and infrastructure"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "threat modeling is the process of identifying and addressing application security design flaws within a design",
      "before code is created",
      "conducted through specially trained individuals",
      "who evaluate the application design and gauge security risks",
      "for each entry point and access level",
      "the goal is to map out the application, architecture, and infrastructure in a structured way",
      "to understand its weaknesses"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "threat modeling frameworks",
      "security design review processes",
      "threat modeling tools",
      "security architecture documentation"
    ],
    relatedSafeguards: ["16.1"],
    systemPrompt: {
      role: "threat_modeling_expert",
      context: "You are evaluating threat modeling solutions against CIS Control 16.14 requirements for conducting threat modeling to identify and address application security design flaws before code creation through specially trained individuals.",
      objective: "Determine if a vendor solution provides comprehensive threat modeling capabilities including design flaw identification, security risk assessment for entry points/access levels, and structured application/architecture/infrastructure mapping.",
      guidelines: [
        "Verify threat modeling process implementation and design flaw identification",
        "Confirm specially trained individual capabilities and application design evaluation",
        "Validate security risk assessment for each entry point and access level",
        "Assess structured mapping of application, architecture, and infrastructure",
        "Review threat modeling frameworks and security design review processes",
        "Check threat modeling tools and security architecture documentation integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 17: Incident Response Management
  "17.1": {
    id: "17.1",
    title: "Designate Personnel to Manage Incident Handling",
    description: "Designate one key person, and at least one backup, who will manage the enterprise's incident handling process. Management personnel are responsible for the coordination and documentation of incident response and recovery efforts and can consist of employees internal to the enterprise, service providers, or a hybrid approach. If using a service provider, designate at least one person internal to the enterprise to oversee any third-party work. Review annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "designate one key person and at least one backup who will manage the enterprise's incident handling process",
      "review annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "one key person to manage incident handling",
      "at least one backup person",
      "coordination of incident response and recovery efforts",
      "documentation of incident response and recovery efforts",
      "management personnel for incident handling process"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "management personnel are responsible for coordination and documentation",
      "can consist of employees internal to the enterprise",
      "can consist of service providers",
      "can consist of a hybrid approach",
      "if using a service provider, designate at least one person internal to the enterprise to oversee any third-party work"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "incident response team structures",
      "incident management roles and responsibilities",
      "coordination tools and processes",
      "documentation templates"
    ],
    relatedSafeguards: ["17.4"],
    systemPrompt: {
      role: "incident_management_personnel_expert",
      context: "You are evaluating incident management personnel designation solutions against CIS Control 17.1 requirements for designating key personnel and backups to manage enterprise incident handling processes with coordination and documentation responsibilities.",
      objective: "Determine if a vendor solution provides comprehensive incident management personnel capabilities including key person designation, backup personnel, coordination and documentation systems, and annual review processes.",
      guidelines: [
        "Verify key person and backup designation for incident handling management",
        "Confirm coordination and documentation of incident response and recovery efforts",
        "Validate management personnel responsibilities and incident handling process oversight",
        "Assess internal employees, service providers, or hybrid approach support",
        "Review annual personnel review and enterprise change impact assessment",
        "Check incident response team structures and coordination tools integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.2": {
    id: "17.2",
    title: "Establish and Maintain Contact Information for Reporting Security Incidents",
    description: "Establish and maintain contact information for reporting security incidents. This information must be available to all workforce members and should include various contact methods (e.g., phone, email) and be regularly updated. Consider the availability of these contact methods in different circumstances, such as when primary communication systems are compromised",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain contact information for reporting security incidents",
      "information must be available to all workforce members"
    ],
    coreRequirements: [ // Green - The "what"
      "contact information for reporting security incidents",
      "available to all workforce members",
      "various contact methods",
      "regularly updated contact information"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "should include various contact methods (e.g., phone, email)",
      "be regularly updated",
      "consider the availability of these contact methods in different circumstances",
      "such as when primary communication systems are compromised"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "incident reporting hotlines",
      "emergency contact lists",
      "multiple communication channels",
      "contact information distribution methods"
    ],
    relatedSafeguards: ["17.3", "17.4"],
    systemPrompt: {
      role: "incident_contact_information_expert",
      context: "You are evaluating incident contact information management solutions against CIS Control 17.2 requirements for establishing and maintaining comprehensive contact information for reporting security incidents with multiple communication methods.",
      objective: "Determine if a vendor solution provides comprehensive incident contact information capabilities including workforce-accessible contact methods, regular updates, and resilient communication systems for compromised environments.",
      guidelines: [
        "Verify incident contact information establishment and maintenance for security incident reporting",
        "Confirm workforce member accessibility and various contact method availability",
        "Validate regular contact information updates and communication method diversity",
        "Assess contact method availability during compromised primary communication systems",
        "Review incident reporting hotlines and emergency contact list management",
        "Check multiple communication channels and contact information distribution methods"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.3": {
    id: "17.3",
    title: "Establish and Maintain an Enterprise Process for Reporting Incidents",
    description: "Establish and maintain an documented enterprise process for the workforce to report security incidents. The process includes reporting timeframe, personnel to report to, mechanism for reporting, and the minimum information to be reported. Ensure the process is publicly available to all of the workforce. Review annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG1",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a documented enterprise process for the workforce to report security incidents",
      "ensure the process is publicly available to all of the workforce",
      "review annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "documented enterprise process for reporting incidents",
      "reporting timeframe",
      "personnel to report to",
      "mechanism for reporting",
      "minimum information to be reported"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "the process includes reporting timeframe",
      "the process includes personnel to report to",
      "the process includes mechanism for reporting",
      "the process includes the minimum information to be reported"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "incident reporting procedures",
      "reporting forms and templates",
      "workforce training materials",
      "process communication methods"
    ],
    relatedSafeguards: ["17.2", "17.4", "14.6"],
    systemPrompt: {
      role: "incident_reporting_process_expert",
      context: "You are evaluating incident reporting process solutions against CIS Control 17.3 requirements for establishing documented enterprise processes including reporting timeframes, personnel, mechanisms, and minimum information requirements.",
      objective: "Determine if a vendor solution provides comprehensive incident reporting process capabilities including documented procedures, workforce accessibility, reporting requirements, and annual review processes.",
      guidelines: [
        "Verify documented enterprise process establishment for workforce incident reporting",
        "Confirm reporting timeframe, personnel designation, and reporting mechanism definition",
        "Validate minimum information requirements and process workforce accessibility",
        "Assess annual process review and enterprise change impact assessment",
        "Review incident reporting procedures and workforce training material integration",
        "Check reporting forms, templates, and process communication methods"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.4": {
    id: "17.4",
    title: "Establish and Maintain an Incident Response Process",
    description: "Establish and maintain a documented incident response process that addresses roles and responsibilities, compliance requirements, and a communication plan. Review annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a documented incident response process",
      "review annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "documented incident response process",
      "roles and responsibilities",
      "compliance requirements",
      "communication plan"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "that addresses roles and responsibilities",
      "that addresses compliance requirements",
      "that addresses a communication plan"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "incident response playbooks",
      "process documentation templates",
      "compliance frameworks",
      "communication protocols"
    ],
    relatedSafeguards: ["17.1", "17.3", "17.5", "17.6", "17.7", "17.8", "17.9"],
    systemPrompt: {
      role: "incident_response_process_expert",
      context: "You are evaluating incident response process solutions against CIS Control 17.4 requirements for establishing documented incident response processes addressing roles, responsibilities, compliance requirements, and communication plans.",
      objective: "Determine if a vendor solution provides comprehensive incident response process capabilities including documentation, role definition, compliance integration, communication planning, and annual review processes.",
      guidelines: [
        "Verify documented incident response process establishment and maintenance",
        "Confirm roles and responsibilities definition and compliance requirements integration",
        "Validate communication plan development and incident response coordination",
        "Assess annual process review and enterprise change impact assessment",
        "Review incident response playbooks and process documentation templates",
        "Check compliance frameworks and communication protocol integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.5": {
    id: "17.5",
    title: "Assign Key Roles and Responsibilities",
    description: "Assign key roles and responsibilities for incident response, including staff from legal, IT, information security, facilities, public relations, human resources, incident responders, and analysts. Review annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "assign key roles and responsibilities for incident response",
      "review annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "key roles and responsibilities for incident response",
      "staff from legal",
      "staff from IT",
      "staff from information security",
      "staff from facilities",
      "staff from public relations",
      "staff from human resources",
      "incident responders",
      "analysts"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "including staff from legal, IT, information security, facilities, public relations, human resources, incident responders, and analysts"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "incident response team structures",
      "role definition templates",
      "responsibility matrices",
      "cross-functional team coordination"
    ],
    relatedSafeguards: ["17.4"],
    systemPrompt: {
      role: "incident_response_role_assignment_expert",
      context: "You are evaluating incident response role assignment solutions against CIS Control 17.5 requirements for assigning key roles and responsibilities including legal, IT, information security, facilities, public relations, human resources, incident responders, and analysts.",
      objective: "Determine if a vendor solution provides comprehensive incident response role assignment capabilities including cross-functional team coordination, responsibility definition, and annual role review processes.",
      guidelines: [
        "Verify key role and responsibility assignment for incident response teams",
        "Confirm cross-functional staff inclusion (legal, IT, security, facilities, PR, HR, responders, analysts)",
        "Validate incident response team structure and role definition",
        "Assess annual role review and enterprise change impact assessment",
        "Review responsibility matrices and cross-functional team coordination",
        "Check incident response team structures and role definition template integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.6": {
    id: "17.6",
    title: "Define Mechanisms for Communicating During Incident Response",
    description: "Determine which primary and secondary mechanisms will be used to communicate and report during a security incident. Mechanisms can include phone calls, emails, secure chat or notification letters. Keep in mind that certain mechanisms, such as emails, can be affected during a security incident. Review annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Respond"],
    governanceElements: [ // Orange - MUST be met
      "determine which primary and secondary mechanisms will be used to communicate and report during a security incident",
      "review annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "primary mechanisms for communicating during incident response",
      "secondary mechanisms for communicating during incident response",
      "mechanisms to communicate during security incident",
      "mechanisms to report during security incident"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "mechanisms can include phone calls",
      "mechanisms can include emails",
      "mechanisms can include secure chat",
      "mechanisms can include notification letters",
      "keep in mind that certain mechanisms, such as emails, can be affected during a security incident"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "communication platforms",
      "backup communication methods",
      "secure messaging systems",
      "notification systems"
    ],
    relatedSafeguards: ["17.4"],
    systemPrompt: {
      role: "incident_communication_mechanism_expert",
      context: "You are evaluating incident communication mechanism solutions against CIS Control 17.6 requirements for defining primary and secondary communication mechanisms during security incidents including resilient communication methods.",
      objective: "Determine if a vendor solution provides comprehensive incident communication mechanism capabilities including primary/secondary methods, resilient communication systems, and annual mechanism review processes.",
      guidelines: [
        "Verify primary and secondary communication mechanism definition for incident response",
        "Confirm diverse communication methods (phone calls, emails, secure chat, notification letters)",
        "Validate communication method resilience during security incidents",
        "Assess backup communication method availability when primary systems are compromised",
        "Review secure messaging systems and notification system integration",
        "Check annual mechanism review and enterprise change impact assessment"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.7": {
    id: "17.7",
    title: "Conduct Routine Incident Response Exercises",
    description: "Plan and conduct routine incident response exercises and scenarios for key personnel involved in the incident response process to prepare for responding to real-world incidents. Exercises need to test communication channels, decision-making, and workflows. Conduct testing on an annual basis, at a minimum",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Recover"],
    governanceElements: [ // Orange - MUST be met
      "plan and conduct routine incident response exercises and scenarios for key personnel involved in the incident response process",
      "conduct testing on an annual basis, at a minimum"
    ],
    coreRequirements: [ // Green - The "what"
      "routine incident response exercises",
      "scenarios for key personnel",
      "prepare for responding to real-world incidents",
      "test communication channels",
      "test decision-making",
      "test workflows"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "key personnel involved in the incident response process",
      "to prepare for responding to real-world incidents",
      "exercises need to test communication channels, decision-making, and workflows"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "tabletop exercises",
      "simulation scenarios",
      "exercise planning frameworks",
      "testing schedules and protocols"
    ],
    relatedSafeguards: ["17.4"],
    systemPrompt: {
      role: "incident_response_exercise_expert",
      context: "You are evaluating incident response exercise solutions against CIS Control 17.7 requirements for conducting routine exercises and scenarios for key personnel to test communication channels, decision-making, and workflows.",
      objective: "Determine if a vendor solution provides comprehensive incident response exercise capabilities including routine exercises, scenario planning, personnel training, and annual testing programs for real-world incident preparation.",
      guidelines: [
        "Verify routine incident response exercise planning and execution for key personnel",
        "Confirm scenario development and real-world incident preparation capabilities",
        "Validate communication channel, decision-making, and workflow testing",
        "Assess annual testing requirements and exercise frequency management",
        "Review tabletop exercises and simulation scenario planning frameworks",
        "Check exercise testing schedules and protocol integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.8": {
    id: "17.8",
    title: "Conduct Post-Incident Reviews",
    description: "Conduct post-incident reviews. Post-incident reviews help prevent incident recurrence through identifying lessons learned and follow-up action",
    implementationGroup: "IG2",
    assetType: ["users"],
    securityFunction: ["Recover"],
    governanceElements: [ // Orange - MUST be met
      "conduct post-incident reviews"
    ],
    coreRequirements: [ // Green - The "what"
      "post-incident reviews",
      "prevent incident recurrence",
      "identifying lessons learned",
      "follow-up action"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "post-incident reviews help prevent incident recurrence",
      "through identifying lessons learned and follow-up action"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "post-incident review templates",
      "lessons learned documentation",
      "improvement action plans",
      "review meeting processes"
    ],
    relatedSafeguards: ["17.4"],
    systemPrompt: {
      role: "post_incident_review_expert",
      context: "You are evaluating post-incident review solutions against CIS Control 17.8 requirements for conducting post-incident reviews to prevent recurrence through lessons learned identification and follow-up actions.",
      objective: "Determine if a vendor solution provides comprehensive post-incident review capabilities including incident recurrence prevention, lessons learned documentation, and follow-up action management.",
      guidelines: [
        "Verify post-incident review process implementation and execution",
        "Confirm incident recurrence prevention and lessons learned identification",
        "Validate follow-up action planning and implementation tracking",
        "Assess post-incident review documentation and improvement processes",
        "Review lessons learned documentation and improvement action plan integration",
        "Check review meeting processes and continuous improvement capabilities"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "17.9": {
    id: "17.9",
    title: "Establish and Maintain Security Incident Thresholds",
    description: "Establish and maintain security incident thresholds, including, at a minimum, differentiating between an incident and an event. Examples can include: abnormal activity, security vulnerability, security weakness, data breach, privacy incident, etc. Review annually, or when significant enterprise changes occur that could impact this Safeguard",
    implementationGroup: "IG3",
    assetType: ["users"],
    securityFunction: ["Recover"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain security incident thresholds",
      "review annually or when significant enterprise changes occur that could impact this safeguard"
    ],
    coreRequirements: [ // Green - The "what"
      "security incident thresholds",
      "differentiating between an incident and an event",
      "incident classification criteria"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "including, at a minimum, differentiating between an incident and an event",
      "examples can include abnormal activity",
      "examples can include security vulnerability",
      "examples can include security weakness",
      "examples can include data breach",
      "examples can include privacy incident"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "incident classification frameworks",
      "threshold definition templates",
      "severity rating systems",
      "incident categorization tools"
    ],
    relatedSafeguards: ["17.4"],
    systemPrompt: {
      role: "incident_threshold_classification_expert",
      context: "You are evaluating security incident threshold and classification solutions against CIS Control 17.9 requirements for establishing incident thresholds including incident/event differentiation and classification criteria.",
      objective: "Determine if a vendor solution provides comprehensive security incident threshold capabilities including incident/event differentiation, classification criteria, and annual threshold review processes.",
      guidelines: [
        "Verify security incident threshold establishment and maintenance",
        "Confirm incident and event differentiation and classification criteria",
        "Validate incident classification including abnormal activity, vulnerabilities, weaknesses, data breaches, privacy incidents",
        "Assess annual threshold review and enterprise change impact assessment",
        "Review incident classification frameworks and threshold definition templates",
        "Check severity rating systems and incident categorization tool integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },

  // Control 18: Penetration Testing
  "18.1": {
    id: "18.1",
    title: "Establish and Maintain a Penetration Testing Program",
    description: "Establish and maintain a penetration testing program appropriate to the size, complexity, industry, and maturity of the enterprise. Penetration testing program characteristics include scope, such as network, web application, Application Programming Interface (API), hosted services, and physical premise controls; frequency; limitations, such as acceptable hours, and excluded attack types; point of contact information; remediation, such as how findings will be routed internally; and retrospective requirements",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Govern"],
    governanceElements: [ // Orange - MUST be met
      "establish and maintain a penetration testing program appropriate to the size, complexity, industry, and maturity of the enterprise"
    ],
    coreRequirements: [ // Green - The "what"
      "penetration testing program",
      "scope including network, web application, API, hosted services, and physical premise controls",
      "frequency requirements",
      "limitations including acceptable hours and excluded attack types",
      "point of contact information",
      "remediation procedures for routing findings internally",
      "retrospective requirements"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "appropriate to the size, complexity, industry, and maturity of the enterprise",
      "penetration testing program characteristics include scope",
      "such as network, web application, Application Programming Interface (API), hosted services, and physical premise controls",
      "characteristics include frequency",
      "characteristics include limitations, such as acceptable hours, and excluded attack types",
      "characteristics include point of contact information",
      "characteristics include remediation, such as how findings will be routed internally",
      "characteristics include retrospective requirements"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "penetration testing frameworks",
      "program documentation templates",
      "scope definition guidelines",
      "testing frequency schedules"
    ],
    relatedSafeguards: ["18.2", "18.3", "18.4", "18.5"],
    systemPrompt: {
      role: "penetration_testing_program_expert",
      context: "You are evaluating penetration testing program solutions against CIS Control 18.1 requirements for establishing comprehensive programs appropriate to enterprise size, complexity, industry, and maturity with defined scope, frequency, limitations, and remediation procedures.",
      objective: "Determine if a vendor solution provides comprehensive penetration testing program capabilities including program establishment, scope definition, frequency management, limitation setting, and remediation procedures.",
      guidelines: [
        "Verify penetration testing program establishment appropriate to enterprise characteristics",
        "Confirm comprehensive scope including network, web application, API, hosted services, physical premises",
        "Validate frequency requirements and limitation management (acceptable hours, excluded attacks)",
        "Assess point of contact information and remediation procedure integration",
        "Review penetration testing frameworks and program documentation templates",
        "Check retrospective requirements and scope definition guideline integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "18.2": {
    id: "18.2",
    title: "Perform Periodic External Penetration Tests",
    description: "Perform periodic external penetration tests based on program requirements, no less than annually. External penetration testing must include enterprise and environmental reconnaissance to detect exploitable information. Penetration testing requires specialized skills and experience and must be conducted through a qualified party. The testing may be clear box or opaque box",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "perform periodic external penetration tests based on program requirements, no less than annually",
      "external penetration testing must include enterprise and environmental reconnaissance to detect exploitable information",
      "penetration testing requires specialized skills and experience and must be conducted through a qualified party"
    ],
    coreRequirements: [ // Green - The "what"
      "periodic external penetration tests",
      "enterprise reconnaissance",
      "environmental reconnaissance",
      "detect exploitable information",
      "specialized skills and experience",
      "qualified party to conduct testing"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "based on program requirements",
      "no less than annually",
      "to detect exploitable information",
      "the testing may be clear box or opaque box"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "external penetration testing services",
      "reconnaissance tools and techniques",
      "qualified penetration testing vendors",
      "clear box and opaque box methodologies"
    ],
    relatedSafeguards: ["18.1", "18.3", "18.4"],
    systemPrompt: {
      role: "external_penetration_testing_expert",
      context: "You are evaluating external penetration testing solutions against CIS Control 18.2 requirements for performing periodic external penetration tests including enterprise and environmental reconnaissance with qualified party execution and clear/opaque box methodologies.",
      objective: "Determine if a vendor solution provides comprehensive external penetration testing capabilities including annual testing, reconnaissance, exploitable information detection, qualified party execution, and clear/opaque box methodologies.",
      guidelines: [
        "Verify periodic external penetration testing based on program requirements (minimum annually)",
        "Confirm enterprise and environmental reconnaissance capabilities for exploitable information detection",
        "Validate qualified party requirements and specialized skills/experience verification",
        "Assess clear box and opaque box testing methodology support",
        "Review external penetration testing services and reconnaissance tool integration",
        "Check qualified penetration testing vendor capabilities and methodology frameworks"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "18.3": {
    id: "18.3",
    title: "Remediate Penetration Test Findings",
    description: "Remediate penetration test findings based on the enterprise's documented vulnerability remediation process. This should include determining a timeline and level of effort based on the impact and prioritization of each identified finding",
    implementationGroup: "IG2",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "remediate penetration test findings based on the enterprise's documented vulnerability remediation process"
    ],
    coreRequirements: [ // Green - The "what"
      "remediate penetration test findings",
      "documented vulnerability remediation process",
      "timeline for remediation",
      "level of effort determination",
      "impact assessment",
      "prioritization of findings"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "this should include determining a timeline and level of effort",
      "based on the impact and prioritization of each identified finding"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "vulnerability remediation workflows",
      "finding prioritization frameworks",
      "remediation tracking systems",
      "impact assessment methodologies"
    ],
    relatedSafeguards: ["18.1", "18.2", "18.5"],
    systemPrompt: {
      role: "penetration_test_remediation_expert",
      context: "You are evaluating penetration test finding remediation solutions against CIS Control 18.3 requirements for remediating findings based on documented vulnerability remediation processes with timeline, effort, impact, and prioritization assessment.",
      objective: "Determine if a vendor solution provides comprehensive penetration test finding remediation capabilities including documented processes, timeline determination, effort assessment, impact analysis, and finding prioritization.",
      guidelines: [
        "Verify penetration test finding remediation based on documented vulnerability processes",
        "Confirm timeline determination and level of effort assessment capabilities",
        "Validate impact assessment and finding prioritization frameworks",
        "Assess vulnerability remediation workflow integration and tracking systems",
        "Review finding prioritization frameworks and remediation tracking systems",
        "Check impact assessment methodologies and remediation process compliance"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "18.4": {
    id: "18.4",
    title: "Validate Security Measures",
    description: "Validate security measures after each penetration test. If deemed necessary, modify rulesets and capabilities to detect the techniques used during testing",
    implementationGroup: "IG3",
    assetType: ["network"],
    securityFunction: ["Protect"],
    governanceElements: [ // Orange - MUST be met
      "validate security measures after each penetration test"
    ],
    coreRequirements: [ // Green - The "what"
      "validate security measures",
      "modify rulesets if necessary",
      "modify capabilities if necessary",
      "detect techniques used during testing"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "after each penetration test",
      "if deemed necessary",
      "to detect the techniques used during testing"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "security control validation frameworks",
      "detection rule tuning processes",
      "capability enhancement procedures",
      "technique analysis methodologies"
    ],
    relatedSafeguards: ["18.1", "18.2", "18.5"],
    systemPrompt: {
      role: "security_measure_validation_expert",
      context: "You are evaluating security measure validation solutions against CIS Control 18.4 requirements for validating security measures after penetration tests and modifying rulesets/capabilities to detect testing techniques.",
      objective: "Determine if a vendor solution provides comprehensive security measure validation capabilities including post-test validation, ruleset modification, capability enhancement, and technique detection improvement.",
      guidelines: [
        "Verify security measure validation after each penetration test",
        "Confirm ruleset and capability modification for technique detection improvement",
        "Validate detection enhancement for techniques used during penetration testing",
        "Assess security control validation frameworks and detection rule tuning",
        "Review capability enhancement procedures and technique analysis methodologies",
        "Check security measure effectiveness and penetration test technique integration"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  },
  "18.5": {
    id: "18.5",
    title: "Perform Periodic Internal Penetration Tests",
    description: "Perform periodic internal penetration tests based on program requirements, no less than annually. The testing may be clear box or opaque box",
    implementationGroup: "IG3",
    assetType: ["network"],
    securityFunction: ["Detect"],
    governanceElements: [ // Orange - MUST be met
      "perform periodic internal penetration tests based on program requirements, no less than annually"
    ],
    coreRequirements: [ // Green - The "what"
      "periodic internal penetration tests",
      "program requirements compliance",
      "annual testing frequency minimum"
    ],
    subTaxonomicalElements: [ // Yellow - Sub-taxonomical elements
      "based on program requirements",
      "no less than annually",
      "the testing may be clear box or opaque box"
    ],
    implementationSuggestions: [ // Gray - Implementation suggestions
      "internal penetration testing tools",
      "internal testing methodologies",
      "clear box and opaque box approaches",
      "internal security assessment frameworks"
    ],
    relatedSafeguards: ["18.1", "18.3", "18.4"],
    systemPrompt: {
      role: "internal_penetration_testing_expert",
      context: "You are evaluating internal penetration testing solutions against CIS Control 18.5 requirements for performing periodic internal penetration tests based on program requirements with annual frequency and clear/opaque box methodologies.",
      objective: "Determine if a vendor solution provides comprehensive internal penetration testing capabilities including periodic testing, program requirements compliance, annual frequency, and clear/opaque box approaches.",
      guidelines: [
        "Verify periodic internal penetration testing based on program requirements (minimum annually)",
        "Confirm annual testing frequency and program requirements compliance",
        "Validate clear box and opaque box testing methodology support",
        "Assess internal penetration testing tools and methodology integration",
        "Review internal testing methodologies and security assessment frameworks",
        "Check internal penetration testing capability and approach effectiveness"
      ],
      outputFormat: "Provide structured assessment with capability level (FULL/PARTIAL/FACILITATES/GOVERNANCE/VALIDATES), confidence score, and evidence summary"
    }
  }
};
  }
}
